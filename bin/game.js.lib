[
  {
    "path": "node_modules/@dcl/amd/dist/amd.min.js",
    "content": "\"use strict\";const getGlobalThis=function(){if(typeof globalThis!==\"undefined\")return globalThis;if(typeof self!==\"undefined\")return self;if(typeof window!==\"undefined\")return window;if(typeof this!==\"undefined\")return this;throw new Error(\"Unable to locate global `this`\")};const globalObject=getGlobalThis();var loader;(function(e){\"use strict\";const n=1;const t=2;let r=0;let o=[];let l=[];const i={baseUrl:\"\"};const s={};function f(e){if(typeof e===\"object\"){for(let n in e){if(e.hasOwnProperty(n)){i[n]=e[n]}}}}e.config=f;function d(e,t,o){let l=null;let i={};let f=null;if(typeof e===\"function\"){i=e}else if(typeof e===\"string\"){l=e;if(typeof t===\"function\"){i=t}else if(t instanceof Array){f=t;i=o}}else if(e instanceof Array){f=e;if(typeof t===\"function\"){i=t}}f=f||[\"require\",\"exports\",\"module\"];if(l===null){l=`unnamed-module-${r++}`}l=g(l);function d(e){const n=s[l];if(!n)throw new Error(\"Could not access registered module \"+l);let t=n.exports;t=typeof i===\"function\"?i.apply(globalObject,e)||t:i;n.exports=t;u(l)}f=(f||[]).map((e=>m(l,e)));if(!s[l]){s[l]={name:l,parent:null,dclamd:n,dependencies:f,handlers:[],exports:{},dependants:new Set}}s[l].dependencies=f;p(f,d,(e=>{if(typeof onerror==\"function\"){onerror(e)}else{throw e}}),l)}e.define=d;(function(e){e.amd={};e.modules=s})(d=e.define||(e.define={}));function u(e){const n=s[e];if(!n)throw new Error(\"Could not access registered module \"+e);n.dclamd=t;let r=n.handlers;if(r&&r.length){for(let n=0;n<r.length;n++){r[n](s[e])}}}function c(e,n,t){if(!s[e]){return null}if(e==n||t==50)return[e];const r=s[e].dependencies;for(let o=0,l=r.length;o<l;o++){let l=c(r[o],n,t+1);if(l!==null){l.push(e);return l}}return null}function a(e,n){let t=s[e];if(!t){return false}let r={};for(let e in s){r[e]=false}let o=[];o.push(t);r[e]=true;while(o.length>0){let e=o.shift();let t=e.dependencies;if(t){for(let e=0,l=t.length;e<l;e++){let l=t[e];if(l===n){return true}let i=s[l];if(i&&!r[l]){r[l]=true;o.push(i)}}}}return false}function p(e,t,r,o){let i=new Array(e.length).fill(null);let f=0;let d=false;if(typeof e===\"string\"){if(s[e]){if(s[e].dclamd===n){throw new Error(`Trying to load ${e} from ${o}. The first module is still loading.`)}return s[e]}throw new Error(e+\" has not been defined. Please include it as a dependency in \"+o+\"'s define()\")}const u=e.length;for(let n=0;n<u;n++){switch(e[n]){case\"require\":let h=function(e,n,t){return p(e,n,t,o)};h.toUrl=function(e){return b(e,o)};i[n]=h;f++;break;case\"exports\":if(!s[o]){throw new Error(\"Parent module \"+o+\" not registered yet\")}i[n]=s[o].exports;f++;break;case\"module\":i[n]={id:o,uri:b(o)};f++;break;default:{const p=e[n];const h=a(p,o);const m=()=>{i[n]=s[p].exports;f++;if(f===u&&t){d=true;t(i)}};if(h){const e=c(p,o,0);if(e){e.reverse();e.push(p);l.push(e)}w(p,(()=>{}),r,o);m()}else{w(p,m,r,o)}break}}}if(!d&&f===u&&t){t(i)}}e.require=p;function h(e,n){return function(){return dcl.callRpc(e,n.name,o.slice.call(arguments,0))}}function m(e,n){return e?b(n,e):n}function w(e,t,r,o){if(s[e]){s[e].dependants.add(o);if(s[e].dclamd===n){t&&s[e].handlers.push(t)}else{t&&t(s[e])}return}else{s[e]={name:e,parent:o,dclamd:n,handlers:[t],dependencies:[],dependants:new Set([o]),exports:{}}}if(e.indexOf(\"@\")===0){let n=s[e].exports;if(typeof dcl.loadModule===\"function\"){dcl.loadModule(e,n).then((t=>{for(let e in t.methods){const r=t.methods[e];n[r.name]=h(t.rpcHandle,r)}u(e)})).catch((e=>{r(e)}))}else{throw new Error(\"Asynchronous modules will not work because loadModule function is not present\")}}}if(typeof dcl!==\"undefined\"){dcl.onStart((()=>{const e=new Set;const t=[];for(let r in s){if(s[r]){if(s[r].dclamd===n){t.push(s[r])}s[r].dependencies.forEach((n=>{if(n==\"require\"||n==\"exports\"||n==\"module\")return;if(!s[n])e.add(n)}))}}const r=[];if(l.length){r.push(`\\n> Cyclic dependencies: ${l.map((e=>\"\\n  - \"+e.join(\" -> \"))).join(\"\")}`)}if(e.size){r.push(`\\n> Undeclared/unknown modules: ${Array.from(e).map((e=>\"\\n  - \"+e)).join(\"\")}`)}if(t.length){r.push(`\\n> These modules didn't load: ${t.map((e=>\"\\n  - \"+e.name)).join(\"\")}.\\n`)}if(r.length){throw new Error(r.join(\"\\n\"))}}))}function g(e){let n=e,t;t=/\\/\\.\\//;while(t.test(n)){n=n.replace(t,\"/\")}n=n.replace(/^\\.\\//g,\"\");t=/\\/(([^\\/])|([^\\/][^\\/\\.])|([^\\/\\.][^\\/])|([^\\/][^\\/][^\\/]+))\\/\\.\\.\\//;while(t.test(n)){n=n.replace(t,\"/\")}n=n.replace(/^(([^\\/])|([^\\/][^\\/\\.])|([^\\/\\.][^\\/])|([^\\/][^\\/][^\\/]+))\\/\\.\\.\\//,\"\");n=n.replace(/^\\//g,\"\");return n}function y(e,n){let t=e;if(!t.startsWith(\"@\")){if(t.startsWith(\"./\")||t.startsWith(\"../\")){const e=n.split(\"/\");e.pop();t=g(e.join(\"/\")+\"/\"+t)}}return t}function b(e,n){switch(e){case\"require\":case\"exports\":case\"module\":return e}if(n){return y(e,n)}return g(e)}p.toUrl=b})(loader||(loader={}));globalObject.define=loader.define;globalObject.dclamd=loader;",
    "sha256": "cb9eaa325ee71be7de26bf656385092a053ee31e98af5cd74bb42250e3ad6441"
  },
  {
    "path": "node_modules/decentraland-ecs/dist/src/index.min.js",
    "content": "!function(t){\"use strict\";var e=function(){function t(){}return t.AVATAR={getEntityRepresentation:function(t){return t.avatarEntity}},t.FIRST_PERSON_CAMERA={getEntityRepresentation:function(t){return t.firstPersonCameraEntity}},t}(),n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};\n/*! *****************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */function o(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Class extends value \"+String(e)+\" is not a constructor or null\");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}var i=function(){return(i=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function r(t,e,n,o){var i,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,n,s):i(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}function s(t,e,n,o){return new(n||(n=Promise))((function(i,r){function s(t){try{u(o.next(t))}catch(t){r(t)}}function a(t){try{u(o.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((o=o.apply(t,e||[])).next())}))}function a(t,e){var n,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},\"function\"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError(\"Generator is already executing.\");for(;s;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}function u(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")}function p(t,e){var n=\"function\"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,i,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(t){i={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return s}function h(t,e){for(var n=0,o=e.length,i=t.length;n<o;n++,i++)t[i]=e[n];return t}var c=0;function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];\"undefined\"!=typeof dcl?dcl.log.apply(dcl,h([],p(t))):console.log.apply(console,h([\"DEBUG:\"],p(t)))}function d(t,e){\"undefined\"!=typeof dcl?dcl.error(t,e):console.error(\"ERROR:\",t,e)}function f(t){if(c++,0===t.length)throw new Error(\"newId(type: string): type cannot be empty\");return t+c.toString(36)}function y(){return\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return(\"x\"===t?e:3&e|8).toString(16)}))}function v(t,e){for(var n=[],o=0;o<t;++o)n.push(e());return n}var m=\"__event_name__\",g=[];function _(t){if(!(m in t)||\"string\"!=typeof t.__event_name__)throw new Error(\"The EventConstructor is not registered\");return t.__event_name__}var w=function(){function t(){this.listeners={}}return t.prototype.addListener=function(t,e,n){if(!t||\"function\"!=typeof t)throw new Error(\"Invalid EventConstructor\");var o=_(t),i=this.listeners[o];i||(i=this.listeners[o]=[]);for(var r=0;r<i.length;r++){if(i[r].listener===e)throw new Error(\"The provided listener is already registered\")}return i.push({listener:e,fn:n}),this},t.prototype.removeListener=function(t,e){if(!e||\"function\"!=typeof e)throw new Error(\"Invalid EventConstructor\");var n=_(e),o=this.listeners[n];if(!o)return!1;for(var i=0;i<o.length;i++){if(o[i].listener===t)return o.splice(i,1),!0}return!1},t.prototype.fireEvent=function(t){var e=_(t.constructor),n=this.listeners[e];if(n)for(var o=0;o<n.length;o++)try{var i=n[o];i.fn.call(i.listener,t)}catch(t){d(t)}return this},t}();function x(){var t=f(\"EV\");if(-1!==g.indexOf(t))throw new Error(\"The event name \"+t+\" is already taken\");return g.push(t),function(e){return e.__event_name__=t,e}}var T,A=function(){function t(t,e,n){this.entity=t,this.componentName=e,this.component=n}return t=r([x()],t)}(),R=function(){function t(t,e,n){this.entity=t,this.componentName=e,this.classId=n}return t=r([x()],t)}(),b=function(){function t(t,e){this.entity=t,this.parent=e}return t=r([x()],t)}();t.UIValueType=void 0,(T=t.UIValueType||(t.UIValueType={}))[T.PERCENT=0]=\"PERCENT\",T[T.PIXELS=1]=\"PIXELS\";var E=function(){function e(e){if(this.type=t.UIValueType.PIXELS,\"string\"==typeof e){var n=e;n.indexOf(\"px\")>-1?this.type=t.UIValueType.PIXELS:n.indexOf(\"%\")>-1&&(this.type=t.UIValueType.PERCENT),this.value=parseFloat(n)}else this.value=e}return e.prototype.toString=function(){var e=this.value.toString();return this.type===t.UIValueType.PERCENT?e+=\"%\":e+=\"px\",e},e}(),S=\"__name__symbol_\",C=\"__classId__symbol_\",I=\"__component__id_\",z=function(){function t(t,e,n){this.componentId=t,this.componentName=e,this.classId=n}return t=r([x()],t)}(),P=function(){function t(t){this.componentId=t}return t=r([x()],t)}(),O=function(){function t(t,e){this.componentId=t,this.component=e}return t=r([x()],t)}();function M(t,e){return function(n){if(n.isComponent)throw new TypeError(\"You cannot extend a component. Trying to extend \"+n.originalClassName+\" with: \"+t);var o=n,i=function(){var n=Array.prototype.slice.call(arguments),i=new(o.bind.apply(o,h([void 0],p(n))));return Object.defineProperty(i,S,{enumerable:!1,writable:!1,configurable:!1,value:t}),void 0!==e&&Object.defineProperty(i,C,{enumerable:!1,writable:!1,configurable:!1,value:e}),i};return void 0!==e&&(i.__classId__symbol_=e),i.__name__symbol_=t,i.isComponent=!0,i.originalClassName=t,(i.prototype=n.prototype).constructor=n,i}}function F(t,e){return function(n){if(n.isComponent)throw new TypeError(\"You cannot extend a component. Trying to extend \"+n.originalClassName+\" with: \"+t);if(\"number\"!=typeof e||isNaN(e))throw new Error(\"classId: \"+e+\" is an invalid integer\");var o=n,i=function(){if(!F.engine)throw new Error(\"You need to set a DisposableComponent.engine before creating disposable components\");var n=Array.prototype.slice.call(arguments),i=new(o.bind.apply(o,h([void 0],p(n)))),r=f(\"C\");return Object.defineProperty(i,S,{enumerable:!1,writable:!1,configurable:!1,value:t}),Object.defineProperty(i,I,{enumerable:!1,writable:!1,configurable:!1,value:r}),void 0!==e&&Object.defineProperty(i,C,{enumerable:!1,writable:!1,configurable:!1,value:e}),F.engine&&F.engine.registerComponent(i),i};return void 0!==e&&(i.__classId__symbol_=e),i.__name__symbol_=t,i.isComponent=!0,i.isDisposableComponent=!0,i.originalClassName=t,(i.prototype=n.prototype).constructor=n,i}}function L(t){if(!t)throw new TypeError(t+\" is not a component.\");if(t.__name__symbol_)return t.__name__symbol_;throw new TypeError(t+\" is not a registered component.\")}function N(t){if(!t)throw new TypeError(t+\" is not a component.\");if(t.__classId__symbol_)return t.__classId__symbol_;if(!t.__name__symbol_)throw new TypeError(t+\" is not a registered component.\");return null}function D(t){if(!t)throw new TypeError(t+\" is not a component.\");if(t.__component__id_)return t.__component__id_;throw new TypeError(t+\" is not a registered disposable component.\")}!function(t){t.engine=null}(F||(F={}));var U=function(){function t(){this.dirty=!1,this.data={},this.subscriptions=[]}return t.component=function(t,e){if(delete t[e]){var n=e+\"_\"+Math.random();t[n]=void 0,Object.defineProperty(t,n,i(i({},Object.getOwnPropertyDescriptor(t,n)),{enumerable:!1})),Object.defineProperty(t,e.toString(),{get:function(){return this[n]},set:function(t){var o=this[n];if(this.data[e]=t?D(t):null,this[n]=t,t!==o){this.dirty=!0;for(var i=0;i<this.subscriptions.length;i++)this.subscriptions[i](e,t,o)}},enumerable:!0})}},t.field=function(t,e){delete t[e]&&Object.defineProperty(t,e.toString(),{get:function(){return this.data[e]},set:function(t){var n=this.data[e];if(this.data[e]=t,t!==n){this.dirty=!0;for(var o=0;o<this.subscriptions.length;o++)this.subscriptions[o](e,t,n)}},enumerable:!0})},t.uiValue=function(t,e){delete t[e]&&Object.defineProperty(t,e.toString(),{get:function(){return this.data[e].toString()},set:function(t){var n=this.data[e],o=new E(t);if(this.data[e]=o,o!==n){this.dirty=!0;for(var i=0;i<this.subscriptions.length;i++)this.subscriptions[i](e,o,n)}},enumerable:!0})},t.readonly=function(t,e){delete t[e]&&Object.defineProperty(t,e.toString(),{get:function(){if(e in this.data==!1)throw new Error(\"The field \"+e+\" is uninitialized\");return this.data[e]},set:function(t){if(e in this.data)throw new Error(\"The field \"+e+\" is readonly\");this.data[e]=t,this.dirty=!0},enumerable:!0,configurable:!1})},t.prototype.onChange=function(t){return this.subscriptions.push(t),this},t.prototype.toJSON=function(){return this.data},t}();function B(t){return I in t}var H=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.entities=[],this.active=!1,this._requiresNames=[],!t)throw new Error(\"ComponentGroup: Could not load the requires list\");if(!(t instanceof Array))throw new Error(\"ComponentGroup: requires list is not an Array\");Object.defineProperty(this,\"requires\",{get:function(){return t.slice()}}),Object.defineProperty(this,\"requiresNames\",{get:function(){return this._requiresNames.slice()}});for(var n=function(e){var n=t[e],i=null;if(!n)throw new Error(\"ComponentGroup: the required component at location \"+e+\" is invalid\");try{i=L(n)}catch(t){throw new Error(\"ComponentGroup: the required component at location \"+e+\" is not registered as a @Component. Remember to provide the class of the component, not the name\")}if(o._requiresNames.some((function(t){return t===i})))throw new Error(\"ComponentGroup: the required component list has a repeated name \"+i);o._requiresNames.push(i)},o=this,i=0;i<t.length;i++)n(i)}return t.prototype.hasEntity=function(t){return!!t.isAddedToEngine()&&-1!==this.entities.indexOf(t)},t.prototype.addEntity=function(t){if(!t.isAddedToEngine())throw new TypeError(\"ComponentGroup: Cannot add a entity that is not added to the engine\");-1===this.entities.indexOf(t)&&this.entities.push(t)},t.prototype.removeEntity=function(t){var e=this.entities.indexOf(t);-1!==e&&this.entities.splice(e,1)},t.prototype.componentRemoved=function(t,e){-1!==this._requiresNames.indexOf(e)&&this.removeEntity(t)},t.prototype.meetsRequirements=function(t){for(var e=0;e<this._requiresNames.length;e++){if(!(this._requiresNames[e]in t.components))return!1}return!0},t}(),k=function(){function t(t){this.name=t,this.children={},this.eventManager=null,this.alive=!1,this.uuid=f(\"E\"),this.components={},this.engine=null,this._parent=null}return t.prototype.addComponentOrReplace=function(t){if(\"function\"==typeof t)throw new Error(\"You passed a function or class as a component, an instance of component is expected\");if(\"object\"!=typeof t)throw new Error(\"You passed a \"+typeof t+\", an instance of component is expected\");var e=L(t);if(this.components[e]){if(this.components[e]===t)return t;this.removeComponent(this.components[e],!1)}return this.addComponent(t)},t.prototype.hasComponent=function(t){var e=typeof t;if(\"string\"!==e&&\"object\"!==e&&\"function\"!==e)throw new Error(\"Entity#has(component): component is not a class, name or instance\");if(null==t)return!1;var n=\"string\"===e?t:L(t),o=this.components[n];return!!o&&(\"object\"===e?o===t:\"function\"!==e||o instanceof t)},t.prototype.getComponent=function(t){var e=typeof t;if(\"string\"!==e&&\"function\"!==e)throw new Error(\"Entity#get(component): component is not a class or name\");var n=\"string\"===e?t:L(t),o=this.components[n];if(!o)throw new Error('Can not get component \"'+n+'\" from entity \"'+this.identifier+'\"');if(\"function\"===e){if(o instanceof t)return o;throw new Error('Can not get component \"'+n+'\" from entity \"'+this.identifier+'\" (by instance)')}return o},t.prototype.getComponentOrNull=function(t){var e=typeof t;if(\"string\"!==e&&\"function\"!==e)throw new Error(\"Entity#getOrNull(component): component is not a class or name\");var n=\"string\"===e?t:L(t),o=this.components[n];return o?\"function\"===e?o instanceof t?o:null:o:null},t.prototype.getComponentOrCreate=function(t){if(\"function\"!=typeof t)throw new Error(\"Entity#getOrCreate(component): component is not a class\");var e=this.getComponentOrNull(t);return e||(L(e=new t),this.addComponentOrReplace(e)),e},t.prototype.addComponent=function(t){if(\"object\"!=typeof t)throw new Error(\"Entity#add(component): You passed a function or class as a component, an instance of component is expected\");var e=L(t),n=N(t);if(this.components[e])throw new Error('A component of type \"'+e+'\" is already present in entity \"'+this.identifier+'\"');this.components[e]=t,this.eventManager&&this.eventManager.fireEvent(new R(this,e,n));var o=t;return\"function\"==typeof o.addedToEntity&&o.addedToEntity(this),t},t.prototype.removeComponent=function(t,e){void 0===e&&(e=!0);var n=typeof t;if(\"string\"!==n&&\"function\"!==n&&\"object\"!==n)throw new Error(\"Entity#remove(component): component is not a class, class or name\");var o=\"string\"===n?t:L(t),i=this.components[o];if(i){if(\"function\"===n)return i instanceof t?(delete this.components[o],void(i&&(e&&this.eventManager&&this.eventManager.fireEvent(new A(this,o,i)),\"function\"==typeof i.removedFromEntity&&i.removedFromEntity(this)))):void l('Entity Warning: Trying to remove wrong (by constructor) component \"'+o+'\" from entity \"'+this.identifier+'\"');delete this.components[o],i&&(e&&this.eventManager&&this.eventManager.fireEvent(new A(this,o,i)),\"function\"==typeof i.removedFromEntity&&i.removedFromEntity(this))}else l('Entity Warning: Trying to remove inexisting component \"'+o+'\" from entity \"'+this.identifier+'\"')},t.prototype.isAddedToEngine=function(){return!(!this.engine||!(this.uuid in this.engine.entities)&&this.engine.rootEntity!==this)},t.prototype.setParent=function(t){var e;if(t&&\"getEntityRepresentation\"in t){if(!this.engine)throw new Error(\"In order to set an attachable as parent, you first need to add the entity to the engine.\");e=t.getEntityRepresentation(this.engine)}else e=!t&&this.engine?this.engine.rootEntity:t;var n=this.getParent();if(e===this)throw new Error('Failed to set parent for entity \"'+this.identifier+\"\\\": An entity can't set itself as a its own parent\");if(e===n)return this;var o=this.getCircularAncestor(e);if(o)throw new Error('Failed to set parent for entity \"'+this.identifier+'\": Circular parent references are not allowed (See entity \"'+o+'\")');return n&&delete n.children[this.uuid],null!==e&&\"0\"!==e.uuid&&(!e.isAddedToEngine()&&this.isAddedToEngine()&&this.engine.removeEntity(this),e.isAddedToEngine()&&!this.isAddedToEngine()&&e.engine.addEntity(this)),this._parent=e||null,this.registerAsChild(),this.eventManager&&this.engine&&this.eventManager.fireEvent(new b(this,e)),this},t.prototype.getParent=function(){return this._parent},Object.defineProperty(t.prototype,\"identifier\",{get:function(){return this.name||this.uuid},enumerable:!1,configurable:!0}),t.prototype.getCircularAncestor=function(t){for(var e=this.engine?this.engine.rootEntity:null,n=t;n&&n!==e;){var o=n.getParent();if(o===this)return n.uuid;n=o}return null},t.prototype.registerAsChild=function(){var t=this.getParent();this.uuid&&t&&(t.children[this.uuid]=this)},t}(),V=function(){function t(t){this.eventManager=new w,this.systems=[],this.entityLists={},this.addedSystems=[],this._entities={},this._disposableComponents={},this._componentGroups={},this.simpleSystems=[],this.eventManager.addListener(R,this,this.componentAddedHandler),this.eventManager.addListener(A,this,this.componentRemovedHandler),this.rootEntity=t,this.firstPersonCameraEntity=new k,this.firstPersonCameraEntity.uuid=\"FirstPersonCameraEntityReference\",this.addEntity(this.firstPersonCameraEntity),this.avatarEntity=new k,this.avatarEntity.uuid=\"AvatarEntityReference\",this.addEntity(this.avatarEntity)}return Object.defineProperty(t.prototype,\"entities\",{get:function(){return this._entities},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"disposableComponents\",{get:function(){return this._disposableComponents},enumerable:!1,configurable:!0}),t.prototype.addEntity=function(t){var e=t.getParent();if(t.isAddedToEngine())return t;for(var n in t.eventManager=this.eventManager,t.engine=this,this._entities[t.uuid]=t,this.checkRequirementsAndAdd(t),e?e.isAddedToEngine()||e===this.rootEntity||l(\"Engine: warning, added an entity with a parent not present in the engine. Parent id: \"+e.uuid):t.setParent(this.rootEntity),t.alive=!0,t.children){var o=t.children[n];o&&(o.isAddedToEngine()||this.addEntity(o))}return t},t.prototype.removeEntity=function(t){var e=t.uuid;if(t.isAddedToEngine()){for(var n in t.components){var o=this._componentGroups[n];if(o)for(var i in o)o[i].removeEntity(t);delete this.entityLists[n][e]}for(var r=0;r<this.simpleSystems.length;r++){var s=this.simpleSystems[r];s.onRemoveEntity&&s.onRemoveEntity(t)}for(var r in t.children){var a=t.children[r];a&&this.removeEntity(a)}return t.alive=!1,t.eventManager=null,delete this._entities[e],!0}for(var n in l(\"Engine: Trying to remove non existent entity from engine.\"),t.isAddedToEngine()?l(\"Engine: Entity id: \"+e):l('Engine: Entity \"'+t.uuid+'\" has not been added to any engine yet.'),l(\"Engine: Entity's components:\"),t.components)l(n);return!1},t.prototype.addSystem=function(t,e){if(void 0===e&&(e=0),-1!==this.addedSystems.indexOf(t))return l(\"Engine: Trying to add a system that is already added. Aborting\"),t;if(this.systems.length>0)for(var n=0;n<this.systems.length;n++){var o=this.systems[n],i=n===this.systems.length-1;if(o.priority>e){this.addedSystems.push(t),this.systems.splice(n,0,{system:t,priority:e});break}if(i){this.addedSystems.push(t),this.systems.splice(n+1,0,{system:t,priority:e});break}}else this.addedSystems.push(t),this.systems.splice(1,0,{system:t,priority:e});return this.registerSystem(t),t},t.prototype.removeSystem=function(t){var e=this.addedSystems.indexOf(t);if(-1!==e){t.active=!1,t.deactivate&&t.deactivate(),this.addedSystems.splice(e,1);for(var n=0;n<this.systems.length;n++){this.systems[n].system===t&&this.systems.splice(n,1)}return!0}return!1},t.prototype.update=function(t){for(var e in this.systems){var n=this.systems[e].system;if(n.active&&n.update)try{n.update(t)}catch(t){d(t)}}return this},t.prototype.getEntitiesWithComponent=function(t){var e=\"string\"==typeof t?t:L(t);return e in this.entityLists?this.entityLists[e]:this.entityLists[e]={}},t.prototype.registerComponent=function(t){var e=D(t),n=L(t),o=N(t);this._disposableComponents[e]=t,null!==o&&(this.eventManager.fireEvent(new z(e,n,o)),this.eventManager.fireEvent(new O(e,t)))},t.prototype.disposeComponent=function(t){var e=D(t);return delete this._disposableComponents[e]&&(this.eventManager.fireEvent(new P(e)),t.onDispose&&t.onDispose(),!0)},t.prototype.updateComponent=function(t){this.eventManager.fireEvent(new O(D(t),t))},t.prototype.getComponentGroup=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=void 0;if(t.length>0&&(u=this._componentGroups[L(t[0])]))for(var o=t.slice(),i=0;i<u.length;i++){var r=u[i];if(o.length===r.requires.length){for(var s=0;s<o.length&&-1!==r.requires.indexOf(o[s]);s++)s===o.length-1&&(n=r);if(n)break}}if(n)return n;(n=new(H.bind.apply(H,h([void 0],p(t))))).active=!0;var a=n.requiresNames;for(i=0;i<a.length;i++){var u,c=a[i];(u=this._componentGroups[c])||(this._componentGroups[c]=u=[]),-1===u.indexOf(n)&&u.push(n)}for(var l in this._entities)this.checkRequirements(this._entities[l],n);return n},t.prototype.removeComponentGroup=function(t){if(t.active){t.active=!1;for(var e=t.requiresNames,n=0;n<e.length;n++){var o=e[n],i=this._componentGroups[o];if(i){var r=i.indexOf(t);-1!==r&&i.splice(r,1)}}return!0}return!1},t.prototype.registerSystem=function(t){t.active=!0,t.activate&&t.activate(this),this.simpleSystems.push(t)},t.prototype.checkRequirementsAndAdd=function(t){if(t.isAddedToEngine()){for(var e in t.components){e in this.entityLists||(this.entityLists[e]={}),this.entityLists[e][t.uuid]=t;var n=this._componentGroups[e];if(n)for(var o in n)this.checkRequirements(t,n[o])}for(var i=0;i<this.simpleSystems.length;i++){var r=this.simpleSystems[i];r.onAddEntity&&r.onAddEntity(t)}}},t.prototype.checkRequirements=function(t,e){e.meetsRequirements(t)?e.hasEntity(t)||e.addEntity(t):e.hasEntity(t)&&e.removeEntity(t)},t.prototype.componentAddedHandler=function(t){var e,n=t.entity,o=t.componentName;if(n.isAddedToEngine()){this.entityLists[o]?this.entityLists[o][n.uuid]=n:this.entityLists[o]=((e={})[n.uuid]=n,e);var i=this._componentGroups[o];if(i)for(var r in i)this.checkRequirements(n,i[r])}},t.prototype.componentRemovedHandler=function(t){var e=t.entity,n=t.componentName;if(e.isAddedToEngine()){delete this.entityLists[n][e.uuid];var o=this._componentGroups[n];if(o)for(var i in o)this.checkRequirements(e,o[i])}},t}(),q=Promise.resolve().then.bind(Promise.resolve());function W(t){var e=q(t);return e.isComplete=!1,e.then((function(t){e.isComplete=!0,e.result=t,e.didFail=!1})).catch((function(t){e.isComplete=!0,e.error=t,e.didFail=!0,d(\"executeTask: FAILED \"+t.toString(),t)})),e}var G,j=function(){function t(t,e,n,o){void 0===e&&(e=!1),this.initalize(t,e,n,o)}return t.prototype.initalize=function(t,e,n,o){return void 0===e&&(e=!1),this.mask=t,this.skipNextObservers=e,this.target=n,this.currentTarget=o,this},t}(),Y=function(t,e,n){void 0===n&&(n=null),this.callback=t,this.mask=e,this.scope=n,this.unregisterOnNextCall=!1,this._willBeUnregistered=!1},X=function(){function t(){this._observers=null,this._observables=null}return t.Watch=function(e,n,o,i){var r,s;void 0===o&&(o=-1),void 0===i&&(i=null);var a=new t;a._observers=new Array,a._observables=e;try{for(var p=u(e),h=p.next();!h.done;h=p.next()){var c=h.value.add(n,o,!1,i);c&&a._observers.push(c)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(s=p.return)&&s.call(p)}finally{if(r)throw r.error}}return a},t.prototype.dispose=function(){if(this._observers&&this._observables)for(var t=0;t<this._observers.length;t++)this._observables[t].remove(this._observers[t]);this._observers=null,this._observables=null},t}(),Z=function(){function t(t){this._observers=new Array,this._onObserverAdded=null,this._eventState=new j(0),t&&(this._onObserverAdded=t)}return t.prototype.add=function(t,e,n,o,i){if(void 0===e&&(e=-1),void 0===n&&(n=!1),void 0===o&&(o=null),void 0===i&&(i=!1),!t)return null;var r=new Y(t,e,o);return r.unregisterOnNextCall=i,n?this._observers.unshift(r):this._observers.push(r),this._onObserverAdded&&this._onObserverAdded(r),r},t.prototype.addOnce=function(t){return this.add(t,void 0,void 0,void 0,!0)},t.prototype.remove=function(t){return!!t&&(-1!==this._observers.indexOf(t)&&(this._deferUnregister(t),!0))},t.prototype.removeCallback=function(t,e){for(var n=0;n<this._observers.length;n++)if(this._observers[n].callback===t&&(!e||e===this._observers[n].scope))return this._deferUnregister(this._observers[n]),!0;return!1},t.prototype.notifyObservers=function(t,e,n,o){var i,r;if(void 0===e&&(e=-1),!this._observers.length)return!0;var s=this._eventState;s.mask=e,s.target=n,s.currentTarget=o,s.skipNextObservers=!1,s.lastReturnValue=t;try{for(var a=u(this._observers),p=a.next();!p.done;p=a.next()){var h=p.value;if(!h._willBeUnregistered&&(h.mask&e&&(h.scope?s.lastReturnValue=h.callback.apply(h.scope,[t,s]):s.lastReturnValue=h.callback(t,s),h.unregisterOnNextCall&&this._deferUnregister(h)),s.skipNextObservers))return!1}}catch(t){i={error:t}}finally{try{p&&!p.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return!0},t.prototype.notifyObserversWithPromise=function(t,e,n,o){var i=this;void 0===e&&(e=-1);var r=Promise.resolve(t);if(!this._observers.length)return r;var s=this._eventState;return s.mask=e,s.target=n,s.currentTarget=o,s.skipNextObservers=!1,this._observers.forEach((function(n){s.skipNextObservers||n._willBeUnregistered||n.mask&e&&(r=n.scope?r.then((function(e){return s.lastReturnValue=e,n.callback.apply(n.scope,[t,s])})):r.then((function(e){return s.lastReturnValue=e,n.callback(t,s)})),n.unregisterOnNextCall&&i._deferUnregister(n))})),r.then((function(){return t}))},t.prototype.notifyObserver=function(t,e,n){void 0===n&&(n=-1);var o=this._eventState;o.mask=n,o.skipNextObservers=!1,t.callback(e,o)},t.prototype.hasObservers=function(){return this._observers.length>0},t.prototype.clear=function(){this._observers=new Array,this._onObserverAdded=null},t.prototype.clone=function(){var e=new t;return e._observers=this._observers.slice(0),e},t.prototype.hasSpecificMask=function(t){var e,n;void 0===t&&(t=-1);try{for(var o=u(this._observers),i=o.next();!i.done;i=o.next()){var r=i.value;if(r.mask&t||r.mask===t)return!0}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return!1},t.prototype._deferUnregister=function(t){var e=this;t.unregisterOnNextCall=!1,t._willBeUnregistered=!0,W((function(){return s(e,void 0,void 0,(function(){return a(this,(function(e){return[2,this._remove(t)]}))}))}))},t.prototype._remove=function(t){if(!t)return!1;var e=this._observers.indexOf(t);return-1!==e&&(this._observers.splice(e,1),!0)},t}();var J,K=function(){function t(t,e){this.uuid=t,this.payload=e}return t=r([x()],t)}(),Q=function(){function t(t){this.payload=t}return t=r([x()],t)}(),$=function(){function t(t){this.payload=t}return t=r([x()],t)}();function tt(t){return function(){J&&J.subscribe(t)}}var et=new Z(tt(\"cameraModeChanged\")),nt=new Z(tt(\"idleStateChanged\")),ot=new Z(tt(\"onEnterScene\")),it=ot,rt=new Z(tt(\"onLeaveScene\")),st=rt,at=new Z(tt(\"sceneStart\")),ut=new Z(tt(\"playerExpression\")),pt=new Z(tt(\"onPointerLock\")),ht=new Z(tt(\"videoEvent\")),ct=new Z(tt(\"profileChanged\")),lt=new Z(tt(\"playerConnected\")),dt=new Z(tt(\"playerDisconnected\")),ft=new Z(tt(\"onRealmChanged\"));function yt(t){(J=t)&&J.onEvent((function(t){switch(t.type){case\"onEnterScene\":return void ot.notifyObservers(t.data);case\"onLeaveScene\":return void rt.notifyObservers(t.data);case\"cameraModeChanged\":return void et.notifyObservers(t.data);case\"idleStateChanged\":return void nt.notifyObservers(t.data);case\"sceneStart\":return void at.notifyObservers(t.data);case\"playerExpression\":return void ut.notifyObservers(t.data);case\"videoEvent\":var e=t.data,n=F.engine.disposableComponents[e.componentId];return n&&n.update(e),void ht.notifyObservers(e);case\"profileChanged\":return void ct.notifyObservers(t.data);case\"onPointerLock\":return void pt.notifyObservers(t.data);case\"playerConnected\":return void lt.notifyObservers(t.data);case\"playerDisconnected\":return void dt.notifyObservers(t.data);case\"onRealmChanged\":return void ft.notifyObservers(t.data)}}))}var vt,mt,gt=function(){function t(t){this.dcl=t,this.cachedComponents={}}return t.prototype.activate=function(t){var e=this;this.engine=t,t.eventManager.addListener(R,this,this.componentAdded),t.eventManager.addListener(A,this,this.componentRemoved),t.eventManager.addListener(z,this,this.disposableComponentCreated),t.eventManager.addListener(P,this,this.disposableComponentRemoved),t.eventManager.addListener(O,this,this.disposableComponentUpdated),t.eventManager.addListener(b,this,this.parentChanged);var n=t.rootEntity.uuid;this.dcl.addEntity(n),this.dcl.onUpdate((function(n){t.update(n),e.presentEntities()})),this.dcl.onEvent((function(e){var n=e.data;switch(e.type){case\"uuidEvent\":t.eventManager.fireEvent(new K(n.uuid,n.payload));break;case\"raycastResponse\":(\"HitFirst\"===n.queryType||\"HitAll\"===n.queryType)&&t.eventManager.fireEvent(new Q(n));break;case\"actionButtonEvent\":t.eventManager.fireEvent(new $(n.payload))}}))},t.prototype.onAddEntity=function(t){if(t&&t.isAddedToEngine()){var e=t.uuid,n=t.getParent();for(var o in this.dcl.addEntity(e),n&&this.dcl.setParent(e,n.uuid),this.cachedComponents[e]={},t.components){var i=t.components[o],r=N(i);if(null!==r)if(B(i))this.dcl.attachEntityComponent(t.uuid,o,D(i));else{var s=JSON.stringify(i);this.dcl.updateEntityComponent(e,o,r,s),this.cachedComponents[e][o]=s}}}},t.prototype.onRemoveEntity=function(t){if(t.isAddedToEngine()){var e=t.uuid;this.dcl.removeEntity(e),delete this.cachedComponents[e]}},t.prototype.presentEntities=function(){for(var t in this.engine.entities){var e=this.engine.entities[t];for(var n in e.components){var o=N(s=e.components[n]);if(null!==o&&!B(s)){var i=this.getJsonIfDirty(e.uuid,n,s);i&&(this.dcl.updateEntityComponent(e.uuid,n,o,i),this.clearDirty(e.uuid,n,s,i))}}}for(var r in this.engine.disposableComponents){var s;(s=this.engine.disposableComponents[r])instanceof U&&s.dirty&&(this.dcl.componentUpdated(r,JSON.stringify(s)),s.dirty=!1)}},t.prototype.componentAdded=function(t){if(t.entity.isAddedToEngine()){var e=t.entity.components[t.componentName];if(B(e))this.dcl.attachEntityComponent(t.entity.uuid,t.componentName,D(e));else if(null!==t.classId){var n=JSON.stringify(e);this.dcl.updateEntityComponent(t.entity.uuid,t.componentName,t.classId,n),this.cachedComponents[t.entity.uuid][t.componentName]=n}}},t.prototype.componentRemoved=function(t){t.entity.isAddedToEngine()&&(this.dcl.removeEntityComponent(t.entity.uuid,t.componentName),delete this.cachedComponents[t.entity.uuid][t.componentName])},t.prototype.disposableComponentCreated=function(t){this.dcl.componentCreated(t.componentId,t.componentName,t.classId)},t.prototype.disposableComponentRemoved=function(t){this.dcl.componentDisposed(t.componentId)},t.prototype.disposableComponentUpdated=function(t){this.dcl.componentUpdated(t.componentId,JSON.stringify(t.component))},t.prototype.parentChanged=function(t){this.dcl.setParent(t.entity.uuid,t.parent?t.parent.uuid:\"0\")},t.prototype.getJsonIfDirty=function(t,e,n){var o=JSON.stringify(n);return o!==this.cachedComponents[t][e]&&o},t.prototype.clearDirty=function(t,e,n,o){this.cachedComponents[t][e]=o},t}();t.Orientation=void 0,(vt=t.Orientation||(t.Orientation={}))[vt.CW=0]=\"CW\",vt[vt.CCW=1]=\"CCW\",t.Space=void 0,(mt=t.Space||(t.Space={}))[mt.LOCAL=0]=\"LOCAL\",mt[mt.WORLD=1]=\"WORLD\",mt[mt.BONE=2]=\"BONE\";var _t,wt,xt=1/2.2,Tt=2.2,At=1e-6,Rt=Math.PI/180,bt=360/(2*Math.PI),Et=function(){function t(){}return t.WithinEpsilon=function(t,e,n){void 0===n&&(n=1401298e-51);var o=t-e;return-n<=o&&o<=n},t.ToHex=function(t){var e=t.toString(16);return t<=15?(\"0\"+e).toUpperCase():e.toUpperCase()},t.Sign=function(t){var e=+t;return 0===e||isNaN(e)?e:e>0?1:-1},t.Clamp=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),Math.min(n,Math.max(e,t))},t.Log2=function(t){return Math.log(t)*Math.LOG2E},t.Repeat=function(t,e){return t-Math.floor(t/e)*e},t.Normalize=function(t,e,n){return(t-e)/(n-e)},t.Denormalize=function(t,e,n){return t*(n-e)+e},t.DeltaAngle=function(e,n){var o=t.Repeat(n-e,360);return o>180&&(o-=360),o},t.PingPong=function(e,n){var o=t.Repeat(e,2*n);return n-Math.abs(o-n)},t.SmoothStep=function(e,n,o){var i=t.Clamp(o);return n*(i=-2*i*i*i+3*i*i)+e*(1-i)},t.MoveTowards=function(e,n,o){return Math.abs(n-e)<=o?n:e+t.Sign(n-e)*o},t.MoveTowardsAngle=function(e,n,o){var i=t.DeltaAngle(e,n);return-o<i&&i<o?n:t.MoveTowards(e,e+i,o)},t.Lerp=function(t,e,n){return t+(e-t)*n},t.LerpAngle=function(e,n,o){var i=t.Repeat(n-e,360);return i>180&&(i-=360),e+i*t.Clamp(o)},t.InverseLerp=function(e,n,o){return e!==n?t.Clamp((o-e)/(n-e)):0},t.Hermite=function(t,e,n,o,i){var r=i*i,s=i*r;return t*(2*s-3*r+1)+n*(-2*s+3*r)+e*(s-2*r+i)+o*(s-r)},t.RandomRange=function(t,e){return t===e?t:Math.random()*(e-t)+t},t.RangeToPercent=function(t,e,n){return(t-e)/(n-e)},t.PercentToRange=function(t,e,n){return(n-e)*t+e},t.NormalizeRadians=function(e){return e-t.TwoPi*Math.floor((e+Math.PI)/t.TwoPi)},t.TwoPi=2*Math.PI,t}(),St=function(){function t(t,e,n,o){this.x=t,this.y=e,this.z=n,this.w=o}return t.Add=function(e,n){return new t(e.x,e.y,e.z,e.w).addInPlace(n)},t.FromArray=function(e,n){return void 0===n&&(n=0),new t(e[n],e[n+1],e[n+2],e[n+3])},t.FromArrayToRef=function(t,e,n){n.x=t[e],n.y=t[e+1],n.z=t[e+2],n.w=t[e+3]},t.FromFloatArrayToRef=function(e,n,o){t.FromArrayToRef(e,n,o)},t.FromFloatsToRef=function(t,e,n,o,i){i.x=t,i.y=e,i.z=n,i.w=o},t.Zero=function(){return new t(0,0,0,0)},t.One=function(){return new t(1,1,1,1)},t.Normalize=function(e){var n=t.Zero();return t.NormalizeToRef(e,n),n},t.NormalizeToRef=function(t,e){e.copyFrom(t),e.normalize()},t.Minimize=function(e,n){var o=new t(e.x,e.y,e.z,e.w);return o.minimizeInPlace(n),o},t.Maximize=function(e,n){var o=new t(e.x,e.y,e.z,e.w);return o.maximizeInPlace(n),o},t.Distance=function(e,n){return Math.sqrt(t.DistanceSquared(e,n))},t.DistanceSquared=function(t,e){var n=t.x-e.x,o=t.y-e.y,i=t.z-e.z,r=t.w-e.w;return n*n+o*o+i*i+r*r},t.Center=function(e,n){var o=t.Add(e,n);return o.scaleInPlace(.5),o},t.TransformNormal=function(e,n){var o=t.Zero();return t.TransformNormalToRef(e,n,o),o},t.TransformNormalToRef=function(t,e,n){var o=e.m,i=t.x*o[0]+t.y*o[4]+t.z*o[8],r=t.x*o[1]+t.y*o[5]+t.z*o[9],s=t.x*o[2]+t.y*o[6]+t.z*o[10];n.x=i,n.y=r,n.z=s,n.w=t.w},t.TransformNormalFromFloatsToRef=function(t,e,n,o,i,r){var s=i.m;r.x=t*s[0]+e*s[4]+n*s[8],r.y=t*s[1]+e*s[5]+n*s[9],r.z=t*s[2]+e*s[6]+n*s[10],r.w=o},t.prototype.toString=function(){return\"{X: \"+this.x+\" Y:\"+this.y+\" Z:\"+this.z+\" W:\"+this.w+\"}\"},t.prototype.getClassName=function(){return\"Vector4\"},t.prototype.getHashCode=function(){var t=this.x||0;return t=397*(t=397*(t=397*t^(this.y||0))^(this.z||0))^(this.w||0)},t.prototype.asArray=function(){var t=new Array;return this.toArray(t,0),t},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,this},t.prototype.addInPlace=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)},t.prototype.addToRef=function(t,e){return e.x=this.x+t.x,e.y=this.y+t.y,e.z=this.z+t.z,e.w=this.w+t.w,this},t.prototype.subtractInPlace=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},t.prototype.subtract=function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)},t.prototype.subtractToRef=function(t,e){return e.x=this.x-t.x,e.y=this.y-t.y,e.z=this.z-t.z,e.w=this.w-t.w,this},t.prototype.subtractFromFloats=function(e,n,o,i){return new t(this.x-e,this.y-n,this.z-o,this.w-i)},t.prototype.subtractFromFloatsToRef=function(t,e,n,o,i){return i.x=this.x-t,i.y=this.y-e,i.z=this.z-n,i.w=this.w-o,this},t.prototype.negate=function(){return new t(-this.x,-this.y,-this.z,-this.w)},t.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},t.prototype.scale=function(e){return new t(this.x*e,this.y*e,this.z*e,this.w*e)},t.prototype.scaleToRef=function(t,e){return e.x=this.x*t,e.y=this.y*t,e.z=this.z*t,e.w=this.w*t,this},t.prototype.scaleAndAddToRef=function(t,e){return e.x+=this.x*t,e.y+=this.y*t,e.z+=this.z*t,e.w+=this.w*t,this},t.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},t.prototype.equalsWithEpsilon=function(t,e){return void 0===e&&(e=At),t&&Et.WithinEpsilon(this.x,t.x,e)&&Et.WithinEpsilon(this.y,t.y,e)&&Et.WithinEpsilon(this.z,t.z,e)&&Et.WithinEpsilon(this.w,t.w,e)},t.prototype.equalsToFloats=function(t,e,n,o){return this.x===t&&this.y===e&&this.z===n&&this.w===o},t.prototype.multiplyInPlace=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},t.prototype.multiply=function(e){return new t(this.x*e.x,this.y*e.y,this.z*e.z,this.w*e.w)},t.prototype.multiplyToRef=function(t,e){return e.x=this.x*t.x,e.y=this.y*t.y,e.z=this.z*t.z,e.w=this.w*t.w,this},t.prototype.multiplyByFloats=function(e,n,o,i){return new t(this.x*e,this.y*n,this.z*o,this.w*i)},t.prototype.divide=function(e){return new t(this.x/e.x,this.y/e.y,this.z/e.z,this.w/e.w)},t.prototype.divideToRef=function(t,e){return e.x=this.x/t.x,e.y=this.y/t.y,e.z=this.z/t.z,e.w=this.w/t.w,this},t.prototype.divideInPlace=function(t){return this.divideToRef(t,this)},t.prototype.minimizeInPlace=function(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),t.w<this.w&&(this.w=t.w),this},t.prototype.maximizeInPlace=function(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),t.w>this.w&&(this.w=t.w),this},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))},t.prototype.fract=function(){return new t(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},t.prototype.normalize=function(){var t=this.length();return 0===t?this:this.scaleInPlace(1/t)},t.prototype.toVector3=function(){return new zt(this.x,this.y,this.z)},t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},t.prototype.copyFromFloats=function(t,e,n,o){return this.x=t,this.y=e,this.z=n,this.w=o,this},t.prototype.set=function(t,e,n,o){return this.copyFromFloats(t,e,n,o)},t.prototype.setAll=function(t){return this.x=this.y=this.z=this.w=t,this},t}(),Ct=function(){function t(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this._m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._updateIdentityStatus(!1)}return Object.defineProperty(t.prototype,\"m\",{get:function(){return this._m},enumerable:!1,configurable:!0}),Object.defineProperty(t,\"IdentityReadOnly\",{get:function(){return t._identityReadOnly},enumerable:!1,configurable:!0}),t.FromArray=function(e,n){void 0===n&&(n=0);var o=new t;return t.FromArrayToRef(e,n,o),o},t.FromArrayToRef=function(t,e,n){for(var o=0;o<16;o++)n._m[o]=t[o+e];n._markAsUpdated()},t.FromFloatArrayToRefScaled=function(t,e,n,o){for(var i=0;i<16;i++)o._m[i]=t[i+e]*n;o._markAsUpdated()},t.FromValuesToRef=function(t,e,n,o,i,r,s,a,u,p,h,c,l,d,f,y,v){var m=v._m;m[0]=t,m[1]=e,m[2]=n,m[3]=o,m[4]=i,m[5]=r,m[6]=s,m[7]=a,m[8]=u,m[9]=p,m[10]=h,m[11]=c,m[12]=l,m[13]=d,m[14]=f,m[15]=y,v._markAsUpdated()},t.FromValues=function(e,n,o,i,r,s,a,u,p,h,c,l,d,f,y,v){var m=new t,g=m._m;return g[0]=e,g[1]=n,g[2]=o,g[3]=i,g[4]=r,g[5]=s,g[6]=a,g[7]=u,g[8]=p,g[9]=h,g[10]=c,g[11]=l,g[12]=d,g[13]=f,g[14]=y,g[15]=v,m._markAsUpdated(),m},t.Compose=function(e,n,o){var i=new t;return t.ComposeToRef(e,n,o,i),i},t.ComposeToRef=function(e,n,o,i){t.ScalingToRef(e.x,e.y,e.z,Pt.Matrix[1]),n.toRotationMatrix(Pt.Matrix[0]),Pt.Matrix[1].multiplyToRef(Pt.Matrix[0],i),i.setTranslation(o)},t.Identity=function(){var e=t.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return e._updateIdentityStatus(!0),e},t.IdentityToRef=function(e){t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,e),e._updateIdentityStatus(!0)},t.Zero=function(){var e=t.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return e._updateIdentityStatus(!1),e},t.RotationX=function(e){var n=new t;return t.RotationXToRef(e,n),n},t.Invert=function(e){var n=new t;return e.invertToRef(n),n},t.RotationXToRef=function(e,n){var o=Math.sin(e),i=Math.cos(e);t.FromValuesToRef(1,0,0,0,0,i,o,0,0,-o,i,0,0,0,0,1,n),n._updateIdentityStatus(1===i&&0===o)},t.RotationY=function(e){var n=new t;return t.RotationYToRef(e,n),n},t.RotationYToRef=function(e,n){var o=Math.sin(e),i=Math.cos(e);t.FromValuesToRef(i,0,-o,0,0,1,0,0,o,0,i,0,0,0,0,1,n),n._updateIdentityStatus(1===i&&0===o)},t.RotationZ=function(e){var n=new t;return t.RotationZToRef(e,n),n},t.RotationZToRef=function(e,n){var o=Math.sin(e),i=Math.cos(e);t.FromValuesToRef(i,o,0,0,-o,i,0,0,0,0,1,0,0,0,0,1,n),n._updateIdentityStatus(1===i&&0===o)},t.RotationAxis=function(e,n){var o=new t;return t.RotationAxisToRef(e,n,o),o},t.RotationAxisToRef=function(t,e,n){var o=Math.sin(-e),i=Math.cos(-e),r=1-i;t.normalize();var s=n._m;s[0]=t.x*t.x*r+i,s[1]=t.x*t.y*r-t.z*o,s[2]=t.x*t.z*r+t.y*o,s[3]=0,s[4]=t.y*t.x*r+t.z*o,s[5]=t.y*t.y*r+i,s[6]=t.y*t.z*r-t.x*o,s[7]=0,s[8]=t.z*t.x*r-t.y*o,s[9]=t.z*t.y*r+t.x*o,s[10]=t.z*t.z*r+i,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,n._markAsUpdated()},t.RotationYawPitchRoll=function(e,n,o){var i=new t;return t.RotationYawPitchRollToRef(e,n,o,i),i},t.RotationYawPitchRollToRef=function(t,e,n,o){It.RotationYawPitchRollToRef(t,e,n,Pt.Quaternion[0]),Pt.Quaternion[0].toRotationMatrix(o)},t.Scaling=function(e,n,o){var i=new t;return t.ScalingToRef(e,n,o,i),i},t.ScalingToRef=function(e,n,o,i){t.FromValuesToRef(e,0,0,0,0,n,0,0,0,0,o,0,0,0,0,1,i),i._updateIdentityStatus(1===e&&1===n&&1===o)},t.Translation=function(e,n,o){var i=new t;return t.TranslationToRef(e,n,o,i),i},t.TranslationToRef=function(e,n,o,i){t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,e,n,o,1,i),i._updateIdentityStatus(0===e&&0===n&&0===o)},t.Lerp=function(e,n,o){var i=new t;return t.LerpToRef(e,n,o,i),i},t.LerpToRef=function(t,e,n,o){for(var i=0;i<16;i++)o._m[i]=t._m[i]*(1-n)+e._m[i]*n;o._markAsUpdated()},t.DecomposeLerp=function(e,n,o){var i=new t;return t.DecomposeLerpToRef(e,n,o,i),i},t.DecomposeLerpToRef=function(e,n,o,i){var r=Pt.Vector3[0],s=Pt.Quaternion[0],a=Pt.Vector3[1];e.decompose(r,s,a);var u=Pt.Vector3[2],p=Pt.Quaternion[1],h=Pt.Vector3[3];n.decompose(u,p,h);var c=Pt.Vector3[4];zt.LerpToRef(r,u,o,c);var l=Pt.Quaternion[2];It.SlerpToRef(s,p,o,l);var d=Pt.Vector3[5];zt.LerpToRef(a,h,o,d),t.ComposeToRef(c,l,d,i)},t.LookAtLH=function(e,n,o){var i=new t;return t.LookAtLHToRef(e,n,o,i),i},t.LookAtLHToRef=function(e,n,o,i){var r=Pt.Vector3[0],s=Pt.Vector3[1],a=Pt.Vector3[2];n.subtractToRef(e,a),a.normalize(),zt.CrossToRef(o,a,r);var u=r.lengthSquared();0===u?r.x=1:r.normalizeFromLength(Math.sqrt(u)),zt.CrossToRef(a,r,s),s.normalize();var p=-zt.Dot(r,e),h=-zt.Dot(s,e),c=-zt.Dot(a,e);t.FromValuesToRef(r.x,s.x,a.x,0,r.y,s.y,a.y,0,r.z,s.z,a.z,0,p,h,c,1,i)},t.LookAtRH=function(e,n,o){var i=new t;return t.LookAtRHToRef(e,n,o,i),i},t.LookAtRHToRef=function(e,n,o,i){var r=Pt.Vector3[0],s=Pt.Vector3[1],a=Pt.Vector3[2];e.subtractToRef(n,a),a.normalize(),zt.CrossToRef(o,a,r);var u=r.lengthSquared();0===u?r.x=1:r.normalizeFromLength(Math.sqrt(u)),zt.CrossToRef(a,r,s),s.normalize();var p=-zt.Dot(r,e),h=-zt.Dot(s,e),c=-zt.Dot(a,e);t.FromValuesToRef(r.x,s.x,a.x,0,r.y,s.y,a.y,0,r.z,s.z,a.z,0,p,h,c,1,i)},t.OrthoLH=function(e,n,o,i){var r=new t;return t.OrthoLHToRef(e,n,o,i,r),r},t.OrthoLHToRef=function(e,n,o,i,r){var s=2/e,a=2/n,u=2/(i-o),p=-(i+o)/(i-o);t.FromValuesToRef(s,0,0,0,0,a,0,0,0,0,u,0,0,0,p,1,r),r._updateIdentityStatus(1===s&&1===a&&1===u&&0===p)},t.OrthoOffCenterLH=function(e,n,o,i,r,s){var a=new t;return t.OrthoOffCenterLHToRef(e,n,o,i,r,s,a),a},t.OrthoOffCenterLHToRef=function(e,n,o,i,r,s,a){var u=2/(n-e),p=2/(i-o),h=2/(s-r),c=-(s+r)/(s-r),l=(e+n)/(e-n),d=(i+o)/(o-i);t.FromValuesToRef(u,0,0,0,0,p,0,0,0,0,h,0,l,d,c,1,a),a._markAsUpdated()},t.OrthoOffCenterRH=function(e,n,o,i,r,s){var a=new t;return t.OrthoOffCenterRHToRef(e,n,o,i,r,s,a),a},t.OrthoOffCenterRHToRef=function(e,n,o,i,r,s,a){t.OrthoOffCenterLHToRef(e,n,o,i,r,s,a),a._m[10]*=-1},t.PerspectiveLH=function(e,n,o,i){var r=new t,s=2*o/e,a=2*o/n,u=(i+o)/(i-o),p=-2*i*o/(i-o);return t.FromValuesToRef(s,0,0,0,0,a,0,0,0,0,u,1,0,0,p,0,r),r._updateIdentityStatus(!1),r},t.PerspectiveFovLH=function(e,n,o,i){var r=new t;return t.PerspectiveFovLHToRef(e,n,o,i,r),r},t.PerspectiveFovLHToRef=function(e,n,o,i,r,s){void 0===s&&(s=!0);var a=o,u=i,p=1/Math.tan(.5*e),h=s?p/n:p,c=s?p:p*n,l=(u+a)/(u-a),d=-2*u*a/(u-a);t.FromValuesToRef(h,0,0,0,0,c,0,0,0,0,l,1,0,0,d,0,r),r._updateIdentityStatus(!1)},t.PerspectiveFovRH=function(e,n,o,i){var r=new t;return t.PerspectiveFovRHToRef(e,n,o,i,r),r},t.PerspectiveFovRHToRef=function(e,n,o,i,r,s){void 0===s&&(s=!0);var a=o,u=i,p=1/Math.tan(.5*e),h=s?p/n:p,c=s?p:p*n,l=-(u+a)/(u-a),d=-2*u*a/(u-a);t.FromValuesToRef(h,0,0,0,0,c,0,0,0,0,l,-1,0,0,d,0,r),r._updateIdentityStatus(!1)},t.PerspectiveFovWebVRToRef=function(t,e,n,o,i){void 0===i&&(i=!1);var r=i?-1:1,s=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),u=Math.tan(t.leftDegrees*Math.PI/180),p=Math.tan(t.rightDegrees*Math.PI/180),h=2/(u+p),c=2/(s+a),l=o._m;l[0]=h,l[1]=l[2]=l[3]=l[4]=0,l[5]=c,l[6]=l[7]=0,l[8]=(u-p)*h*.5,l[9]=-(s-a)*c*.5,l[10]=-n/(e-n),l[11]=1*r,l[12]=l[13]=l[15]=0,l[14]=-2*n*e/(n-e),o._markAsUpdated()},t.GetAsMatrix2x2=function(t){return[t._m[0],t._m[1],t._m[4],t._m[5]]},t.GetAsMatrix3x3=function(t){return[t._m[0],t._m[1],t._m[2],t._m[4],t._m[5],t._m[6],t._m[8],t._m[9],t._m[10]]},t.Transpose=function(e){var n=new t;return t.TransposeToRef(e,n),n},t.TransposeToRef=function(t,e){var n=e._m,o=t._m;n[0]=o[0],n[1]=o[4],n[2]=o[8],n[3]=o[12],n[4]=o[1],n[5]=o[5],n[6]=o[9],n[7]=o[13],n[8]=o[2],n[9]=o[6],n[10]=o[10],n[11]=o[14],n[12]=o[3],n[13]=o[7],n[14]=o[11],n[15]=o[15],e._updateIdentityStatus(t._isIdentity,t._isIdentityDirty)},t.Reflection=function(e){var n=new t;return t.ReflectionToRef(e,n),n},t.ReflectionToRef=function(e,n){e.normalize();var o=e.normal.x,i=e.normal.y,r=e.normal.z,s=-2*o,a=-2*i,u=-2*r;t.FromValuesToRef(s*o+1,a*o,u*o,0,s*i,a*i+1,u*i,0,s*r,a*r,u*r+1,0,s*e.d,a*e.d,u*e.d,1,n)},t.FromXYZAxesToRef=function(e,n,o,i){t.FromValuesToRef(e.x,e.y,e.z,0,n.x,n.y,n.z,0,o.x,o.y,o.z,0,0,0,0,1,i)},t.FromQuaternionToRef=function(t,e){var n=t.x*t.x,o=t.y*t.y,i=t.z*t.z,r=t.x*t.y,s=t.z*t.w,a=t.z*t.x,u=t.y*t.w,p=t.y*t.z,h=t.x*t.w;e._m[0]=1-2*(o+i),e._m[1]=2*(r+s),e._m[2]=2*(a-u),e._m[3]=0,e._m[4]=2*(r-s),e._m[5]=1-2*(i+n),e._m[6]=2*(p+h),e._m[7]=0,e._m[8]=2*(a+u),e._m[9]=2*(p-h),e._m[10]=1-2*(o+n),e._m[11]=0,e._m[12]=0,e._m[13]=0,e._m[14]=0,e._m[15]=1,e._markAsUpdated()},t.prototype._markAsUpdated=function(){this.updateFlag=t._updateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0},t.prototype.isIdentity=function(){if(this._isIdentityDirty){this._isIdentityDirty=!1;var t=this._m;this._isIdentity=1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]}return this._isIdentity},t.prototype.isIdentityAs3x2=function(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]||0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2},t.prototype.determinant=function(){if(!0===this._isIdentity)return 1;var t=this._m,e=t[0],n=t[1],o=t[2],i=t[3],r=t[4],s=t[5],a=t[6],u=t[7],p=t[8],h=t[9],c=t[10],l=t[11],d=t[12],f=t[13],y=t[14],v=t[15],m=c*v-y*l,g=h*v-f*l,_=h*y-f*c,w=p*v-d*l,x=p*y-c*d,T=p*f-d*h;return e*+(s*m-a*g+u*_)+n*-(r*m-a*w+u*x)+o*+(r*g-s*w+u*T)+i*-(r*_-s*x+a*T)},t.prototype.toArray=function(){return this._m},t.prototype.asArray=function(){return this._m},t.prototype.invert=function(){return this.invertToRef(this),this},t.prototype.reset=function(){return t.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this},t.prototype.add=function(e){var n=new t;return this.addToRef(e,n),n},t.prototype.addToRef=function(t,e){for(var n=0;n<16;n++)e._m[n]=this._m[n]+t._m[n];return e._markAsUpdated(),this},t.prototype.addToSelf=function(t){for(var e=0;e<16;e++)this._m[e]+=t._m[e];return this._markAsUpdated(),this},t.prototype.invertToRef=function(e){if(!0===this._isIdentity)return t.IdentityToRef(e),this;var n=this._m,o=n[0],i=n[1],r=n[2],s=n[3],a=n[4],u=n[5],p=n[6],h=n[7],c=n[8],l=n[9],d=n[10],f=n[11],y=n[12],v=n[13],m=n[14],g=n[15],_=d*g-m*f,w=l*g-v*f,x=l*m-v*d,T=c*g-y*f,A=c*m-d*y,R=c*v-y*l,b=+(u*_-p*w+h*x),E=-(a*_-p*T+h*A),S=+(a*w-u*T+h*R),C=-(a*x-u*A+p*R),I=o*b+i*E+r*S+s*C;if(0===I)return e.copyFrom(this),this;var z=1/I,P=p*g-m*h,O=u*g-v*h,M=u*m-v*p,F=a*g-y*h,L=a*m-y*p,N=a*v-y*u,D=p*f-d*h,U=u*f-l*h,B=u*d-l*p,H=a*f-c*h,k=a*d-c*p,V=a*l-c*u,q=-(i*_-r*w+s*x),W=+(o*_-r*T+s*A),G=-(o*w-i*T+s*R),j=+(o*x-i*A+r*R),Y=+(i*P-r*O+s*M),X=-(o*P-r*F+s*L),Z=+(o*O-i*F+s*N),J=-(o*M-i*L+r*N),K=-(i*D-r*U+s*B),Q=+(o*D-r*H+s*k),$=-(o*U-i*H+s*V),tt=+(o*B-i*k+r*V);return t.FromValuesToRef(b*z,q*z,Y*z,K*z,E*z,W*z,X*z,Q*z,S*z,G*z,Z*z,$*z,C*z,j*z,J*z,tt*z,e),this},t.prototype.addAtIndex=function(t,e){return this._m[t]+=e,this._markAsUpdated(),this},t.prototype.multiplyAtIndex=function(t,e){return this._m[t]*=e,this._markAsUpdated(),this},t.prototype.setTranslationFromFloats=function(t,e,n){return this._m[12]=t,this._m[13]=e,this._m[14]=n,this._markAsUpdated(),this},t.prototype.setTranslation=function(t){return this.setTranslationFromFloats(t.x,t.y,t.z)},t.prototype.getTranslation=function(){return new zt(this._m[12],this._m[13],this._m[14])},t.prototype.getTranslationToRef=function(t){return t.x=this._m[12],t.y=this._m[13],t.z=this._m[14],this},t.prototype.removeRotationAndScaling=function(){var e=this.m;return t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,e[12],e[13],e[14],e[15],this),this._updateIdentityStatus(0===e[12]&&0===e[13]&&0===e[14]&&1===e[15]),this},t.prototype.multiply=function(e){var n=new t;return this.multiplyToRef(e,n),n},t.prototype.copyFrom=function(t){t.copyToArray(this._m);var e=t;return this._updateIdentityStatus(e._isIdentity,e._isIdentityDirty,e._isIdentity3x2,e._isIdentity3x2Dirty),this},t.prototype.copyToArray=function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)t[e+n]=this._m[n];return this},t.prototype.multiplyToRef=function(t,e){return this._isIdentity?(e.copyFrom(t),this):t._isIdentity?(e.copyFrom(this),this):(this.multiplyToArray(t,e._m,0),e._markAsUpdated(),this)},t.prototype.multiplyToArray=function(t,e,n){var o=this._m,i=t.m,r=o[0],s=o[1],a=o[2],u=o[3],p=o[4],h=o[5],c=o[6],l=o[7],d=o[8],f=o[9],y=o[10],v=o[11],m=o[12],g=o[13],_=o[14],w=o[15],x=i[0],T=i[1],A=i[2],R=i[3],b=i[4],E=i[5],S=i[6],C=i[7],I=i[8],z=i[9],P=i[10],O=i[11],M=i[12],F=i[13],L=i[14],N=i[15];return e[n]=r*x+s*b+a*I+u*M,e[n+1]=r*T+s*E+a*z+u*F,e[n+2]=r*A+s*S+a*P+u*L,e[n+3]=r*R+s*C+a*O+u*N,e[n+4]=p*x+h*b+c*I+l*M,e[n+5]=p*T+h*E+c*z+l*F,e[n+6]=p*A+h*S+c*P+l*L,e[n+7]=p*R+h*C+c*O+l*N,e[n+8]=d*x+f*b+y*I+v*M,e[n+9]=d*T+f*E+y*z+v*F,e[n+10]=d*A+f*S+y*P+v*L,e[n+11]=d*R+f*C+y*O+v*N,e[n+12]=m*x+g*b+_*I+w*M,e[n+13]=m*T+g*E+_*z+w*F,e[n+14]=m*A+g*S+_*P+w*L,e[n+15]=m*R+g*C+_*O+w*N,this},t.prototype.equals=function(t){var e=t;if(!e)return!1;if((this._isIdentity||e._isIdentity)&&!this._isIdentityDirty&&!e._isIdentityDirty)return this._isIdentity&&e._isIdentity;var n=this.m,o=e.m;return n[0]===o[0]&&n[1]===o[1]&&n[2]===o[2]&&n[3]===o[3]&&n[4]===o[4]&&n[5]===o[5]&&n[6]===o[6]&&n[7]===o[7]&&n[8]===o[8]&&n[9]===o[9]&&n[10]===o[10]&&n[11]===o[11]&&n[12]===o[12]&&n[13]===o[13]&&n[14]===o[14]&&n[15]===o[15]},t.prototype.clone=function(){var e=new t;return e.copyFrom(this),e},t.prototype.getClassName=function(){return\"Matrix\"},t.prototype.getHashCode=function(){for(var t=this._m[0]||0,e=1;e<16;e++)t=397*t^(this._m[e]||0);return t},t.prototype.decompose=function(e,n,o){if(this._isIdentity)return o&&o.setAll(0),e&&e.setAll(1),n&&n.copyFromFloats(0,0,0,1),!0;var i=this._m;o&&o.copyFromFloats(i[12],i[13],i[14]);var r=e||Pt.Vector3[0];if(r.x=Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]),r.y=Math.sqrt(i[4]*i[4]+i[5]*i[5]+i[6]*i[6]),r.z=Math.sqrt(i[8]*i[8]+i[9]*i[9]+i[10]*i[10]),this.determinant()<=0&&(r.y*=-1),0===r.x||0===r.y||0===r.z)return n&&n.copyFromFloats(0,0,0,1),!1;if(n){var s=1/r.x,a=1/r.y,u=1/r.z;t.FromValuesToRef(i[0]*s,i[1]*s,i[2]*s,0,i[4]*a,i[5]*a,i[6]*a,0,i[8]*u,i[9]*u,i[10]*u,0,0,0,0,1,Pt.Matrix[0]),It.FromRotationMatrixToRef(Pt.Matrix[0],n)}return!0},t.prototype.getRow=function(t){if(t<0||t>3)return null;var e=4*t;return new St(this._m[e+0],this._m[e+1],this._m[e+2],this._m[e+3])},t.prototype.setRow=function(t,e){return this.setRowFromFloats(t,e.x,e.y,e.z,e.w)},t.prototype.transpose=function(){return t.Transpose(this)},t.prototype.transposeToRef=function(e){return t.TransposeToRef(this,e),this},t.prototype.setRowFromFloats=function(t,e,n,o,i){if(t<0||t>3)return this;var r=4*t;return this._m[r+0]=e,this._m[r+1]=n,this._m[r+2]=o,this._m[r+3]=i,this._markAsUpdated(),this},t.prototype.scale=function(e){var n=new t;return this.scaleToRef(e,n),n},t.prototype.scaleToRef=function(t,e){for(var n=0;n<16;n++)e._m[n]=this._m[n]*t;return e._markAsUpdated(),this},t.prototype.scaleAndAddToRef=function(t,e){for(var n=0;n<16;n++)e._m[n]+=this._m[n]*t;return e._markAsUpdated(),this},t.prototype.toNormalMatrix=function(e){var n=Pt.Matrix[0];this.invertToRef(n),n.transposeToRef(e);var o=e._m;t.FromValuesToRef(o[0],o[1],o[2],0,o[4],o[5],o[6],0,o[8],o[9],o[10],0,0,0,0,1,e)},t.prototype.getRotationMatrix=function(){var e=new t;return this.getRotationMatrixToRef(e),e},t.prototype.getRotationMatrixToRef=function(e){var n=Pt.Vector3[0];if(!this.decompose(n))return t.IdentityToRef(e),this;var o=this._m,i=1/n.x,r=1/n.y,s=1/n.z;return t.FromValuesToRef(o[0]*i,o[1]*i,o[2]*i,0,o[4]*r,o[5]*r,o[6]*r,0,o[8]*s,o[9]*s,o[10]*s,0,0,0,0,1,e),this},t.prototype.toggleModelMatrixHandInPlace=function(){var t=this._m;t[2]*=-1,t[6]*=-1,t[8]*=-1,t[9]*=-1,t[14]*=-1,this._markAsUpdated()},t.prototype.toggleProjectionMatrixHandInPlace=function(){var t=this._m;t[8]*=-1,t[9]*=-1,t[10]*=-1,t[11]*=-1,this._markAsUpdated()},t.prototype._updateIdentityStatus=function(e,n,o,i){void 0===n&&(n=!1),void 0===o&&(o=!1),void 0===i&&(i=!0),this.updateFlag=t._updateFlagSeed++,this._isIdentity=e,this._isIdentity3x2=e||o,this._isIdentityDirty=!this._isIdentity&&n,this._isIdentity3x2Dirty=!this._isIdentity3x2&&i},t._updateFlagSeed=0,t._identityReadOnly=t.Identity(),t}(),It=function(){function t(t,e,n,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===o&&(o=1),this.x=t,this.y=e,this.z=n,this.w=o}return t.FromRotationMatrix=function(e){var n=new t;return t.FromRotationMatrixToRef(e,n),n},t.FromRotationMatrixToRef=function(t,e){var n,o=t.m,i=o[0],r=o[4],s=o[8],a=o[1],u=o[5],p=o[9],h=o[2],c=o[6],l=o[10],d=i+u+l;d>0?(n=.5/Math.sqrt(d+1),e.w=.25/n,e.x=(c-p)*n,e.y=(s-h)*n,e.z=(a-r)*n):i>u&&i>l?(n=2*Math.sqrt(1+i-u-l),e.w=(c-p)/n,e.x=.25*n,e.y=(r+a)/n,e.z=(s+h)/n):u>l?(n=2*Math.sqrt(1+u-i-l),e.w=(s-h)/n,e.x=(r+a)/n,e.y=.25*n,e.z=(p+c)/n):(n=2*Math.sqrt(1+l-i-u),e.w=(a-r)/n,e.x=(s+h)/n,e.y=(p+c)/n,e.z=.25*n)},t.Dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w},t.AreClose=function(e,n){return t.Dot(e,n)>=0},t.Zero=function(){return new t(0,0,0,0)},t.Inverse=function(e){return new t(-e.x,-e.y,-e.z,e.w)},t.IsIdentity=function(t){return t&&0===t.x&&0===t.y&&0===t.z&&1===t.w},t.RotationAxis=function(e,n){var o=n*Rt;return t.RotationAxisToRef(e,o,new t)},t.RotationAxisToRef=function(t,e,n){var o=e*Rt,i=Math.sin(o/2);return t.normalize(),n.w=Math.cos(o/2),n.x=t.x*i,n.y=t.y*i,n.z=t.z*i,n},t.FromArray=function(e,n){return void 0===n&&(n=0),new t(e[n],e[n+1],e[n+2],e[n+3])},t.FromEulerAnglesRef=function(e,n,o,i){return t.RotationYawPitchRollToRef(n*Rt,e*Rt,o*Rt,i)},t.RotationYawPitchRoll=function(e,n,o){var i=new t;return t.RotationYawPitchRollToRef(e,n,o,i),i},t.RotationYawPitchRollToRef=function(t,e,n,o){var i=.5*e,r=.5*t,s=.5*n,a=Math.cos(i),u=Math.cos(r),p=Math.cos(s),h=Math.sin(i),c=Math.sin(r),l=Math.sin(s);o.x=u*h*p+c*a*l,o.y=c*a*p-u*h*l,o.z=u*a*l-c*h*p,o.w=u*a*p+c*h*l},t.RotationAlphaBetaGamma=function(e,n,o){var i=new t;return t.RotationAlphaBetaGammaToRef(e,n,o,i),i},t.RotationAlphaBetaGammaToRef=function(t,e,n,o){var i=.5*(n+t),r=.5*(n-t),s=.5*e;o.x=Math.cos(r)*Math.sin(s),o.y=Math.sin(r)*Math.sin(s),o.z=Math.sin(i)*Math.cos(s),o.w=Math.cos(i)*Math.cos(s)},t.RotationQuaternionFromAxis=function(e,n,o){var i=new t(0,0,0,0);return t.RotationQuaternionFromAxisToRef(e,n,o,i),i},t.RotationQuaternionFromAxisToRef=function(e,n,o,i){var r=Pt.Matrix[0];Ct.FromXYZAxesToRef(e.normalize(),n.normalize(),o.normalize(),r),t.FromRotationMatrixToRef(r,i)},t.Slerp=function(e,n,o){var i=t.Identity;return t.SlerpToRef(e,n,o,i),i},t.SlerpToRef=function(t,e,n,o){var i,r,s=t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w,a=!1;if(s<0&&(a=!0,s=-s),s>.999999)r=1-n,i=a?-n:n;else{var u=Math.acos(s),p=1/Math.sin(u);r=Math.sin((1-n)*u)*p,i=a?-Math.sin(n*u)*p:Math.sin(n*u)*p}o.x=r*t.x+i*e.x,o.y=r*t.y+i*e.y,o.z=r*t.z+i*e.z,o.w=r*t.w+i*e.w},t.Hermite=function(e,n,o,i,r){var s=r*r,a=r*s,u=2*a-3*s+1,p=-2*a+3*s,h=a-2*s+r,c=a-s;return new t(e.x*u+o.x*p+n.x*h+i.x*c,e.y*u+o.y*p+n.y*h+i.y*c,e.z*u+o.z*p+n.z*h+i.z*c,e.w*u+o.w*p+n.w*h+i.w*c)},Object.defineProperty(t,\"Identity\",{get:function(){return new t(0,0,0,1)},enumerable:!1,configurable:!0}),t.Angle=function(e,n){var o=t.Dot(e,n);return 2*Math.acos(Math.min(Math.abs(o),1))*bt},t.Euler=function(e,n,o){return t.RotationYawPitchRoll(n*Rt,e*Rt,o*Rt)},t.LookRotation=function(e,n){void 0===n&&(n=Pt.staticUp);var o=zt.Normalize(e),i=zt.Normalize(zt.Cross(n,o)),r=zt.Cross(o,i),s=i.x,a=i.y,u=i.z,p=r.x,h=r.y,c=r.z,l=o.x,d=o.y,f=o.z,y=s+h+f,v=new t;if(y>0){var m=Math.sqrt(y+1);return v.w=.5*m,m=.5/m,v.x=(c-d)*m,v.y=(l-u)*m,v.z=(a-p)*m,v}if(s>=h&&s>=f){var g=Math.sqrt(1+s-h-f),_=.5/g;return v.x=.5*g,v.y=(a+p)*_,v.z=(u+l)*_,v.w=(c-d)*_,v}if(h>f){var w=Math.sqrt(1+h-s-f),x=.5/w;return v.x=(p+a)*x,v.y=.5*w,v.z=(d+c)*x,v.w=(l-u)*x,v}var T=Math.sqrt(1+f-s-h),A=.5/T;return v.x=(l+u)*A,v.y=(d+c)*A,v.z=.5*T,v.w=(a-p)*A,v},t.RotateTowards=function(e,n,o){var i=t.Angle(e,n);if(0===i)return n;var r=Math.min(1,o/i);return t.Slerp(e,n,r)},t.FromToRotation=function(e,n,o){void 0===o&&(o=Pt.staticUp);var i=e.normalize(),r=n.normalize(),s=zt.Cross(i,r),a=Math.sqrt(i.lengthSquared()*r.lengthSquared())+zt.Dot(i,r);return s.lengthSquared()<1e-4?Math.abs(a)<1e-4?new t(o.x,o.y,o.z,0).normalized:t.Identity:new t(s.x,s.y,s.z,a).normalized},Object.defineProperty(t.prototype,\"normalized\",{get:function(){return this.normalize()},enumerable:!1,configurable:!0}),t.prototype.setFromToRotation=function(e,n,o){void 0===o&&(o=Pt.staticUp);var i=t.FromToRotation(e,n,o);this.x=i.x,this.y=i.y,this.z=i.z,this.w=i.w},Object.defineProperty(t.prototype,\"eulerAngles\",{get:function(){var t=new zt,e=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w,n=this.x*this.w-this.y*this.z;return n>.4995*e?(t.x=Math.PI/2,t.y=2*Math.atan2(this.y,this.x),t.z=0):n<-.4995*e?(t.x=-Math.PI/2,t.y=-2*Math.atan2(this.y,this.x),t.z=0):(t.x=Math.asin(2*(this.w*this.x-this.y*this.z)),t.y=Math.atan2(2*this.w*this.y+2*this.z*this.x,1-2*(this.x*this.x+this.y*this.y)),t.z=Math.atan2(2*this.w*this.z+2*this.x*this.y,1-2*(this.z*this.z+this.x*this.x))),t.x*=bt,t.y*=bt,t.z*=bt,t.x=Et.Repeat(t.x,360),t.y=Et.Repeat(t.y,360),t.z=Et.Repeat(t.z,360),t},set:function(t){this.setEuler(t.x,t.y,t.z)},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return\"(\"+this.x+\", \"+this.y+\", \"+this.z+\", \"+this.w+\")\"},Object.defineProperty(t.prototype,\"length\",{get:function(){return Math.sqrt(this.lengthSquared)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"lengthSquared\",{get:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},enumerable:!1,configurable:!0}),t.prototype.getClassName=function(){return\"Quaternion\"},t.prototype.getHashCode=function(){var t=this.x||0;return t=397*(t=397*(t=397*t^(this.y||0))^(this.z||0))^(this.w||0)},t.prototype.asArray=function(){return[this.x,this.y,this.z,this.w]},t.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},t.prototype.copyFromFloats=function(t,e,n,o){return this.x=t,this.y=e,this.z=n,this.w=o,this},t.prototype.set=function(t,e,n,o){return this.copyFromFloats(t,e,n,o)},t.prototype.setEuler=function(e,n,o){return t.RotationYawPitchRollToRef(n*Rt,e*Rt,o*Rt,this),this},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)},t.prototype.addInPlace=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},t.prototype.subtract=function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)},t.prototype.scale=function(e){return new t(this.x*e,this.y*e,this.z*e,this.w*e)},t.prototype.scaleToRef=function(t,e){return e.x=this.x*t,e.y=this.y*t,e.z=this.z*t,e.w=this.w*t,this},t.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},t.prototype.scaleAndAddToRef=function(t,e){return e.x+=this.x*t,e.y+=this.y*t,e.z+=this.z*t,e.w+=this.w*t,this},t.prototype.multiply=function(e){var n=new t(0,0,0,1);return this.multiplyToRef(e,n),n},t.prototype.multiplyToRef=function(t,e){var n=this.x*t.w+this.y*t.z-this.z*t.y+this.w*t.x,o=-this.x*t.z+this.y*t.w+this.z*t.x+this.w*t.y,i=this.x*t.y-this.y*t.x+this.z*t.w+this.w*t.z,r=-this.x*t.x-this.y*t.y-this.z*t.z+this.w*t.w;return e.copyFromFloats(n,o,i,r),this},t.prototype.multiplyInPlace=function(t){return this.multiplyToRef(t,this),this},t.prototype.conjugateToRef=function(t){return t.copyFromFloats(-this.x,-this.y,-this.z,this.w),this},t.prototype.conjugateInPlace=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},t.prototype.conjugate=function(){return new t(-this.x,-this.y,-this.z,this.w)},t.prototype.normalize=function(){var t=1/this.length;return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},t.prototype.angleAxis=function(e,n){if(0===n.lengthSquared())return t.Identity;var o=t.Identity,i=e*Rt;i*=.5;var r=n.normalize();return r=n.scaleInPlace(Math.sin(i)),o.x=r.x,o.y=r.y,o.z=r.z,o.w=Math.cos(i),o.normalize()},t.prototype.toRotationMatrix=function(t){return Ct.FromQuaternionToRef(this,t),this},t.prototype.fromRotationMatrix=function(e){return t.FromRotationMatrixToRef(e,this),this},t}(),zt=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.z=n}return Object.defineProperty(t.prototype,\"isNonUniform\",{get:function(){var t=Math.abs(this.x),e=Math.abs(this.y);if(t!==e)return!0;var n=Math.abs(this.z);return t!==n||e!==n},enumerable:!1,configurable:!0}),t.Add=function(e,n){return new t(e.x,e.y,e.z).addInPlace(n)},t.GetClipFactor=function(e,n,o,i){var r=t.Dot(e,o)-i;return r/(r-(t.Dot(n,o)-i))},t.GetAngleBetweenVectors=function(e,n,o){var i=e.normalizeToRef(Pt.Vector3[1]),r=n.normalizeToRef(Pt.Vector3[2]),s=t.Dot(i,r),a=Pt.Vector3[3];return t.CrossToRef(i,r,a),t.Dot(a,o)>0?Math.acos(s):-Math.acos(s)},t.FromArray=function(e,n){return void 0===n&&(n=0),new t(e[n],e[n+1],e[n+2])},t.FromFloatArray=function(e,n){return t.FromArray(e,n)},t.FromArrayToRef=function(t,e,n){n.x=t[e],n.y=t[e+1],n.z=t[e+2]},t.FromFloatArrayToRef=function(e,n,o){return t.FromArrayToRef(e,n,o)},t.FromFloatsToRef=function(t,e,n,o){o.copyFromFloats(t,e,n)},t.Zero=function(){return new t(0,0,0)},t.One=function(){return new t(1,1,1)},t.Up=function(){return new t(0,1,0)},t.Down=function(){return new t(0,-1,0)},t.Forward=function(){return new t(0,0,1)},t.Backward=function(){return new t(0,0,-1)},t.Right=function(){return new t(1,0,0)},t.Left=function(){return new t(-1,0,0)},t.TransformCoordinates=function(e,n){var o=t.Zero();return t.TransformCoordinatesToRef(e,n,o),o},t.TransformCoordinatesToRef=function(e,n,o){return t.TransformCoordinatesFromFloatsToRef(e.x,e.y,e.z,n,o)},t.TransformCoordinatesFromFloatsToRef=function(t,e,n,o,i){var r=o.m,s=t*r[0]+e*r[4]+n*r[8]+r[12],a=t*r[1]+e*r[5]+n*r[9]+r[13],u=t*r[2]+e*r[6]+n*r[10]+r[14],p=1/(t*r[3]+e*r[7]+n*r[11]+r[15]);i.x=s*p,i.y=a*p,i.z=u*p},t.TransformNormal=function(e,n){var o=t.Zero();return t.TransformNormalToRef(e,n,o),o},t.TransformNormalToRef=function(t,e,n){this.TransformNormalFromFloatsToRef(t.x,t.y,t.z,e,n)},t.TransformNormalFromFloatsToRef=function(t,e,n,o,i){var r=o.m;i.x=t*r[0]+e*r[4]+n*r[8],i.y=t*r[1]+e*r[5]+n*r[9],i.z=t*r[2]+e*r[6]+n*r[10]},t.CatmullRom=function(e,n,o,i,r){var s=r*r,a=r*s;return new t(.5*(2*n.x+(-e.x+o.x)*r+(2*e.x-5*n.x+4*o.x-i.x)*s+(-e.x+3*n.x-3*o.x+i.x)*a),.5*(2*n.y+(-e.y+o.y)*r+(2*e.y-5*n.y+4*o.y-i.y)*s+(-e.y+3*n.y-3*o.y+i.y)*a),.5*(2*n.z+(-e.z+o.z)*r+(2*e.z-5*n.z+4*o.z-i.z)*s+(-e.z+3*n.z-3*o.z+i.z)*a))},t.Clamp=function(e,n,o){var i=new t;return t.ClampToRef(e,n,o,i),i},t.ClampToRef=function(t,e,n,o){var i=t.x;i=(i=i>n.x?n.x:i)<e.x?e.x:i;var r=t.y;r=(r=r>n.y?n.y:r)<e.y?e.y:r;var s=t.z;s=(s=s>n.z?n.z:s)<e.z?e.z:s,o.copyFromFloats(i,r,s)},t.Hermite=function(e,n,o,i,r){var s=r*r,a=r*s,u=2*a-3*s+1,p=-2*a+3*s,h=a-2*s+r,c=a-s;return new t(e.x*u+o.x*p+n.x*h+i.x*c,e.y*u+o.y*p+n.y*h+i.y*c,e.z*u+o.z*p+n.z*h+i.z*c)},t.Lerp=function(e,n,o){var i=new t(0,0,0);return t.LerpToRef(e,n,o,i),i},t.LerpToRef=function(t,e,n,o){o.x=t.x+(e.x-t.x)*n,o.y=t.y+(e.y-t.y)*n,o.z=t.z+(e.z-t.z)*n},t.Dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},t.Cross=function(e,n){var o=t.Zero();return t.CrossToRef(e,n,o),o},t.CrossToRef=function(t,e,n){var o=t.y*e.z-t.z*e.y,i=t.z*e.x-t.x*e.z,r=t.x*e.y-t.y*e.x;n.copyFromFloats(o,i,r)},t.Normalize=function(e){var n=t.Zero();return t.NormalizeToRef(e,n),n},t.NormalizeToRef=function(t,e){t.normalizeToRef(e)},t.Minimize=function(e,n){var o=new t(e.x,e.y,e.z);return o.minimizeInPlace(n),o},t.Maximize=function(e,n){var o=new t(e.x,e.y,e.z);return o.maximizeInPlace(n),o},t.Distance=function(e,n){return Math.sqrt(t.DistanceSquared(e,n))},t.DistanceSquared=function(t,e){var n=t.x-e.x,o=t.y-e.y,i=t.z-e.z;return n*n+o*o+i*i},t.Center=function(e,n){var o=t.Add(e,n);return o.scaleInPlace(.5),o},t.RotationFromAxis=function(e,n,o){var i=t.Zero();return t.RotationFromAxisToRef(e,n,o,i),i},t.RotationFromAxisToRef=function(t,e,n,o){var i=Pt.Quaternion[0];It.RotationQuaternionFromAxisToRef(t,e,n,i),o.copyFrom(i.eulerAngles)},t.prototype.toString=function(){return\"(\"+this.x+\", \"+this.y+\", \"+this.z+\")\"},t.prototype.getClassName=function(){return\"Vector3\"},t.prototype.getHashCode=function(){var t=this.x||0;return t=397*(t=397*t^(this.y||0))^(this.z||0)},t.prototype.asArray=function(){var t=[];return this.toArray(t,0),t},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,this},t.prototype.toQuaternion=function(){return It.Identity.setEuler(this.y,this.x,this.z)},t.prototype.addInPlace=function(t){return this.addInPlaceFromFloats(t.x,t.y,t.z)},t.prototype.addInPlaceFromFloats=function(t,e,n){return this.x+=t,this.y+=e,this.z+=n,this},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z)},t.prototype.addToRef=function(t,e){return e.copyFromFloats(this.x+t.x,this.y+t.y,this.z+t.z)},t.prototype.subtractInPlace=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},t.prototype.subtract=function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z)},t.prototype.subtractToRef=function(t,e){return this.subtractFromFloatsToRef(t.x,t.y,t.z,e)},t.prototype.subtractFromFloats=function(e,n,o){return new t(this.x-e,this.y-n,this.z-o)},t.prototype.subtractFromFloatsToRef=function(t,e,n,o){return o.copyFromFloats(this.x-t,this.y-e,this.z-n)},t.prototype.applyMatrix4=function(t){this.applyMatrix4ToRef(t,this)},t.prototype.applyMatrix4ToRef=function(t,e){var n=this,o=n.x,i=n.y,r=n.z,s=t.m,a=1/(s[3]*o+s[7]*i+s[11]*r+s[15]);return e.x=(s[0]*o+s[4]*i+s[8]*r+s[12])*a,e.y=(s[1]*o+s[5]*i+s[9]*r+s[13])*a,e.z=(s[2]*o+s[6]*i+s[10]*r+s[14])*a,e},t.prototype.rotate=function(t){return this.rotateToRef(t,this)},t.prototype.rotateToRef=function(t,e){var n=this,o=n.x,i=n.y,r=n.z,s=t.x,a=t.y,u=t.z,p=t.w,h=p*o+a*r-u*i,c=p*i+u*o-s*r,l=p*r+s*i-a*o,d=-s*o-a*i-u*r;return e.x=h*p+d*-s+c*-u-l*-a,e.y=c*p+d*-a+l*-s-h*-u,e.z=l*p+d*-u+h*-a-c*-s,e},t.prototype.negate=function(){return new t(-this.x,-this.y,-this.z)},t.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this},t.prototype.scale=function(e){return new t(this.x*e,this.y*e,this.z*e)},t.prototype.scaleToRef=function(t,e){return e.copyFromFloats(this.x*t,this.y*t,this.z*t)},t.prototype.scaleAndAddToRef=function(t,e){return e.addInPlaceFromFloats(this.x*t,this.y*t,this.z*t)},t.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z},t.prototype.equalsWithEpsilon=function(t,e){return void 0===e&&(e=At),t&&Et.WithinEpsilon(this.x,t.x,e)&&Et.WithinEpsilon(this.y,t.y,e)&&Et.WithinEpsilon(this.z,t.z,e)},t.prototype.equalsToFloats=function(t,e,n){return this.x===t&&this.y===e&&this.z===n},t.prototype.multiplyInPlace=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},t.prototype.multiply=function(t){return this.multiplyByFloats(t.x,t.y,t.z)},t.prototype.multiplyToRef=function(t,e){return e.copyFromFloats(this.x*t.x,this.y*t.y,this.z*t.z)},t.prototype.multiplyByFloats=function(e,n,o){return new t(this.x*e,this.y*n,this.z*o)},t.prototype.divide=function(e){return new t(this.x/e.x,this.y/e.y,this.z/e.z)},t.prototype.divideToRef=function(t,e){return e.copyFromFloats(this.x/t.x,this.y/t.y,this.z/t.z)},t.prototype.divideInPlace=function(t){return this.divideToRef(t,this)},t.prototype.minimizeInPlace=function(t){return this.minimizeInPlaceFromFloats(t.x,t.y,t.z)},t.prototype.maximizeInPlace=function(t){return this.maximizeInPlaceFromFloats(t.x,t.y,t.z)},t.prototype.minimizeInPlaceFromFloats=function(t,e,n){return t<this.x&&(this.x=t),e<this.y&&(this.y=e),n<this.z&&(this.z=n),this},t.prototype.maximizeInPlaceFromFloats=function(t,e,n){return t>this.x&&(this.x=t),e>this.y&&(this.y=e),n>this.z&&(this.z=n),this},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))},t.prototype.fract=function(){return new t(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z))},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z},t.prototype.normalize=function(){return this.normalizeFromLength(this.length())},t.prototype.normalizeFromLength=function(t){return 0===t||1===t?this:this.scaleInPlace(1/t)},t.prototype.normalizeToNew=function(){var e=new t(0,0,0);return this.normalizeToRef(e),e},t.prototype.normalizeToRef=function(t){var e=this.length();return 0===e||1===e?t.copyFromFloats(this.x,this.y,this.z):this.scaleToRef(1/e,t)},t.prototype.clone=function(){return new t(this.x,this.y,this.z)},t.prototype.copyFrom=function(t){return this.copyFromFloats(t.x,t.y,t.z)},t.prototype.copyFromFloats=function(t,e,n){return this.x=t,this.y=e,this.z=n,this},t.prototype.set=function(t,e,n){return this.copyFromFloats(t,e,n)},t.prototype.setAll=function(t){return this.x=this.y=this.z=t,this},t}(),Pt={Vector3:v(6,zt.Zero),Matrix:v(2,Ct.Identity),Quaternion:v(3,It.Zero),staticUp:zt.Up(),tmpMatrix:Ct.Zero()},Ot=function(){function t(t){this._radians=t,this._radians<0&&(this._radians+=2*Math.PI)}return t.BetweenTwoPoints=function(e,n){var o=n.subtract(e);return new t(Math.atan2(o.y,o.x))},t.FromRadians=function(e){return new t(e)},t.FromDegrees=function(e){return new t(e*Math.PI/180)},t.prototype.degrees=function(){return 180*this._radians/Math.PI},t.prototype.radians=function(){return this._radians},t}(),Mt=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.Zero=function(){return new t(0,0)},t.One=function(){return new t(1,1)},t.Add=function(e,n){return new t(e.x,e.y).addInPlace(n)},t.FromArray=function(e,n){return void 0===n&&(n=0),new t(e[n],e[n+1])},t.FromArrayToRef=function(t,e,n){n.x=t[e],n.y=t[e+1]},t.CatmullRom=function(e,n,o,i,r){var s=r*r,a=r*s;return new t(.5*(2*n.x+(-e.x+o.x)*r+(2*e.x-5*n.x+4*o.x-i.x)*s+(-e.x+3*n.x-3*o.x+i.x)*a),.5*(2*n.y+(-e.y+o.y)*r+(2*e.y-5*n.y+4*o.y-i.y)*s+(-e.y+3*n.y-3*o.y+i.y)*a))},t.Clamp=function(e,n,o){var i=e.x;i=(i=i>o.x?o.x:i)<n.x?n.x:i;var r=e.y;return new t(i,r=(r=r>o.y?o.y:r)<n.y?n.y:r)},t.Hermite=function(e,n,o,i,r){var s=r*r,a=r*s,u=2*a-3*s+1,p=-2*a+3*s,h=a-2*s+r,c=a-s;return new t(e.x*u+o.x*p+n.x*h+i.x*c,e.y*u+o.y*p+n.y*h+i.y*c)},t.Lerp=function(e,n,o){return new t(e.x+(n.x-e.x)*o,e.y+(n.y-e.y)*o)},t.Dot=function(t,e){return t.x*e.x+t.y*e.y},t.Normalize=function(e){var n=new t(e.x,e.y);return n.normalize(),n},t.Minimize=function(e,n){return new t(e.x<n.x?e.x:n.x,e.y<n.y?e.y:n.y)},t.Maximize=function(e,n){return new t(e.x>n.x?e.x:n.x,e.y>n.y?e.y:n.y)},t.Transform=function(e,n){var o=t.Zero();return t.TransformToRef(e,n,o),o},t.TransformToRef=function(t,e,n){var o=e.m,i=t.x*o[0]+t.y*o[4]+o[12],r=t.x*o[1]+t.y*o[5]+o[13];n.x=i,n.y=r},t.PointInTriangle=function(t,e,n,o){var i=.5*(-n.y*o.x+e.y*(-n.x+o.x)+e.x*(n.y-o.y)+n.x*o.y),r=i<0?-1:1,s=(e.y*o.x-e.x*o.y+(o.y-e.y)*t.x+(e.x-o.x)*t.y)*r,a=(e.x*n.y-e.y*n.x+(e.y-n.y)*t.x+(n.x-e.x)*t.y)*r;return s>0&&a>0&&s+a<2*i*r},t.Distance=function(e,n){return Math.sqrt(t.DistanceSquared(e,n))},t.DistanceSquared=function(t,e){var n=t.x-e.x,o=t.y-e.y;return n*n+o*o},t.Center=function(e,n){var o=t.Add(e,n);return o.scaleInPlace(.5),o},t.DistanceOfPointFromSegment=function(e,n,o){var i=t.DistanceSquared(n,o);if(0===i)return t.Distance(e,n);var r=o.subtract(n),s=Math.max(0,Math.min(1,t.Dot(e.subtract(n),r)/i)),a=n.add(r.multiplyByFloats(s,s));return t.Distance(e,a)},t.prototype.toString=function(){return\"{X: \"+this.x+\" Y:\"+this.y+\"}\"},t.prototype.getClassName=function(){return\"Vector2\"},t.prototype.getHashCode=function(){var t=this.x||0;return t=397*t^(this.y||0)},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,this},t.prototype.asArray=function(){var t=new Array;return this.toArray(t,0),t},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.copyFromFloats=function(t,e){return this.x=t,this.y=e,this},t.prototype.set=function(t,e){return this.copyFromFloats(t,e)},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.addToRef=function(t,e){return e.x=this.x+t.x,e.y=this.y+t.y,this},t.prototype.addInPlace=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.addVector3=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.subtract=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.subtractToRef=function(t,e){return e.x=this.x-t.x,e.y=this.y-t.y,this},t.prototype.subtractInPlace=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.multiplyInPlace=function(t){return this.x*=t.x,this.y*=t.y,this},t.prototype.multiply=function(e){return new t(this.x*e.x,this.y*e.y)},t.prototype.multiplyToRef=function(t,e){return e.x=this.x*t.x,e.y=this.y*t.y,this},t.prototype.multiplyByFloats=function(e,n){return new t(this.x*e,this.y*n)},t.prototype.divide=function(e){return new t(this.x/e.x,this.y/e.y)},t.prototype.divideToRef=function(t,e){return e.x=this.x/t.x,e.y=this.y/t.y,this},t.prototype.divideInPlace=function(t){return this.divideToRef(t,this)},t.prototype.negate=function(){return new t(-this.x,-this.y)},t.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this},t.prototype.scale=function(e){var n=new t(0,0);return this.scaleToRef(e,n),n},t.prototype.scaleToRef=function(t,e){return e.x=this.x*t,e.y=this.y*t,this},t.prototype.scaleAndAddToRef=function(t,e){return e.x+=this.x*t,e.y+=this.y*t,this},t.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y},t.prototype.equalsWithEpsilon=function(t,e){return void 0===e&&(e=At),t&&Et.WithinEpsilon(this.x,t.x,e)&&Et.WithinEpsilon(this.y,t.y,e)},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t.prototype.fract=function(){return new t(this.x-Math.floor(this.x),this.y-Math.floor(this.y))},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},t.prototype.normalize=function(){var t=this.length();if(0===t)return this;var e=1/t;return this.x*=e,this.y*=e,this},t.prototype.clone=function(){return new t(this.x,this.y)},t}(),Ft=function(e,n,o){this.startPoint=e,this.midPoint=n,this.endPoint=o;var i=Math.pow(n.x,2)+Math.pow(n.y,2),r=(Math.pow(e.x,2)+Math.pow(e.y,2)-i)/2,s=(i-Math.pow(o.x,2)-Math.pow(o.y,2))/2,a=(e.x-n.x)*(n.y-o.y)-(n.x-o.x)*(e.y-n.y);this.centerPoint=new Mt((r*(n.y-o.y)-s*(e.y-n.y))/a,((e.x-n.x)*s-(n.x-o.x)*r)/a),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=Ot.BetweenTwoPoints(this.centerPoint,this.startPoint);var u=this.startAngle.degrees(),p=Ot.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),h=Ot.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();p-u>180&&(p-=360),p-u<-180&&(p+=360),h-p>180&&(h-=360),h-p<-180&&(h+=360),this.orientation=p-u<0?t.Orientation.CW:t.Orientation.CCW,this.angle=Ot.FromDegrees(this.orientation===t.Orientation.CW?u-h:h-u)},Lt=function(){function t(){}return t.X=new zt(1,0,0),t.Y=new zt(0,1,0),t.Z=new zt(0,0,1),t}(),Nt=function(){function t(){}return t.Interpolate=function(t,e,n,o,i){for(var r=1-3*o+3*e,s=3*o-6*e,a=3*e,u=t,p=0;p<5;p++){var h=u*u;u-=(r*(h*u)+s*h+a*u-t)*(1/(3*r*h+2*s*u+a)),u=Math.min(1,Math.max(0,u))}return 3*Math.pow(1-u,2)*u*n+3*(1-u)*Math.pow(u,2)*i+Math.pow(u,3)},t}(),Dt=function(){function t(t,e,n,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===o&&(o=1),this.r=t,this.g=e,this.b=n,this.a=o}return t.FromHexString=function(e){if(\"#\"!==e.substring(0,1)||9!==e.length)return new t(0,0,0,0);var n=parseInt(e.substring(1,3),16),o=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5,7),16),r=parseInt(e.substring(7,9),16);return t.FromInts(n,o,i,r)},t.Lerp=function(e,n,o){var i=new t(0,0,0,0);return t.LerpToRef(e,n,o,i),i},t.LerpToRef=function(t,e,n,o){o.r=t.r+(e.r-t.r)*n,o.g=t.g+(e.g-t.g)*n,o.b=t.b+(e.b-t.b)*n,o.a=t.a+(e.a-t.a)*n},t.Red=function(){return new t(1,0,0,1)},t.Green=function(){return new t(0,1,0,1)},t.Blue=function(){return new t(0,0,1,1)},t.Black=function(){return new t(0,0,0,1)},t.White=function(){return new t(1,1,1,1)},t.Purple=function(){return new t(.5,0,.5,1)},t.Magenta=function(){return new t(1,0,1,1)},t.Yellow=function(){return new t(1,1,0,1)},t.Gray=function(){return new t(.5,.5,.5,1)},t.Teal=function(){return new t(0,1,1,1)},t.Clear=function(){return new t(0,0,0,0)},t.FromColor3=function(e,n){return void 0===n&&(n=1),new t(e.r,e.g,e.b,n)},t.FromArray=function(e,n){return void 0===n&&(n=0),new t(e[n],e[n+1],e[n+2],e[n+3])},t.FromInts=function(e,n,o,i){return new t(e/255,n/255,o/255,i/255)},t.CheckColors4=function(t,e){if(t.length===3*e){for(var n=[],o=0;o<t.length;o+=3){var i=o/3*4;n[i]=t[o],n[i+1]=t[o+1],n[i+2]=t[o+2],n[i+3]=1}return n}return t},t.prototype.addInPlace=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this},t.prototype.asArray=function(){var t=new Array;return this.toArray(t,0),t},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t[e+3]=this.a,this},t.prototype.add=function(e){return new t(this.r+e.r,this.g+e.g,this.b+e.b,this.a+e.a)},t.prototype.subtract=function(e){return new t(this.r-e.r,this.g-e.g,this.b-e.b,this.a-e.a)},t.prototype.subtractToRef=function(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,e.a=this.a-t.a,this},t.prototype.scale=function(e){return new t(this.r*e,this.g*e,this.b*e,this.a*e)},t.prototype.scaleToRef=function(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,e.a=this.a*t,this},t.prototype.scaleAndAddToRef=function(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,e.a+=this.a*t,this},t.prototype.clampToRef=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=1),n.r=Et.Clamp(this.r,t,e),n.g=Et.Clamp(this.g,t,e),n.b=Et.Clamp(this.b,t,e),n.a=Et.Clamp(this.a,t,e),this},t.prototype.multiply=function(e){return new t(this.r*e.r,this.g*e.g,this.b*e.b,this.a*e.a)},t.prototype.multiplyToRef=function(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,e.a=this.a*t.a,e},t.prototype.toString=function(){return\"{R: \"+this.r+\" G:\"+this.g+\" B:\"+this.b+\" A:\"+this.a+\"}\"},t.prototype.getClassName=function(){return\"Color4\"},t.prototype.getHashCode=function(){var t=this.r||0;return t=397*(t=397*(t=397*t^(this.g||0))^(this.b||0))^(this.a||0)},t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.a)},t.prototype.copyFrom=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},t.prototype.copyFromFloats=function(t,e,n,o){return this.r=t,this.g=e,this.b=n,this.a=o,this},t.prototype.set=function(t,e,n,o){return this.copyFromFloats(t,e,n,o)},t.prototype.toHexString=function(){var t=255*this.r|0,e=255*this.g|0,n=255*this.b|0,o=255*this.a|0;return\"#\"+Et.ToHex(t)+Et.ToHex(e)+Et.ToHex(n)+Et.ToHex(o)},t.prototype.toLinearSpace=function(){var e=new t;return this.toLinearSpaceToRef(e),e},t.prototype.toLinearSpaceToRef=function(t){return t.r=Math.pow(this.r,Tt),t.g=Math.pow(this.g,Tt),t.b=Math.pow(this.b,Tt),t.a=this.a,this},t.prototype.toGammaSpace=function(){var e=new t;return this.toGammaSpaceToRef(e),e},t.prototype.toGammaSpaceToRef=function(t){return t.r=Math.pow(this.r,xt),t.g=Math.pow(this.g,xt),t.b=Math.pow(this.b,xt),t.a=this.a,this},t}(),Ut=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.r=t,this.g=e,this.b=n}return t.FromHexString=function(e){if(\"#\"!==e.substring(0,1)||7!==e.length)return new t(0,0,0);var n=parseInt(e.substring(1,3),16),o=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5,7),16);return t.FromInts(n,o,i)},t.FromArray=function(e,n){return void 0===n&&(n=0),new t(e[n],e[n+1],e[n+2])},t.FromInts=function(e,n,o){return new t(e/255,n/255,o/255)},t.Lerp=function(e,n,o){var i=new t(0,0,0);return t.LerpToRef(e,n,o,i),i},t.LerpToRef=function(t,e,n,o){o.r=t.r+(e.r-t.r)*n,o.g=t.g+(e.g-t.g)*n,o.b=t.b+(e.b-t.b)*n},t.Red=function(){return new t(1,0,0)},t.Green=function(){return new t(0,1,0)},t.Blue=function(){return new t(0,0,1)},t.Black=function(){return new t(0,0,0)},t.White=function(){return new t(1,1,1)},t.Purple=function(){return new t(.5,0,.5)},t.Magenta=function(){return new t(1,0,1)},t.Yellow=function(){return new t(1,1,0)},t.Gray=function(){return new t(.5,.5,.5)},t.Teal=function(){return new t(0,1,1)},t.Random=function(){return new t(Math.random(),Math.random(),Math.random())},t.prototype.toString=function(){return\"{R: \"+this.r+\" G:\"+this.g+\" B:\"+this.b+\"}\"},t.prototype.getClassName=function(){return\"Color3\"},t.prototype.getHashCode=function(){var t=this.r||0;return t=397*(t=397*t^(this.g||0))^(this.b||0)},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,this},t.prototype.toColor4=function(t){return void 0===t&&(t=1),new Dt(this.r,this.g,this.b,t)},t.prototype.asArray=function(){var t=new Array;return this.toArray(t,0),t},t.prototype.toLuminance=function(){return.3*this.r+.59*this.g+.11*this.b},t.prototype.multiply=function(e){return new t(this.r*e.r,this.g*e.g,this.b*e.b)},t.prototype.multiplyToRef=function(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,this},t.prototype.equals=function(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b},t.prototype.equalsFloats=function(t,e,n){return this.r===t&&this.g===e&&this.b===n},t.prototype.scale=function(e){return new t(this.r*e,this.g*e,this.b*e)},t.prototype.scaleToRef=function(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,this},t.prototype.scaleAndAddToRef=function(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,this},t.prototype.clampToRef=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=1),n.r=Et.Clamp(this.r,t,e),n.g=Et.Clamp(this.g,t,e),n.b=Et.Clamp(this.b,t,e),this},t.prototype.add=function(e){return new t(this.r+e.r,this.g+e.g,this.b+e.b)},t.prototype.addToRef=function(t,e){return e.r=this.r+t.r,e.g=this.g+t.g,e.b=this.b+t.b,this},t.prototype.subtract=function(e){return new t(this.r-e.r,this.g-e.g,this.b-e.b)},t.prototype.subtractToRef=function(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,this},t.prototype.clone=function(){return new t(this.r,this.g,this.b)},t.prototype.copyFrom=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},t.prototype.copyFromFloats=function(t,e,n){return this.r=t,this.g=e,this.b=n,this},t.prototype.set=function(t,e,n){return this.copyFromFloats(t,e,n)},t.prototype.toHexString=function(){var t=255*this.r|0,e=255*this.g|0,n=255*this.b|0;return\"#\"+Et.ToHex(t)+Et.ToHex(e)+Et.ToHex(n)},t.prototype.toLinearSpace=function(){var e=new t;return this.toLinearSpaceToRef(e),e},t.prototype.toLinearSpaceToRef=function(t){return t.r=Math.pow(this.r,Tt),t.g=Math.pow(this.g,Tt),t.b=Math.pow(this.b,Tt),this},t.prototype.toGammaSpace=function(){var e=new t;return this.toGammaSpaceToRef(e),e},t.prototype.toGammaSpaceToRef=function(t){return t.r=Math.pow(this.r,xt),t.g=Math.pow(this.g,xt),t.b=Math.pow(this.b,xt),this},t.prototype.toJSON=function(){return{r:this.r,g:this.g,b:this.b}},t}(),Bt=function(){function t(t){this._length=0,this._points=t,this._length=this._computeLength(t)}return t.CreateQuadraticBezier=function(e,n,o,i){i=i>2?i:3;for(var r=new Array,s=function(t,e,n,o){return(1-t)*(1-t)*e+2*t*(1-t)*n+t*t*o},a=0;a<=i;a++)r.push(new zt(s(a/i,e.x,n.x,o.x),s(a/i,e.y,n.y,o.y),s(a/i,e.z,n.z,o.z)));return new t(r)},t.CreateCubicBezier=function(e,n,o,i,r){r=r>3?r:4;for(var s=new Array,a=function(t,e,n,o,i){return(1-t)*(1-t)*(1-t)*e+3*t*(1-t)*(1-t)*n+3*t*t*(1-t)*o+t*t*t*i},u=0;u<=r;u++)s.push(new zt(a(u/r,e.x,n.x,o.x,i.x),a(u/r,e.y,n.y,o.y,i.y),a(u/r,e.z,n.z,o.z,i.z)));return new t(s)},t.CreateHermiteSpline=function(e,n,o,i,r){for(var s=new Array,a=1/r,u=0;u<=r;u++)s.push(zt.Hermite(e,n,o,i,u*a));return new t(s)},t.CreateCatmullRomSpline=function(e,n,o){var i=new Array,r=1/n,s=0;if(o){for(var a=e.length,u=0;u<a;u++){s=0;for(var p=0;p<n;p++)i.push(zt.CatmullRom(e[u%a],e[(u+1)%a],e[(u+2)%a],e[(u+3)%a],s)),s+=r}i.push(i[0])}else{var h=new Array;h.push(e[0].clone()),Array.prototype.push.apply(h,e),h.push(e[e.length-1].clone());u=0;for(u=0;u<h.length-3;u++){s=0;for(p=0;p<n;p++)i.push(zt.CatmullRom(h[u],h[u+1],h[u+2],h[u+3],s)),s+=r}u--,i.push(zt.CatmullRom(h[u],h[u+1],h[u+2],h[u+3],s))}return new t(i)},t.prototype.getPoints=function(){return this._points},t.prototype.length=function(){return this._length},t.prototype.continue=function(e){for(var n=this._points[this._points.length-1],o=this._points.slice(),i=e.getPoints(),r=1;r<i.length;r++)o.push(i[r].subtract(i[0]).add(n));return new t(o)},t.prototype._computeLength=function(t){for(var e=0,n=1;n<t.length;n++)e+=t[n].subtract(t[n-1]).length();return e},t}(),Ht=function(){function t(t,e,n,o){this.normal=new zt(t,e,n),this.d=o}return t.FromArray=function(e){return new t(e[0],e[1],e[2],e[3])},t.FromPoints=function(e,n,o){var i=new t(0,0,0,0);return i.copyFromPoints(e,n,o),i},t.FromPositionAndNormal=function(e,n){var o=new t(0,0,0,0);return n.normalize(),o.normal=n,o.d=-(n.x*e.x+n.y*e.y+n.z*e.z),o},t.SignedDistanceToPlaneFromPositionAndNormal=function(t,e,n){var o=-(e.x*t.x+e.y*t.y+e.z*t.z);return zt.Dot(n,e)+o},t.prototype.asArray=function(){return[this.normal.x,this.normal.y,this.normal.z,this.d]},t.prototype.clone=function(){return new t(this.normal.x,this.normal.y,this.normal.z,this.d)},t.prototype.getClassName=function(){return\"Plane\"},t.prototype.getHashCode=function(){var t=this.normal.getHashCode();return t=397*t^(this.d||0)},t.prototype.normalize=function(){var t=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z),e=0;return 0!==t&&(e=1/t),this.normal.x*=e,this.normal.y*=e,this.normal.z*=e,this.d*=e,this},t.prototype.transform=function(e){var n=Pt.Matrix[0];Ct.TransposeToRef(e,n);var o=n.m,i=this.normal.x,r=this.normal.y,s=this.normal.z,a=this.d;return new t(i*o[0]+r*o[1]+s*o[2]+a*o[3],i*o[4]+r*o[5]+s*o[6]+a*o[7],i*o[8]+r*o[9]+s*o[10]+a*o[11],i*o[12]+r*o[13]+s*o[14]+a*o[15])},t.prototype.dotCoordinate=function(t){return this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z+this.d},t.prototype.copyFromPoints=function(t,e,n){var o,i=e.x-t.x,r=e.y-t.y,s=e.z-t.z,a=n.x-t.x,u=n.y-t.y,p=n.z-t.z,h=r*p-s*u,c=s*a-i*p,l=i*u-r*a,d=Math.sqrt(h*h+c*c+l*l);return o=0!==d?1/d:0,this.normal.x=h*o,this.normal.y=c*o,this.normal.z=l*o,this.d=-(this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z),this},t.prototype.isFrontFacingTo=function(t,e){return zt.Dot(this.normal,t)<=e},t.prototype.signedDistanceTo=function(t){return zt.Dot(t,this.normal)+this.d},t}(),kt=function(){function t(){}return t.GetPlanes=function(e){for(var n=[],o=0;o<6;o++)n.push(new Ht(0,0,0,0));return t.GetPlanesToRef(e,n),n},t.GetNearPlaneToRef=function(t,e){var n=t.m;e.normal.x=n[3]+n[2],e.normal.y=n[7]+n[6],e.normal.z=n[11]+n[10],e.d=n[15]+n[14],e.normalize()},t.GetFarPlaneToRef=function(t,e){var n=t.m;e.normal.x=n[3]-n[2],e.normal.y=n[7]-n[6],e.normal.z=n[11]-n[10],e.d=n[15]-n[14],e.normalize()},t.GetLeftPlaneToRef=function(t,e){var n=t.m;e.normal.x=n[3]+n[0],e.normal.y=n[7]+n[4],e.normal.z=n[11]+n[8],e.d=n[15]+n[12],e.normalize()},t.GetRightPlaneToRef=function(t,e){var n=t.m;e.normal.x=n[3]-n[0],e.normal.y=n[7]-n[4],e.normal.z=n[11]-n[8],e.d=n[15]-n[12],e.normalize()},t.GetTopPlaneToRef=function(t,e){var n=t.m;e.normal.x=n[3]-n[1],e.normal.y=n[7]-n[5],e.normal.z=n[11]-n[9],e.d=n[15]-n[13],e.normalize()},t.GetBottomPlaneToRef=function(t,e){var n=t.m;e.normal.x=n[3]+n[1],e.normal.y=n[7]+n[5],e.normal.z=n[11]+n[9],e.d=n[15]+n[13],e.normalize()},t.GetPlanesToRef=function(e,n){t.GetNearPlaneToRef(e,n[0]),t.GetFarPlaneToRef(e,n[1]),t.GetLeftPlaneToRef(e,n[2]),t.GetRightPlaneToRef(e,n[3]),t.GetTopPlaneToRef(e,n[4]),t.GetBottomPlaneToRef(e,n[5])},t}(),Vt=function(){function e(t,e){this.closed=!1,this._points=new Array,this._length=0,this._points.push(new Mt(t,e))}return e.StartingAt=function(t,n){return new e(t,n)},e.prototype.addLineTo=function(t,e){if(this.closed)return this;var n=new Mt(t,e),o=this._points[this._points.length-1];return this._points.push(n),this._length+=n.subtract(o).length(),this},e.prototype.addArcTo=function(e,n,o,i,r){if(void 0===r&&(r=36),this.closed)return this;var s=this._points[this._points.length-1],a=new Mt(e,n),u=new Mt(o,i),p=new Ft(s,a,u),h=p.angle.radians()/r;p.orientation===t.Orientation.CW&&(h*=-1);for(var c=p.startAngle.radians()+h,l=0;l<r;l++){var d=Math.cos(c)*p.radius+p.centerPoint.x,f=Math.sin(c)*p.radius+p.centerPoint.y;this.addLineTo(d,f),c+=h}return this},e.prototype.close=function(){return this.closed=!0,this},e.prototype.length=function(){var t=this._length;if(!this.closed){var e=this._points[this._points.length-1];t+=this._points[0].subtract(e).length()}return t},e.prototype.getPoints=function(){return this._points},e.prototype.getPointAtLengthPosition=function(t){if(t<0||t>1)return Mt.Zero();for(var e=t*this.length(),n=0,o=0;o<this._points.length;o++){var i=(o+1)%this._points.length,r=this._points[o],s=this._points[i].subtract(r),a=s.length()+n;if(e>=n&&e<=a){var u=s.normalize(),p=e-n;return new Mt(r.x+u.x*p,r.y+u.y*p)}n=a}return Mt.Zero()},e}(),qt=function(){function t(t,e,n){void 0===e&&(e=null),this.path=t,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array;for(var o=0;o<t.length;o++)this._curve[o]=t[o].clone();this._raw=n||!1,this._compute(e)}return t.prototype.getCurve=function(){return this._curve},t.prototype.getTangents=function(){return this._tangents},t.prototype.getNormals=function(){return this._normals},t.prototype.getBinormals=function(){return this._binormals},t.prototype.getDistances=function(){return this._distances},t.prototype.update=function(t,e){void 0===e&&(e=null);for(var n=0;n<t.length;n++)this._curve[n].x=t[n].x,this._curve[n].y=t[n].y,this._curve[n].z=t[n].z;return this._compute(e),this},t.prototype._compute=function(t){var e=this._curve.length;this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[e-1]=this._curve[e-1].subtract(this._curve[e-2]),this._raw||this._tangents[e-1].normalize();var n,o,i,r,s=this._tangents[0],a=this._normalVector(this._curve[0],s,t);this._normals[0]=a,this._raw||this._normals[0].normalize(),this._binormals[0]=zt.Cross(s,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;for(var u=1;u<e;u++)n=this._getLastNonNullVector(u),u<e-1&&(o=this._getFirstNonNullVector(u),this._tangents[u]=n.add(o),this._tangents[u].normalize()),this._distances[u]=this._distances[u-1]+n.length(),i=this._tangents[u],r=this._binormals[u-1],this._normals[u]=zt.Cross(r,i),this._raw||this._normals[u].normalize(),this._binormals[u]=zt.Cross(i,this._normals[u]),this._raw||this._binormals[u].normalize()},t.prototype._getFirstNonNullVector=function(t){for(var e=1,n=this._curve[t+e].subtract(this._curve[t]);0===n.length()&&t+e+1<this._curve.length;)e++,n=this._curve[t+e].subtract(this._curve[t]);return n},t.prototype._getLastNonNullVector=function(t){for(var e=1,n=this._curve[t].subtract(this._curve[t-e]);0===n.length()&&t>e+1;)e++,n=this._curve[t].subtract(this._curve[t-e]);return n},t.prototype._normalVector=function(t,e,n){var o,i=e.length();if(0===i&&(i=1),null==n){var r=void 0;r=Et.WithinEpsilon(Math.abs(e.y)/i,1,At)?Et.WithinEpsilon(Math.abs(e.x)/i,1,At)?Et.WithinEpsilon(Math.abs(e.z)/i,1,At)?zt.Zero():new zt(0,0,1):new zt(1,0,0):new zt(0,-1,0),o=zt.Cross(e,r)}else o=zt.Cross(e,n),zt.CrossToRef(o,e,o);return o.normalize(),o},t}(),Wt=function(){function t(t,e){this.width=t,this.height=e}return Object.defineProperty(t.prototype,\"surface\",{get:function(){return this.width*this.height},enumerable:!1,configurable:!0}),t.Zero=function(){return new t(0,0)},t.Lerp=function(e,n,o){return new t(e.width+(n.width-e.width)*o,e.height+(n.height-e.height)*o)},t.prototype.toString=function(){return\"{W: \"+this.width+\", H: \"+this.height+\"}\"},t.prototype.getClassName=function(){return\"Size\"},t.prototype.getHashCode=function(){var t=this.width||0;return t=397*t^(this.height||0)},t.prototype.copyFrom=function(t){this.width=t.width,this.height=t.height},t.prototype.copyFromFloats=function(t,e){return this.width=t,this.height=e,this},t.prototype.set=function(t,e){return this.copyFromFloats(t,e)},t.prototype.multiplyByFloats=function(e,n){return new t(this.width*e,this.height*n)},t.prototype.clone=function(){return new t(this.width,this.height)},t.prototype.equals=function(t){return!!t&&(this.width===t.width&&this.height===t.height)},t.prototype.add=function(e){return new t(this.width+e.width,this.height+e.height)},t.prototype.subtract=function(e){return new t(this.width-e.width,this.height-e.height)},t}(),Gt={looping:!0,speed:1,weight:1,layer:0},jt=function(t){function e(e,n){void 0===n&&(n=Gt);var o=t.call(this)||this;return o.isAnimationClip=!0,o.looping=Gt.looping,o.weight=Gt.weight,o.playing=!1,o.shouldReset=!1,o.speed=Gt.speed,o.name=f(\"AnimClip\"),o.layer=Gt.layer,o.clip=e,o.setParams(i({},n)),o}return o(e,t),e.prototype.setParams=function(t){return this.looping=void 0!==t.looping?t.looping:this.looping,this.speed=t.speed||this.speed,this.weight=t.weight||this.weight,this.layer=t.layer||this.layer,this},e.prototype.toJSON=function(){var e=JSON.parse(JSON.stringify(t.prototype.toJSON.call(this)));return this.shouldReset&&(this.shouldReset=!1),e},e.prototype.play=function(t){var e;void 0===t&&(t=!1),null===(e=this.owner)||void 0===e||e.play(this,t)},e.prototype.pause=function(){var t;null===(t=this.owner)||void 0===t||t.pause(this)},e.prototype.reset=function(){this.shouldReset=!0},e.prototype.stop=function(){var t;null===(t=this.owner)||void 0===t||t.stop(this)},r([U.readonly],e.prototype,\"clip\",void 0),r([U.field],e.prototype,\"looping\",void 0),r([U.field],e.prototype,\"weight\",void 0),r([U.field],e.prototype,\"playing\",void 0),r([U.field],e.prototype,\"shouldReset\",void 0),r([U.field],e.prototype,\"speed\",void 0),r([U.readonly],e.prototype,\"name\",void 0),e}(U);t.InputEventType=void 0,(_t=t.InputEventType||(t.InputEventType={}))[_t.DOWN=0]=\"DOWN\",_t[_t.UP=1]=\"UP\",t.CameraMode=void 0,(wt=t.CameraMode||(t.CameraMode={}))[wt.FirstPerson=0]=\"FirstPerson\",wt[wt.ThirdPerson=1]=\"ThirdPerson\",wt[wt.BuildingToolGodMode=2]=\"BuildingToolGodMode\";var Yt,Xt;t.LandRole=void 0,(Yt=t.LandRole||(t.LandRole={})).OWNER=\"owner\",Yt.OPERATOR=\"operator\",t.ActionButton=void 0,(Xt=t.ActionButton||(t.ActionButton={})).POINTER=\"POINTER\",Xt.PRIMARY=\"PRIMARY\",Xt.SECONDARY=\"SECONDARY\",Xt.ANY=\"ANY\",Xt.FORWARD=\"FORWARD\",Xt.BACKWARD=\"BACKWARD\",Xt.RIGHT=\"RIGHT\",Xt.LEFT=\"LEFT\",Xt.JUMP=\"JUMP\",Xt.WALK=\"WALK\",Xt.ACTION_3=\"ACTION_3\",Xt.ACTION_4=\"ACTION_4\",Xt.ACTION_5=\"ACTION_5\",Xt.ACTION_6=\"ACTION_6\";var Zt,Jt,Kt=function(t){if(this.callback=t,!t||!(\"apply\"in t)||!(\"call\"in t))throw new Error(\"Callback is not a function\");ee.ensureInstance()},Qt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e=r([M(\"pointerDown\")],e)}(Kt),$t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e=r([M(\"pointerUp\")],e)}(Kt),te=function(t,e){this.fn=t,this.useRaycast=e},ee=function(){function e(){this.buttonIdMapping=[t.ActionButton.POINTER,t.ActionButton.PRIMARY,t.ActionButton.SECONDARY,t.ActionButton.ANY,t.ActionButton.FORWARD,t.ActionButton.BACKWARD,t.ActionButton.RIGHT,t.ActionButton.LEFT,t.ActionButton.JUMP,t.ActionButton.WALK,t.ActionButton.ACTION_3,t.ActionButton.ACTION_4,t.ActionButton.ACTION_5,t.ActionButton.ACTION_6],this.subscriptions=this.buttonIdMapping.reduce((function(t,e){var n;return i(i({},t),((n={})[e]={BUTTON_DOWN:[],BUTTON_UP:[]},n))}),{}),this.internalState=this.buttonIdMapping.reduce((function(t,e){var n;return i(i({},t),((n={})[e]={BUTTON_DOWN:!1},n))}),{})}return Object.defineProperty(e,\"instance\",{get:function(){return e.ensureInstance(),e._instance},enumerable:!1,configurable:!0}),e.ensureInstance=function(){e._instance||(e._instance=new e)},e.prototype.isButtonPressed=function(t){return this.internalState[t]},e.prototype.subscribe=function(t,e,n,o){var i=this;return this.subscriptions[e][t].push(new te(o,n)),function(){i.unsubscribe(t,e,o)}},e.prototype.unsubscribe=function(t,e,n){var o=this.getSubscriptionId(t,e,n);return o>-1&&this.subscriptions[e][t].splice(o,1)},e.prototype.handlePointerEvent=function(e){var n=this.getPointerById(e.buttonId);if(n){var o=i(i({},e),{button:n,direction:(new zt).copyFrom(e.direction),origin:(new zt).copyFrom(e.origin),hit:void 0}),r=e.hit?i(i({},e.hit),{hitPoint:(new zt).copyFrom(e.hit.hitPoint),normal:(new zt).copyFrom(e.hit.normal),worldNormal:(new zt).copyFrom(e.hit.worldNormal)}):void 0;if(e.type===t.InputEventType.DOWN){this.internalState[n].BUTTON_DOWN=!0;for(var s=0;s<this.subscriptions[n].BUTTON_DOWN.length;s++){(a=this.subscriptions[n].BUTTON_DOWN[s]).useRaycast?o.hit=r:o.hit=void 0,a.fn(o)}if(r&&r.entityId&&F.engine)(p=(u=F.engine.entities[r.entityId])&&u.getComponentOrNull(Qt))&&(o.hit=r,p.callback(o))}else{this.internalState[n].BUTTON_DOWN=!1;for(s=0;s<this.subscriptions[n].BUTTON_UP.length;s++){var a;(a=this.subscriptions[n].BUTTON_UP[s]).useRaycast?o.hit=r:o.hit=void 0,a.fn(o)}var u,p;if(r&&r.entityId&&F.engine)(p=(u=F.engine.entities[r.entityId])&&u.getComponentOrNull($t))&&(o.hit=r,p.callback(o))}}},e.prototype.getSubscriptionId=function(t,e,n){for(var o=0;o<this.subscriptions[e][t].length;o++)if(this.subscriptions[e][t][o].fn===n)return o;return-1},e.prototype.getPointerById=function(e){if(e<0||e>=this.buttonIdMapping.length)return null;var n=this.buttonIdMapping[e];return n===t.ActionButton.ANY?null:n},e}();t.CLASS_ID=void 0,(Zt=t.CLASS_ID||(t.CLASS_ID={}))[Zt.TRANSFORM=1]=\"TRANSFORM\",Zt[Zt.UUID_CALLBACK=8]=\"UUID_CALLBACK\",Zt[Zt.BOX_SHAPE=16]=\"BOX_SHAPE\",Zt[Zt.SPHERE_SHAPE=17]=\"SPHERE_SHAPE\",Zt[Zt.PLANE_SHAPE=18]=\"PLANE_SHAPE\",Zt[Zt.CONE_SHAPE=19]=\"CONE_SHAPE\",Zt[Zt.CYLINDER_SHAPE=20]=\"CYLINDER_SHAPE\",Zt[Zt.TEXT_SHAPE=21]=\"TEXT_SHAPE\",Zt[Zt.NFT_SHAPE=22]=\"NFT_SHAPE\",Zt[Zt.UI_WORLD_SPACE_SHAPE=23]=\"UI_WORLD_SPACE_SHAPE\",Zt[Zt.UI_SCREEN_SPACE_SHAPE=24]=\"UI_SCREEN_SPACE_SHAPE\",Zt[Zt.UI_CONTAINER_RECT=25]=\"UI_CONTAINER_RECT\",Zt[Zt.UI_CONTAINER_STACK=26]=\"UI_CONTAINER_STACK\",Zt[Zt.UI_TEXT_SHAPE=27]=\"UI_TEXT_SHAPE\",Zt[Zt.UI_INPUT_TEXT_SHAPE=28]=\"UI_INPUT_TEXT_SHAPE\",Zt[Zt.UI_IMAGE_SHAPE=29]=\"UI_IMAGE_SHAPE\",Zt[Zt.UI_SLIDER_SHAPE=30]=\"UI_SLIDER_SHAPE\",Zt[Zt.CIRCLE_SHAPE=31]=\"CIRCLE_SHAPE\",Zt[Zt.BILLBOARD=32]=\"BILLBOARD\",Zt[Zt.ANIMATION=33]=\"ANIMATION\",Zt[Zt.FONT=34]=\"FONT\",Zt[Zt.UI_FULLSCREEN_SHAPE=40]=\"UI_FULLSCREEN_SHAPE\",Zt[Zt.UI_BUTTON_SHAPE=41]=\"UI_BUTTON_SHAPE\",Zt[Zt.GLTF_SHAPE=54]=\"GLTF_SHAPE\",Zt[Zt.OBJ_SHAPE=55]=\"OBJ_SHAPE\",Zt[Zt.AVATAR_SHAPE=56]=\"AVATAR_SHAPE\",Zt[Zt.BASIC_MATERIAL=64]=\"BASIC_MATERIAL\",Zt[Zt.PBR_MATERIAL=65]=\"PBR_MATERIAL\",Zt[Zt.HIGHLIGHT_ENTITY=66]=\"HIGHLIGHT_ENTITY\",Zt[Zt.SOUND=67]=\"SOUND\",Zt[Zt.TEXTURE=68]=\"TEXTURE\",Zt[Zt.VIDEO_CLIP=70]=\"VIDEO_CLIP\",Zt[Zt.VIDEO_TEXTURE=71]=\"VIDEO_TEXTURE\",Zt[Zt.AUDIO_CLIP=200]=\"AUDIO_CLIP\",Zt[Zt.AUDIO_SOURCE=201]=\"AUDIO_SOURCE\",Zt[Zt.AUDIO_STREAM=202]=\"AUDIO_STREAM\",Zt[Zt.GIZMOS=203]=\"GIZMOS\",Zt[Zt.SMART_ITEM=204]=\"SMART_ITEM\",Zt[Zt.AVATAR_MODIFIER_AREA=205]=\"AVATAR_MODIFIER_AREA\",Zt[Zt.NAME=300]=\"NAME\",Zt[Zt.LOCKED_ON_EDIT=301]=\"LOCKED_ON_EDIT\",Zt[Zt.VISIBLE_ON_EDIT=302]=\"VISIBLE_ON_EDIT\",t.AvatarModifiers=void 0,(Jt=t.AvatarModifiers||(t.AvatarModifiers={})).HIDE_AVATARS=\"HIDE_AVATARS\",Jt.DISABLE_PASSPORTS=\"DISABLE_PASSPORTS\";var ne,oe=function(e){function n(t){var n=e.call(this)||this;return n.area=t.area,n.modifiers=t.modifiers,n}return o(n,e),r([U.field],n.prototype,\"area\",void 0),r([U.field],n.prototype,\"modifiers\",void 0),n=r([M(\"engine.avatarModifierArea\",t.CLASS_ID.AVATAR_MODIFIER_AREA)],n)}(U),ie=function(e){function n(t){void 0===t&&(t={});var n=e.call(this)||this;return n.position=t.position||zt.Zero(),n.rotation=t.rotation||It.Identity,n.scale=t.scale||new zt(1,1,1),n}return o(n,e),Object.defineProperty(n.prototype,\"eulerAngles\",{get:function(){return this.rotation.eulerAngles},enumerable:!1,configurable:!0}),n.prototype.lookAt=function(t,e){void 0===e&&(e=Pt.staticUp);var n=new Ct;return Ct.LookAtLHToRef(this.position,t,e,n),n.invert(),It.FromRotationMatrixToRef(n,this.rotation),this},n.prototype.rotate=function(t,e){return this.rotation.multiplyInPlace(this.rotation.angleAxis(e,t)),this},n.prototype.translate=function(t){return this.position.addInPlace(t),this},r([U.field],n.prototype,\"position\",void 0),r([U.field],n.prototype,\"rotation\",void 0),r([U.field],n.prototype,\"scale\",void 0),n=r([M(\"engine.transform\",t.CLASS_ID.TRANSFORM)],n)}(U),re=function(e){function n(t,n,o){void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===o&&(o=!0);var i=e.call(this)||this;return i.x=!0,i.y=!0,i.z=!0,i.x=t,i.y=n,i.z=o,i}return o(n,e),r([U.field],n.prototype,\"x\",void 0),r([U.field],n.prototype,\"y\",void 0),r([U.field],n.prototype,\"z\",void 0),n=r([M(\"engine.billboard\",t.CLASS_ID.BILLBOARD)],n)}(U),se=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.withCollisions=!0,e.isPointerBlocker=!0,e.visible=!0,e}return o(e,t),r([U.field],e.prototype,\"withCollisions\",void 0),r([U.field],e.prototype,\"isPointerBlocker\",void 0),r([U.field],e.prototype,\"visible\",void 0),e}(U),ae=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e),r([U.field],n.prototype,\"uvs\",void 0),n=r([F(\"engine.shape\",t.CLASS_ID.BOX_SHAPE)],n)}(se),ue=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e),n=r([F(\"engine.shape\",t.CLASS_ID.SPHERE_SHAPE)],n)}(se),pe=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e),r([U.field],n.prototype,\"segments\",void 0),r([U.field],n.prototype,\"arc\",void 0),n=r([F(\"engine.shape\",t.CLASS_ID.CIRCLE_SHAPE)],n)}(se),he=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.width=1,t.height=1,t}return o(n,e),r([U.field],n.prototype,\"width\",void 0),r([U.field],n.prototype,\"height\",void 0),r([U.field],n.prototype,\"uvs\",void 0),n=r([F(\"engine.shape\",t.CLASS_ID.PLANE_SHAPE)],n)}(se),ce=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.radiusTop=0,t.radiusBottom=1,t.segmentsHeight=1,t.segmentsRadial=36,t.openEnded=!1,t.radius=null,t.arc=360,t}return o(n,e),r([U.field],n.prototype,\"radiusTop\",void 0),r([U.field],n.prototype,\"radiusBottom\",void 0),r([U.field],n.prototype,\"segmentsHeight\",void 0),r([U.field],n.prototype,\"segmentsRadial\",void 0),r([U.field],n.prototype,\"openEnded\",void 0),r([U.field],n.prototype,\"radius\",void 0),r([U.field],n.prototype,\"arc\",void 0),n=r([F(\"engine.shape\",t.CLASS_ID.CONE_SHAPE)],n)}(se),le=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.radiusTop=1,t.radiusBottom=1,t.segmentsHeight=1,t.segmentsRadial=36,t.openEnded=!1,t.radius=null,t.arc=360,t}return o(n,e),r([U.field],n.prototype,\"radiusTop\",void 0),r([U.field],n.prototype,\"radiusBottom\",void 0),r([U.field],n.prototype,\"segmentsHeight\",void 0),r([U.field],n.prototype,\"segmentsRadial\",void 0),r([U.field],n.prototype,\"openEnded\",void 0),r([U.field],n.prototype,\"radius\",void 0),r([U.field],n.prototype,\"arc\",void 0),n=r([F(\"engine.shape\",t.CLASS_ID.CYLINDER_SHAPE)],n)}(se),de=function(e){function n(t){var n=e.call(this)||this;return n.src=t,n}return o(n,e),r([se.readonly],n.prototype,\"src\",void 0),n=r([F(\"engine.shape\",t.CLASS_ID.GLTF_SHAPE)],n)}(se);t.PictureFrameStyle=void 0,(ne=t.PictureFrameStyle||(t.PictureFrameStyle={}))[ne.Classic=0]=\"Classic\",ne[ne.Baroque_Ornament=1]=\"Baroque_Ornament\",ne[ne.Diamond_Ornament=2]=\"Diamond_Ornament\",ne[ne.Minimal_Wide=3]=\"Minimal_Wide\",ne[ne.Minimal_Grey=4]=\"Minimal_Grey\",ne[ne.Blocky=5]=\"Blocky\",ne[ne.Gold_Edges=6]=\"Gold_Edges\",ne[ne.Gold_Carved=7]=\"Gold_Carved\",ne[ne.Gold_Wide=8]=\"Gold_Wide\",ne[ne.Gold_Rounded=9]=\"Gold_Rounded\",ne[ne.Metal_Medium=10]=\"Metal_Medium\",ne[ne.Metal_Wide=11]=\"Metal_Wide\",ne[ne.Metal_Slim=12]=\"Metal_Slim\",ne[ne.Metal_Rounded=13]=\"Metal_Rounded\",ne[ne.Pins=14]=\"Pins\",ne[ne.Minimal_Black=15]=\"Minimal_Black\",ne[ne.Minimal_White=16]=\"Minimal_White\",ne[ne.Tape=17]=\"Tape\",ne[ne.Wood_Slim=18]=\"Wood_Slim\",ne[ne.Wood_Wide=19]=\"Wood_Wide\",ne[ne.Wood_Twigs=20]=\"Wood_Twigs\",ne[ne.Canvas=21]=\"Canvas\",ne[ne.None=22]=\"None\";var fe,ye=function(e){function n(n,o){void 0===o&&(o={});var i=e.call(this)||this;i.src=n;var r=new Ut(.6404918,.611472,.8584906),s=t.PictureFrameStyle.Classic;return\"r\"in o?r=o:null!=o&&(o.color&&(r=o.color),o.style&&(s=o.style)),i.color=r,i.style=s,i}return o(n,e),r([se.readonly],n.prototype,\"src\",void 0),r([se.readonly],n.prototype,\"style\",void 0),r([U.field],n.prototype,\"color\",void 0),n=r([F(\"engine.shape\",t.CLASS_ID.NFT_SHAPE)],n)}(se),ve=function(e){function n(t,n){var o=e.call(this)||this;if(o.src=t,n)for(var i in n){o[i]=n[i]}return o}return o(n,e),r([U.readonly],n.prototype,\"src\",void 0),r([U.readonly],n.prototype,\"samplingMode\",void 0),r([U.readonly],n.prototype,\"wrap\",void 0),r([U.readonly],n.prototype,\"hasAlpha\",void 0),n=r([F(\"engine.texture\",t.CLASS_ID.TEXTURE)],n)}(U),me=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.states=[],t}return o(n,e),n.prototype.addClip=function(t){var e=this;return this.states.push(t),t.onChange((function(){e.dirty=!0})),t.owner=this,this},n.prototype.getClip=function(t){for(var e=0;e<this.states.length;e++){var n=this.states[e];if(n.clip===t)return n}var o=new jt(t);return this.addClip(o),o},n.prototype.stop=function(t){if(t)t.playing=!1,t.shouldReset=!0;else for(var e=0;e<this.states.length;e++){var n=this.states[e];this.stop(n)}},n.prototype.play=function(t,e){void 0===e&&(e=!1);for(var n=0;n<this.states.length;n++){var o=this.states[n];o.layer===t.layer&&t!==o&&this.pause(o)}e&&(t.shouldReset=!0),t.playing=!0,t.dirty=!0,t.data.nonce=Math.random()},n.prototype.pause=function(t){if(t)t.playing=!1;else for(var e=0;e<this.states.length;e++){var n=this.states[e];this.pause(n)}},r([U.readonly],n.prototype,\"states\",void 0),n=r([M(\"engine.animator\",t.CLASS_ID.ANIMATION)],n)}(se),ge=function(e){function n(t){var n=e.call(this)||this;return n.src=t,n}return o(n,e),r([U.readonly],n.prototype,\"src\",void 0),n=r([F(\"engine.shape\",t.CLASS_ID.OBJ_SHAPE)],n)}(se),_e=function(e){function n(t){void 0===t&&(t=\"\");var n=e.call(this)||this;return n.src=t,n}return o(n,e),r([U.readonly],n.prototype,\"src\",void 0),n=r([F(\"engine.font\",t.CLASS_ID.FONT)],n)}(U);t.Fonts=void 0,(fe=t.Fonts||(t.Fonts={})).SanFrancisco=\"builtin:SF-UI-Text-Regular SDF\",fe.SanFrancisco_Heavy=\"builtin:SF-UI-Text-Heavy SDF\",fe.SanFrancisco_Semibold=\"builtin:SF-UI-Text-Semibold SDF\",fe.LiberationSans=\"builtin:LiberationSans SDF\",fe.SansSerif=\"SansSerif\",fe.SansSerif_Heavy=\"SansSerif_Heavy\",fe.SansSerif_Bold=\"SansSerif_Bold\",fe.SansSerif_SemiBold=\"SansSerif_SemiBold\";var we,xe=function(e){function n(t){var n=e.call(this)||this;return n.outlineWidth=0,n.outlineColor=new Ut(1,1,1),n.color=new Ut(1,1,1),n.fontSize=10,n.opacity=1,n.value=\"\",n.lineSpacing=\"0px\",n.lineCount=0,n.textWrapping=!1,n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowColor=new Ut(1,1,1),n.hTextAlign=\"center\",n.vTextAlign=\"center\",n.width=1,n.height=1,n.paddingTop=0,n.paddingRight=0,n.paddingBottom=0,n.paddingLeft=0,n.billboard=!1,n.visible=!0,t&&(n.value=t),n}return o(n,e),r([U.field],n.prototype,\"outlineWidth\",void 0),r([U.field],n.prototype,\"outlineColor\",void 0),r([U.field],n.prototype,\"color\",void 0),r([U.field],n.prototype,\"fontSize\",void 0),r([U.component],n.prototype,\"font\",void 0),r([U.field],n.prototype,\"opacity\",void 0),r([U.field],n.prototype,\"value\",void 0),r([U.field],n.prototype,\"lineSpacing\",void 0),r([U.field],n.prototype,\"lineCount\",void 0),r([U.field],n.prototype,\"textWrapping\",void 0),r([U.field],n.prototype,\"shadowBlur\",void 0),r([U.field],n.prototype,\"shadowOffsetX\",void 0),r([U.field],n.prototype,\"shadowOffsetY\",void 0),r([U.field],n.prototype,\"shadowColor\",void 0),r([U.field],n.prototype,\"hTextAlign\",void 0),r([U.field],n.prototype,\"vTextAlign\",void 0),r([U.field],n.prototype,\"width\",void 0),r([U.field],n.prototype,\"height\",void 0),r([U.field],n.prototype,\"paddingTop\",void 0),r([U.field],n.prototype,\"paddingRight\",void 0),r([U.field],n.prototype,\"paddingBottom\",void 0),r([U.field],n.prototype,\"paddingLeft\",void 0),r([U.field],n.prototype,\"billboard\",void 0),r([U.field],n.prototype,\"visible\",void 0),n=r([M(\"engine.text\",t.CLASS_ID.TEXT_SHAPE)],n)}(U);t.TransparencyMode=void 0,(we=t.TransparencyMode||(t.TransparencyMode={}))[we.OPAQUE=0]=\"OPAQUE\",we[we.ALPHA_TEST=1]=\"ALPHA_TEST\",we[we.ALPHA_BLEND=2]=\"ALPHA_BLEND\",we[we.ALPHA_TEST_AND_BLEND=3]=\"ALPHA_TEST_AND_BLEND\",we[we.AUTO=4]=\"AUTO\";var Te,Ae=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.alphaTest=.5,n.castShadows=!0,n.transparencyMode=t.TransparencyMode.AUTO,n}return o(n,e),r([U.field],n.prototype,\"alphaTest\",void 0),r([U.field],n.prototype,\"albedoColor\",void 0),r([U.field],n.prototype,\"emissiveColor\",void 0),r([U.field],n.prototype,\"metallic\",void 0),r([U.field],n.prototype,\"roughness\",void 0),r([U.field],n.prototype,\"reflectivityColor\",void 0),r([U.field],n.prototype,\"directIntensity\",void 0),r([U.field],n.prototype,\"microSurface\",void 0),r([U.field],n.prototype,\"emissiveIntensity\",void 0),r([U.field],n.prototype,\"specularIntensity\",void 0),r([U.component],n.prototype,\"albedoTexture\",void 0),r([U.component],n.prototype,\"alphaTexture\",void 0),r([U.component],n.prototype,\"emissiveTexture\",void 0),r([U.component],n.prototype,\"bumpTexture\",void 0),r([U.field],n.prototype,\"castShadows\",void 0),r([U.field],n.prototype,\"transparencyMode\",void 0),n=r([F(\"engine.material\",t.CLASS_ID.PBR_MATERIAL)],n)}(U),Re=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.alphaTest=.5,t.castShadows=!0,t}return o(n,e),r([U.component],n.prototype,\"texture\",void 0),r([U.field],n.prototype,\"alphaTest\",void 0),r([U.field],n.prototype,\"castShadows\",void 0),n=r([F(\"engine.material\",t.CLASS_ID.BASIC_MATERIAL)],n)}(U),be=function(t){function e(e){var n=t.call(this)||this;if(n.uuid=f(\"UUID\"),!e||!(\"apply\"in e)||!(\"call\"in e))throw new Error(\"Callback is not a function\");return n.callback=e,n}return o(e,t),e.uuidEvent=function(t,n){if(delete t[n]){var o=n+\"_\"+Math.random();t[o]=void 0,Object.defineProperty(t,o,i(i({},Object.getOwnPropertyDescriptor(t,o)),{enumerable:!1})),Object.defineProperty(t,n.toString(),{get:function(){return this[o]},set:function(t){var i=this[o];if(t){if(!(t instanceof e))throw new Error(\"value is not an OnUUIDEvent\");this.data[n]=t.uuid}else this.data[n]=null;if(this[o]=t,t!==i){this.dirty=!0;for(var r=0;r<this.subscriptions.length;r++)this.subscriptions[r](n,t,i)}},enumerable:!0})}},e.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type}},r([U.field],e.prototype,\"callback\",void 0),e}(U),Ee=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.button=t.ActionButton.ANY,n.hoverText=\"Interact\",n.distance=10,n.showFeedback=!0,n}return o(n,e),n.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type,button:this.button,hoverText:this.hoverText,distance:this.distance,showFeedback:this.showFeedback}},r([U.field],n.prototype,\"button\",void 0),r([U.field],n.prototype,\"hoverText\",void 0),r([U.field],n.prototype,\"distance\",void 0),r([U.field],n.prototype,\"showFeedback\",void 0),n}(be),Se=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=\"onPointerLock\",t}return o(n,e),r([U.readonly],n.prototype,\"type\",void 0),n=r([M(\"engine.onPointerLock\",t.CLASS_ID.UUID_CALLBACK)],n)}(be),Ce=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=\"onAnimationEnd\",t}return o(n,e),r([U.readonly],n.prototype,\"type\",void 0),n=r([M(\"engine.onAnimationEnd\",t.CLASS_ID.UUID_CALLBACK)],n)}(be),Ie=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e),n=r([M(\"engine.smartItem\",t.CLASS_ID.SMART_ITEM)],n)}(U),ze=function(e){function n(t){var n=e.call(this)||this;return n.url=t,n}return o(n,e),r([U.readonly],n.prototype,\"url\",void 0),n=r([F(\"engine.VideoClip\",t.CLASS_ID.VIDEO_CLIP)],n)}(U);t.VideoStatus=void 0,(Te=t.VideoStatus||(t.VideoStatus={}))[Te.NONE=0]=\"NONE\",Te[Te.ERROR=1]=\"ERROR\",Te[Te.LOADING=2]=\"LOADING\",Te[Te.READY=3]=\"READY\",Te[Te.PLAYING=4]=\"PLAYING\",Te[Te.BUFFERING=5]=\"BUFFERING\";var Pe,Oe=function(e){function n(n,o){var i=e.call(this)||this;if(i.volume=1,i.playbackRate=1,i.loop=!1,i.seek=-1,i._position=-1,i._videoLength=-1,i._status=t.VideoStatus.NONE,i.playing=!1,!(n instanceof ze))throw new Error(\"Trying to create VideoTexture(VideoClip) with an invalid VideoClip\");if(i.videoClipId=D(n),o)for(var r in o){i[r]=o[r]}return i}return o(n,e),n.prototype.play=function(){this.playing=!0},n.prototype.pause=function(){this.playing=!1},n.prototype.reset=function(){this.seekTime(0),this.pause()},n.prototype.seekTime=function(t){this.seek=t,this.dirty=!0,this.data.nonce=Math.random()},n.prototype.toJSON=function(){if(this.seek>=0){var t=JSON.parse(JSON.stringify(e.prototype.toJSON.call(this)));return this.seek=-1,t}return e.prototype.toJSON.call(this)},n.prototype.update=function(e){e.videoClipId==this.videoClipId&&(this._status=e.videoStatus||t.VideoStatus.NONE,this._videoLength=e.totalVideoLength,this._position=e.currentOffset)},Object.defineProperty(n.prototype,\"position\",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,\"videoLength\",{get:function(){return this._videoLength},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,\"status\",{get:function(){return this._status},enumerable:!1,configurable:!0}),r([U.readonly],n.prototype,\"videoClipId\",void 0),r([U.readonly],n.prototype,\"samplingMode\",void 0),r([U.readonly],n.prototype,\"wrap\",void 0),r([U.field],n.prototype,\"volume\",void 0),r([U.field],n.prototype,\"playbackRate\",void 0),r([U.field],n.prototype,\"loop\",void 0),r([U.field],n.prototype,\"seek\",void 0),r([U.field],n.prototype,\"playing\",void 0),n=r([F(\"engine.VideoTexture\",t.CLASS_ID.VIDEO_TEXTURE)],n)}(U),Me=function(){function e(){var e=this;this.position=new zt,this.rotation=new It,this.feetPosition=new zt,this.worldPosition=new zt,this.lastEventPosition={x:0,y:0,z:0},this.lastEventWorldPosition={x:0,y:0,z:0},this.lastEventRotation={x:0,y:0,z:0,w:1},this._playerHeight=1.6,this._cameraMode=t.CameraMode.FirstPerson,\"undefined\"!=typeof dcl&&(dcl.subscribe(\"positionChanged\"),dcl.subscribe(\"rotationChanged\"),dcl.subscribe(\"cameraModeChanged\"),dcl.onEvent((function(t){switch(t.type){case\"positionChanged\":e.positionChanged(t.data);break;case\"rotationChanged\":e.rotationChanged(t.data);break;case\"cameraModeChanged\":e.cameraModeChanged(t.data)}}))),Object.defineProperty(this.position,\"x\",{get:function(){return e.lastEventPosition.x}}),Object.defineProperty(this.position,\"y\",{get:function(){return e.lastEventPosition.y}}),Object.defineProperty(this.position,\"z\",{get:function(){return e.lastEventPosition.z}}),Object.defineProperty(this.worldPosition,\"x\",{get:function(){return e.lastEventWorldPosition.x}}),Object.defineProperty(this.worldPosition,\"y\",{get:function(){return e.lastEventWorldPosition.y}}),Object.defineProperty(this.worldPosition,\"z\",{get:function(){return e.lastEventWorldPosition.z}}),Object.defineProperty(this.feetPosition,\"x\",{get:function(){return e.lastEventPosition.x}}),Object.defineProperty(this.feetPosition,\"y\",{get:function(){return e.lastEventPosition.y-e.playerHeight}}),Object.defineProperty(this.feetPosition,\"z\",{get:function(){return e.lastEventPosition.z}}),Object.defineProperty(this.rotation,\"x\",{get:function(){return e.lastEventRotation.x}}),Object.defineProperty(this.rotation,\"y\",{get:function(){return e.lastEventRotation.y}}),Object.defineProperty(this.rotation,\"z\",{get:function(){return e.lastEventRotation.z}}),Object.defineProperty(this.rotation,\"w\",{get:function(){return e.lastEventRotation.w}})}return Object.defineProperty(e,\"instance\",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"playerHeight\",{get:function(){return this._playerHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"cameraMode\",{get:function(){return this._cameraMode},enumerable:!1,configurable:!0}),e.prototype.positionChanged=function(t){this.lastEventPosition=t.position,this.lastEventWorldPosition=t.cameraPosition,this._playerHeight=t.playerHeight},e.prototype.rotationChanged=function(t){this.lastEventRotation=t.quaternion},e.prototype.cameraModeChanged=function(t){this._cameraMode=t.cameraMode},e}();!function(t){t.HitFirst=\"rqhf\",t.HitAll=\"rqha\"}(Pe||(Pe={}));var Fe,Le=function(){function t(){this.queries={}}return Object.defineProperty(t,\"instance\",{get:function(){return t.ensureInstance(),t._instance},enumerable:!1,configurable:!0}),t.ensureInstance=function(){t._instance||(t._instance=new t)},t.prototype.getRayFromCamera=function(t){var e=Me.instance.rotation,n=Ct.Identity();e.toRotationMatrix(n);var o=zt.TransformCoordinates(zt.Forward(),n);return{origin:Me.instance.position,direction:o,distance:t}},t.prototype.getRayFromPositions=function(t,e){var n=e.subtract(t),o=n.length();return{origin:t,direction:n.normalize(),distance:o}},t.prototype.hitFirst=function(t,e,n){var o=\"number\"==typeof n?Pe.HitFirst+n:y();this.queries[o]=e,\"undefined\"!=typeof dcl&&dcl.query(\"raycast\",{queryId:o,queryType:\"HitFirst\",ray:t})},t.prototype.hitAll=function(t,e,n){var o=\"number\"==typeof n?Pe.HitAll+n:y();this.queries[o]=e,\"undefined\"!=typeof dcl&&dcl.query(\"raycast\",{queryId:o,queryType:\"HitAll\",ray:t})},t.prototype.hitFirstAvatar=function(t,e){l(\"not implemented yet\")},t.prototype.hitAllAvatars=function(t,e){l(\"not implemented yet\")},t.prototype.handleRaycastHitFirstResponse=function(t){this.queries[t.payload.queryId](t.payload.payload),delete this.queries[t.payload.queryId]},t.prototype.handleRaycastHitAllResponse=function(t){this.queries[t.payload.queryId](t.payload.payload),delete this.queries[t.payload.queryId]},t}(),Ne=function(){function t(){}return t.prototype.activate=function(t){t.eventManager.addListener(Q,this,(function(t){\"HitFirst\"===t.payload.queryType?Le.instance.handleRaycastHitFirstResponse(t):\"HitAll\"===t.payload.queryType&&Le.instance.handleRaycastHitAllResponse(t)})),\"undefined\"!=typeof dcl&&dcl.subscribe(\"raycastResponse\")},t.prototype.deactivate=function(){\"undefined\"!=typeof dcl&&dcl.unsubscribe(\"raycastResponse\")},t}(),De=function(){function t(){}return t.prototype.activate=function(t){t.eventManager.addListener($,this,(function(t){ee.instance.handlePointerEvent(t.payload)})),\"undefined\"!=typeof dcl&&(dcl.subscribe(\"pointerUp\"),dcl.subscribe(\"pointerDown\"),dcl.subscribe(\"actionButtonEvent\"))},t.prototype.deactivate=function(){\"undefined\"!=typeof dcl&&(dcl.unsubscribe(\"pointerUp\"),dcl.unsubscribe(\"pointerDown\"),dcl.unsubscribe(\"actionButtonEvent\"))},t}(),Ue=function(){function t(){this.handlerMap={}}return t.prototype.activate=function(t){t.eventManager.addListener(K,this,this.handleEvent),t.eventManager.addListener(R,this,this.componentAdded),t.eventManager.addListener(A,this,this.componentRemoved),\"undefined\"!=typeof dcl&&dcl.subscribe(\"uuidEvent\")},t.prototype.deactivate=function(){\"undefined\"!=typeof dcl&&dcl.unsubscribe(\"uuidEvent\")},t.prototype.onAddEntity=function(t){for(var e in t.components){var n=t.components[e];n instanceof be&&(this.handlerMap[n.uuid]=n)}},t.prototype.onRemoveEntity=function(t){for(var e in t.components){var n=t.components[e];n instanceof be&&delete this.handlerMap[n.uuid]}},t.prototype.componentAdded=function(t){if(t.entity.isAddedToEngine()){var e=t.entity.components[t.componentName];e instanceof be&&(this.handlerMap[e.uuid]=e)}},t.prototype.componentRemoved=function(t){t.entity.isAddedToEngine()&&t.component instanceof be&&delete this.handlerMap[t.component.uuid]},t.prototype.handleEvent=function(t){if(t.uuid in this.handlerMap){var e=this.handlerMap[t.uuid];e&&e.callback&&\"call\"in e.callback&&e.callback(t.payload)}},t}(),Be=new Ne,He=new De,ke=new Ue,Ve=function(e){function n(t){var n=e.call(this)||this;return n.loop=!1,n.volume=1,n.url=t,n}return o(n,e),r([U.readonly],n.prototype,\"url\",void 0),r([U.field],n.prototype,\"loop\",void 0),r([U.field],n.prototype,\"loadingCompleteEventId\",void 0),r([U.field],n.prototype,\"volume\",void 0),n=r([F(\"engine.AudioClip\",t.CLASS_ID.AUDIO_CLIP)],n)}(U),qe=function(e){function n(t){var n=e.call(this)||this;if(n.audioClip=t,n.loop=!1,n.volume=1,n.playing=!1,n.pitch=1,n.playedAtTimestamp=Date.now(),!(t instanceof Ve))throw new Error(\"Trying to create AudioSource(AudioClip) with an invalid AudioClip\");return n.audioClipId=D(t),n}return o(n,e),n.prototype.playOnce=function(){return this.playing=!0,this.dirty=!0,this.playedAtTimestamp=Date.now(),this.data.nonce=Math.random(),this},r([U.readonly],n.prototype,\"audioClipId\",void 0),r([U.field],n.prototype,\"loop\",void 0),r([U.field],n.prototype,\"volume\",void 0),r([U.field],n.prototype,\"playing\",void 0),r([U.field],n.prototype,\"pitch\",void 0),r([U.field],n.prototype,\"playedAtTimestamp\",void 0),n=r([M(\"engine.AudioSource\",t.CLASS_ID.AUDIO_SOURCE)],n)}(U),We=function(e){function n(t){var n=e.call(this)||this;return n.playing=!1,n.volume=1,n.url=t,n.playing=!0,n}return o(n,e),r([U.readonly],n.prototype,\"url\",void 0),r([U.field],n.prototype,\"playing\",void 0),r([U.field],n.prototype,\"volume\",void 0),n=r([M(\"engine.AudioStream\",t.CLASS_ID.AUDIO_STREAM)],n)}(U);t.Gizmo=void 0,(Fe=t.Gizmo||(t.Gizmo={})).MOVE=\"MOVE\",Fe.ROTATE=\"ROTATE\",Fe.SCALE=\"SCALE\",Fe.NONE=\"NONE\";var Ge,je=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=\"gizmoEvent\",t}return o(n,e),r([U.readonly],n.prototype,\"type\",void 0),n=r([M(\"engine.gizmoEvent\",t.CLASS_ID.UUID_CALLBACK)],n)}(be),Ye=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.position=!0,t.rotation=!0,t.scale=!0,t.cycle=!0,t.localReference=!1,t}return o(n,e),r([U.field],n.prototype,\"position\",void 0),r([U.field],n.prototype,\"rotation\",void 0),r([U.field],n.prototype,\"scale\",void 0),r([U.field],n.prototype,\"cycle\",void 0),r([U.field],n.prototype,\"selectedGizmo\",void 0),r([U.field],n.prototype,\"localReference\",void 0),n=r([M(\"engine.gizmos\",t.CLASS_ID.GIZMOS)],n)}(U),Xe=function(e){function n(t){var n=e.call(this,t)||this;return n.type=\"onFocus\",ke.handlerMap[n.uuid]=n,n}return o(n,e),r([U.readonly],n.prototype,\"type\",void 0),n=r([M(\"engine.onFocus\",t.CLASS_ID.UUID_CALLBACK)],n)}(be),Ze=function(e){function n(t){var n=e.call(this,t)||this;return n.type=\"onTextSubmit\",ke.handlerMap[n.uuid]=n,n}return o(n,e),r([U.readonly],n.prototype,\"type\",void 0),n=r([M(\"engine.onTextSubmit\",t.CLASS_ID.UUID_CALLBACK)],n)}(be),Je=function(e){function n(t){var n=e.call(this,t)||this;return n.type=\"onBlur\",ke.handlerMap[n.uuid]=n,n}return o(n,e),r([U.readonly],n.prototype,\"type\",void 0),n=r([M(\"engine.onBlur\",t.CLASS_ID.UUID_CALLBACK)],n)}(be),Ke=function(e){function n(t){var n=e.call(this,t)||this;return n.type=\"onEnter\",ke.handlerMap[n.uuid]=n,n}return o(n,e),r([U.readonly],n.prototype,\"type\",void 0),n=r([M(\"engine.onEnter\",t.CLASS_ID.UUID_CALLBACK)],n)}(be),Qe=function(e){function n(t){var n=e.call(this,t)||this;return n.type=\"onChange\",ke.handlerMap[n.uuid]=n,n}return o(n,e),r([U.readonly],n.prototype,\"type\",void 0),n=r([M(\"engine.onChange\",t.CLASS_ID.UUID_CALLBACK)],n)}(be),$e=function(e){function n(t,n){var o=e.call(this,t)||this;return o.type=\"onClick\",ke.handlerMap[o.uuid]=o,n&&(o.showFeedback=!(!1===n.showFeedback),n.button&&(o.button=n.button),n.hoverText&&(o.hoverText=n.hoverText),n.distance&&(o.distance=n.distance)),o}return o(n,e),r([U.readonly],n.prototype,\"type\",void 0),n=r([M(\"engine.onClick\",t.CLASS_ID.UUID_CALLBACK)],n)}(Ee),tn=function(e){function n(t,n){var o=e.call(this,t)||this;return o.type=\"pointerDown\",ke.handlerMap[o.uuid]=o,n&&(o.showFeedback=!(!1===n.showFeedback),n.button&&(o.button=n.button),n.hoverText&&(o.hoverText=n.hoverText),n.distance&&(o.distance=n.distance)),o}return o(n,e),r([U.readonly],n.prototype,\"type\",void 0),n=r([M(\"engine.pointerDown\",t.CLASS_ID.UUID_CALLBACK)],n)}(Ee),en=function(e){function n(t,n){var o=e.call(this,t)||this;return o.type=\"pointerUp\",ke.handlerMap[o.uuid]=o,n&&(o.showFeedback=!(!1===n.showFeedback),n.button&&(o.button=n.button),n.hoverText&&(o.hoverText=n.hoverText),n.distance&&(o.distance=n.distance)),o}return o(n,e),r([U.readonly],n.prototype,\"type\",void 0),n=r([M(\"engine.pointerUp\",t.CLASS_ID.UUID_CALLBACK)],n)}(Ee),nn=function(t){function e(e){var n=t.call(this)||this;return n.name=null,n.visible=!0,n.opacity=1,n.hAlign=\"center\",n.vAlign=\"center\",n.width=\"100px\",n.height=\"50px\",n.positionX=\"0px\",n.positionY=\"0px\",n.isPointerBlocker=!0,e&&(n._parent=e,n.data.parentComponent=D(e)),n}return o(e,t),Object.defineProperty(e.prototype,\"parent\",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,\"parentComponent\",{get:function(){return this.data.parentComponent},enumerable:!1,configurable:!0}),r([U.field],e.prototype,\"name\",void 0),r([U.field],e.prototype,\"visible\",void 0),r([U.field],e.prototype,\"opacity\",void 0),r([U.field],e.prototype,\"hAlign\",void 0),r([U.field],e.prototype,\"vAlign\",void 0),r([U.uiValue],e.prototype,\"width\",void 0),r([U.uiValue],e.prototype,\"height\",void 0),r([U.uiValue],e.prototype,\"positionX\",void 0),r([U.uiValue],e.prototype,\"positionY\",void 0),r([U.field],e.prototype,\"isPointerBlocker\",void 0),e}(U),on=function(e){function n(){return e.call(this,null)||this}return o(n,e),n=r([F(\"engine.shape\",t.CLASS_ID.UI_FULLSCREEN_SHAPE)],n)}(nn),rn=function(e){function n(){return e.call(this,null)||this}return o(n,e),n=r([F(\"engine.shape\",t.CLASS_ID.UI_WORLD_SPACE_SHAPE)],n)}(nn),sn=function(e){function n(){return e.call(this,null)||this}return o(n,e),n=r([F(\"engine.shape\",t.CLASS_ID.UI_SCREEN_SPACE_SHAPE)],n)}(nn),an=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.thickness=0,t.color=Dt.Clear(),t.alignmentUsesSize=!0,t}return o(n,e),r([U.field],n.prototype,\"thickness\",void 0),r([U.field],n.prototype,\"color\",void 0),r([U.field],n.prototype,\"alignmentUsesSize\",void 0),n=r([F(\"engine.shape\",t.CLASS_ID.UI_CONTAINER_RECT)],n)}(nn);t.UIStackOrientation=void 0,(Ge=t.UIStackOrientation||(t.UIStackOrientation={}))[Ge.VERTICAL=0]=\"VERTICAL\",Ge[Ge.HORIZONTAL=1]=\"HORIZONTAL\";var un=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.adaptWidth=!0,n.adaptHeight=!0,n.color=Dt.Clear(),n.stackOrientation=t.UIStackOrientation.VERTICAL,n.spacing=0,n}return o(n,e),r([U.field],n.prototype,\"adaptWidth\",void 0),r([U.field],n.prototype,\"adaptHeight\",void 0),r([U.field],n.prototype,\"color\",void 0),r([U.field],n.prototype,\"stackOrientation\",void 0),r([U.field],n.prototype,\"spacing\",void 0),n=r([F(\"engine.shape\",t.CLASS_ID.UI_CONTAINER_STACK)],n)}(nn),pn=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.fontSize=10,t.fontWeight=\"normal\",t.thickness=0,t.cornerRadius=0,t.color=Dt.White(),t.background=Dt.White(),t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.paddingLeft=0,t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor=Dt.Black(),t.text=\"button\",t}return o(n,e),r([U.field],n.prototype,\"fontSize\",void 0),r([U.field],n.prototype,\"fontWeight\",void 0),r([U.field],n.prototype,\"thickness\",void 0),r([U.field],n.prototype,\"cornerRadius\",void 0),r([U.field],n.prototype,\"color\",void 0),r([U.field],n.prototype,\"background\",void 0),r([U.field],n.prototype,\"paddingTop\",void 0),r([U.field],n.prototype,\"paddingRight\",void 0),r([U.field],n.prototype,\"paddingBottom\",void 0),r([U.field],n.prototype,\"paddingLeft\",void 0),r([U.field],n.prototype,\"shadowBlur\",void 0),r([U.field],n.prototype,\"shadowOffsetX\",void 0),r([U.field],n.prototype,\"shadowOffsetY\",void 0),r([U.field],n.prototype,\"shadowColor\",void 0),r([U.field],n.prototype,\"text\",void 0),n=r([F(\"engine.shape\",t.CLASS_ID.UI_BUTTON_SHAPE)],n)}(nn),hn=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.outlineWidth=0,t.outlineColor=Dt.White(),t.color=Dt.White(),t.fontSize=10,t.fontAutoSize=!1,t.value=\"\",t.lineSpacing=0,t.lineCount=0,t.adaptWidth=!1,t.adaptHeight=!1,t.textWrapping=!1,t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor=Dt.Black(),t.hTextAlign=\"left\",t.vTextAlign=\"bottom\",t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.paddingLeft=0,t}return o(n,e),r([U.field],n.prototype,\"outlineWidth\",void 0),r([U.field],n.prototype,\"outlineColor\",void 0),r([U.field],n.prototype,\"color\",void 0),r([U.field],n.prototype,\"fontSize\",void 0),r([U.field],n.prototype,\"fontAutoSize\",void 0),r([U.component],n.prototype,\"font\",void 0),r([U.field],n.prototype,\"value\",void 0),r([U.field],n.prototype,\"lineSpacing\",void 0),r([U.field],n.prototype,\"lineCount\",void 0),r([U.field],n.prototype,\"adaptWidth\",void 0),r([U.field],n.prototype,\"adaptHeight\",void 0),r([U.field],n.prototype,\"textWrapping\",void 0),r([U.field],n.prototype,\"shadowBlur\",void 0),r([U.field],n.prototype,\"shadowOffsetX\",void 0),r([U.field],n.prototype,\"shadowOffsetY\",void 0),r([U.field],n.prototype,\"shadowColor\",void 0),r([U.field],n.prototype,\"hTextAlign\",void 0),r([U.field],n.prototype,\"vTextAlign\",void 0),r([U.field],n.prototype,\"paddingTop\",void 0),r([U.field],n.prototype,\"paddingRight\",void 0),r([U.field],n.prototype,\"paddingBottom\",void 0),r([U.field],n.prototype,\"paddingLeft\",void 0),n=r([F(\"engine.shape\",t.CLASS_ID.UI_TEXT_SHAPE)],n)}(nn),cn=function(e){function n(t){var n=e.call(this,t)||this;return n.outlineWidth=0,n.outlineColor=Dt.Black(),n.color=Dt.Clear(),n.fontSize=10,n.value=\"\",n.placeholder=\"\",n.margin=10,n.hTextAlign=\"left\",n.vTextAlign=\"bottom\",n.focusedBackground=Dt.Black(),n.textWrapping=!1,n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowColor=Dt.White(),n.paddingTop=0,n.paddingRight=0,n.paddingBottom=0,n.paddingLeft=0,n.onTextSubmit=null,n.onChanged=null,n.onFocus=null,n.onBlur=null,n.onTextChanged=new Qe((function(t){var e=t.value,o=e.value,i=e.isSubmit,r=n.dirty;if(n.value=o,n.dirty=r,i&&n.onTextSubmit){var s={text:o};n.onTextSubmit.callback(s)}else if(!i&&n.onChanged){var a={value:o,pointerId:t.pointerId};n.onChanged.callback(a)}})),n}return o(n,e),r([U.field],n.prototype,\"outlineWidth\",void 0),r([U.field],n.prototype,\"outlineColor\",void 0),r([U.field],n.prototype,\"color\",void 0),r([U.field],n.prototype,\"fontSize\",void 0),r([U.component],n.prototype,\"font\",void 0),r([U.field],n.prototype,\"value\",void 0),r([U.field],n.prototype,\"placeholder\",void 0),r([U.field],n.prototype,\"margin\",void 0),r([U.field],n.prototype,\"hTextAlign\",void 0),r([U.field],n.prototype,\"vTextAlign\",void 0),r([U.field],n.prototype,\"focusedBackground\",void 0),r([U.field],n.prototype,\"textWrapping\",void 0),r([U.field],n.prototype,\"shadowBlur\",void 0),r([U.field],n.prototype,\"shadowOffsetX\",void 0),r([U.field],n.prototype,\"shadowOffsetY\",void 0),r([U.field],n.prototype,\"shadowColor\",void 0),r([U.field],n.prototype,\"paddingTop\",void 0),r([U.field],n.prototype,\"paddingRight\",void 0),r([U.field],n.prototype,\"paddingBottom\",void 0),r([U.field],n.prototype,\"paddingLeft\",void 0),r([be.uuidEvent],n.prototype,\"onTextChanged\",void 0),r([be.uuidEvent],n.prototype,\"onFocus\",void 0),r([be.uuidEvent],n.prototype,\"onBlur\",void 0),n=r([F(\"engine.shape\",t.CLASS_ID.UI_INPUT_TEXT_SHAPE)],n)}(nn),ln=function(e){function n(t,n){var o=e.call(this,t)||this;return o.sourceLeft=0,o.sourceTop=0,o.sourceWidth=1,o.sourceHeight=1,o.paddingTop=0,o.paddingRight=0,o.paddingBottom=0,o.paddingLeft=0,o.sizeInPixels=!0,o.onClick=null,o.source=n,o}return o(n,e),r([U.field],n.prototype,\"sourceLeft\",void 0),r([U.field],n.prototype,\"sourceTop\",void 0),r([U.field],n.prototype,\"sourceWidth\",void 0),r([U.field],n.prototype,\"sourceHeight\",void 0),r([U.component],n.prototype,\"source\",void 0),r([U.field],n.prototype,\"paddingTop\",void 0),r([U.field],n.prototype,\"paddingRight\",void 0),r([U.field],n.prototype,\"paddingBottom\",void 0),r([U.field],n.prototype,\"paddingLeft\",void 0),r([U.field],n.prototype,\"sizeInPixels\",void 0),r([be.uuidEvent],n.prototype,\"onClick\",void 0),n=r([F(\"engine.shape\",t.CLASS_ID.UI_IMAGE_SHAPE)],n)}(nn),dn=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.valueX=0,t.valueY=0,t.backgroundColor=Dt.Clear(),t.isHorizontal=!1,t.isVertical=!1,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.paddingLeft=0,t.onChanged=null,t}return o(n,e),r([U.field],n.prototype,\"valueX\",void 0),r([U.field],n.prototype,\"valueY\",void 0),r([U.field],n.prototype,\"backgroundColor\",void 0),r([U.field],n.prototype,\"isHorizontal\",void 0),r([U.field],n.prototype,\"isVertical\",void 0),r([U.field],n.prototype,\"paddingTop\",void 0),r([U.field],n.prototype,\"paddingRight\",void 0),r([U.field],n.prototype,\"paddingBottom\",void 0),r([U.field],n.prototype,\"paddingLeft\",void 0),r([be.uuidEvent],n.prototype,\"onChanged\",void 0),n=r([F(\"engine.shape\",t.CLASS_ID.UI_SLIDER_SHAPE)],n)}(nn),fn=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.useDummyModel=!1,t.talking=!1,t}var i;return o(n,e),i=n,n.Dummy=function(){var t=new i;return t.useDummyModel=!0,t},r([U.field],n.prototype,\"id\",void 0),r([U.field],n.prototype,\"name\",void 0),r([U.field],n.prototype,\"expressionTriggerId\",void 0),r([U.field],n.prototype,\"expressionTriggerTimestamp\",void 0),r([U.field],n.prototype,\"bodyShape\",void 0),r([U.field],n.prototype,\"wearables\",void 0),r([U.field],n.prototype,\"skinColor\",void 0),r([U.field],n.prototype,\"hairColor\",void 0),r([U.field],n.prototype,\"eyeColor\",void 0),r([U.field],n.prototype,\"useDummyModel\",void 0),r([U.field],n.prototype,\"talking\",void 0),n=i=r([M(\"engine.avatarShape\",t.CLASS_ID.AVATAR_SHAPE)],n)}(U),yn=null,vn=null,mn=null;function gn(){return mn||(mn=new Z),mn}var _n=function(){function t(){var t=this;this.messageQueue=[],this.connected=!1,this.flushing=!1,function(){if(!vn){(vn=dcl.loadModule(\"@decentraland/CommunicationsController\",{})).then((function(t){yn=t}));var t=gn();dcl.subscribe(\"comms\"),dcl.onEvent((function(e){\"comms\"===e.type&&t.notifyObservers(e.data)}))}return vn}().then((function(e){t.connected=!0,t.flush()}))}return t.prototype.on=function(t,e){return gn().add((function(n){try{var o=JSON.parse(n.message);o.message===t&&e(o.payload,n.sender)}catch(n){dcl.error(\"Error parsing comms message \"+(n.message||\"\"),n)}}))},t.prototype.sendRaw=function(t){this.messageQueue.push(t),this.connected&&this.flush()},t.prototype.emit=function(t,e){var n=JSON.stringify({message:t,payload:e});this.sendRaw(n),gn().notifyObservers({message:n,sender:\"self\"})},t.prototype.flush=function(){var t=this;if(0!==this.messageQueue.length&&this.connected&&yn&&!this.flushing){var e=this.messageQueue.shift();this.flushing=!0,dcl.callRpc(yn.rpcHandle,\"send\",[e]).then((function(e){t.flushing=!1,t.flush()}),(function(e){t.flushing=!1,d(\"Error flushing MessageBus\",e)}))}},t}(),wn=new k(\"scene\");wn.uuid=\"0\";var xn=new V(wn);F.engine=xn,\"undefined\"!=typeof dcl&&(xn.addSystem(new gt(dcl),1/0),yt(dcl)),xn.addSystem(ke),xn.addSystem(He),xn.addSystem(Be),t.AVATAR_OBSERVABLE=\"AVATAR_OBSERVABLE\",t.Angle=Ot,t.AnimationState=jt,t.Animator=me,t.Arc2=Ft,t.Attachable=e,t.AudioClip=Ve,t.AudioSource=qe,t.AudioStream=We,t.AvatarModifierArea=oe,t.AvatarShape=fn,t.Axis=Lt,t.BasicMaterial=Re,t.BezierCurve=Nt,t.Billboard=re,t.BoxShape=ae,t.Camera=Me,t.CircleShape=pe,t.Color3=Ut,t.Color4=Dt,t.Component=M,t.ComponentAdded=R,t.ComponentGroup=H,t.ComponentRemoved=A,t.ConeShape=ce,t.Curve3=Bt,t.CylinderShape=le,t.DEG2RAD=Rt,t.DisposableComponent=F,t.DisposableComponentCreated=z,t.DisposableComponentRemoved=P,t.DisposableComponentUpdated=O,t.Engine=V,t.Entity=k,t.Epsilon=At,t.EventConstructor=x,t.EventManager=w,t.Font=_e,t.Frustum=kt,t.GLTFShape=de,t.Gizmos=Ye,t.GlobalPointerDown=Qt,t.GlobalPointerUp=$t,t.Input=ee,t.Material=Ae,t.MathTmp=Pt,t.Matrix=Ct,t.MessageBus=_n,t.MultiObserver=X,t.NFTShape=ye,t.OBJShape=ge,t.Observable=Z,t.ObservableComponent=U,t.Observer=Y,t.ObserverEventState=j,t.OnAnimationEnd=Ce,t.OnBlur=Je,t.OnChanged=Qe,t.OnClick=$e,t.OnEnter=Ke,t.OnFocus=Xe,t.OnGizmoEvent=je,t.OnPointerDown=tn,t.OnPointerLock=Se,t.OnPointerUUIDEvent=Ee,t.OnPointerUp=en,t.OnTextSubmit=Ze,t.OnUUIDEvent=be,t.ParentChanged=b,t.Path2=Vt,t.Path3D=qt,t.PhysicsCast=Le,t.Plane=Ht,t.PlaneShape=he,t.PointerEvent=$,t.PointerEventComponent=Kt,t.PointerEventSystem=De,t.Quaternion=It,t.RAD2DEG=bt,t.RaycastEventSystem=Ne,t.RaycastResponse=Q,t.Scalar=Et,t.Shape=se,t.Size=Wt,t.SmartItem=Ie,t.SphereShape=ue,t.Subscription=te,t.TextShape=xe,t.Texture=ve,t.ToGammaSpace=xt,t.ToLinearSpace=Tt,t.Transform=ie,t.UIButton=pn,t.UICanvas=sn,t.UIContainerRect=an,t.UIContainerStack=un,t.UIFullScreen=on,t.UIImage=ln,t.UIInputText=cn,t.UIScrollRect=dn,t.UIShape=nn,t.UIText=hn,t.UIValue=E,t.UIWorldSpace=rn,t.UUIDEvent=K,t.UUIDEventSystem=Ue,t.Vector2=Mt,t.Vector3=zt,t.Vector4=St,t.VideoClip=ze,t.VideoTexture=Oe,t._initEventObservables=yt,t.buildArray=v,t.engine=xn,t.error=d,t.executeTask=W,t.getComponentClassId=N,t.getComponentId=D,t.getComponentName=L,t.getMessageObserver=gn,t.isDisposableComponent=B,t.log=l,t.newId=f,t.onCameraModeChangedObservable=et,t.onEnterScene=it,t.onEnterSceneObservable=ot,t.onIdleStateChangedObservable=nt,t.onLeaveScene=st,t.onLeaveSceneObservable=rt,t.onPlayerConnectedObservable=lt,t.onPlayerDisconnectedObservable=dt,t.onPlayerExpressionObservable=ut,t.onPointerLockedStateChange=pt,t.onProfileChanged=ct,t.onRealmChangedObservable=ft,t.onSceneReadyObservable=at,t.onVideoEvent=ht,t.openExternalURL=function(t){\"undefined\"!=typeof dcl?dcl.openExternalUrl(t):d(\"ERROR: openExternalURL dcl is undefined\")},t.openNFTDialog=function(t,e){if(void 0===e&&(e=null),\"undefined\"!=typeof dcl){var n=t.match(/ethereum:\\/\\/(.+)\\/(.+)/);if(!n||n.length<3)return;dcl.openNFTDialog(n[1],n[2],e)}else d(\"ERROR: openNFTDialog dcl is undefined\")},t.pointerEventSystem=He,t.raycastEventSystem=Be,t.teleportTo=function(t){var e,n;e=\"requestTeleport\",n=[t],void 0===G&&\"undefined\"!=typeof dcl&&(G=dcl.loadModule(\"@decentraland/UserActionModule\",{})),void 0!==G&&\"undefined\"!=typeof dcl&&G.then((function(t){dcl.callRpc(t.rpcHandle,e,n)}))},t.uuid=y,t.uuidEventSystem=ke,Object.defineProperty(t,\"__esModule\",{value:!0})}(this.self=this.self||{});",
    "sha256": "6d5889cd26af8c3b3dfebbc20ead7d5509982de349d85b81328150497a7e423b"
  },
  {
    "path": "node_modules/@dcl/npc-scene-utils/dist/index.js",
    "content": "!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?e(exports):\"function\"==typeof define&&define.amd?define(\"@dcl/npc-scene-utils\",[\"exports\"],e):e((t=\"undefined\"!=typeof globalThis?globalThis:t||self)[\"@dcl/npc-scene-utils\"]={})}(this,(function(t){\"use strict\";\n/*! *****************************************************************************\n    Copyright (c) Microsoft Corporation.\n\n    Permission to use, copy, modify, and/or distribute this software for any\n    purpose with or without fee is hereby granted.\n\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n    PERFORMANCE OF THIS SOFTWARE.\n    ***************************************************************************** */var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,i)};function i(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}function o(t,e,i,o){var n,s=arguments.length,r=s<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(r=(s<3?n(r):s>3?n(e,i,r):n(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r}function n(t){var e=\"function\"==typeof Symbol&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&\"number\"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?\"Object is not iterable.\":\"Symbol.iterator is not defined.\")}var s=function(){function t(t,e,i){this.lockXZRotation=!1,this.active=!1,r||(r=!0,engine.addSystem(new h)),this.lockXZRotation=t||!1,this.rotSpeed=e||2,i&&(this.active=!0)}return t=o([Component(\"trackUserFlag\")],t)}(),r=!1,a=Camera.instance;var h=function(){function t(){this.followingNPCs=engine.getComponentGroup(s)}return t.prototype.update=function(t){var e,i;try{for(var o=n(this.followingNPCs.entities),r=o.next();!r.done;r=o.next()){var h=r.value,u=h.getComponent(Transform),l=h.getComponent(s);if(l.active){var c=new Vector3(a.position.x,a.position.y,a.position.z).subtract(u.position);u.rotation=Quaternion.Slerp(u.rotation,Quaternion.LookRotation(c),t*l.rotSpeed),l.lockXZRotation&&(u.rotation.x=0,u.rotation.z=0)}}}catch(t){e={error:t}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}},t}(),u=new UICanvas;u.visible=!0;var l,c,g=new Font(Fonts.SanFrancisco),p=new Font(Fonts.SanFrancisco_Heavy),d=new Texture(\"https://decentraland.org/images/ui/light-atlas-v3.png\"),f=new Texture(\"https://decentraland.org/images/ui/dark-atlas-v3.png\"),m=new Texture(\"https://decentraland.org/images/ui/dialog-bubbles.png\");function b(t,e,i,o){void 0===i&&(i=512),void 0===o&&(o=512),function(t,e,i,o,n){t.uvs=[e.x,e.y,i.x,i.y,o.x,o.y,n.x,n.y,e.x,e.y,i.x,i.y,o.x,o.y,n.x,n.y]}(t,new Vector2(e.sourceLeft/i,(o-e.sourceTop-e.sourceHeight)/o),new Vector2((e.sourceLeft+e.sourceWidth)/i,(o-e.sourceTop-e.sourceHeight)/o),new Vector2((e.sourceLeft+e.sourceWidth)/i,(o-e.sourceTop)/o),new Vector2(e.sourceLeft/i,(o-e.sourceTop)/o))}function T(t,e){t.sourceWidth=e.sourceWidth,t.sourceHeight=e.sourceHeight,t.sourceLeft=e.sourceLeft?e.sourceLeft:0,t.sourceTop=e.sourceTop?e.sourceTop:0}function C(t){var e=-10-4*t;return e>-65?e:-65}(l=t.ButtonStyles||(t.ButtonStyles={})).E=\"e\",l.F=\"f\",l.DARK=\"dark\",l.RED=\"red\",l.ROUNDBLACK=\"roundblack\",l.ROUNDWHITE=\"roundwhite\",l.ROUNDSILVER=\"roundsilver\",l.ROUNDGOLD=\"roundgold\",l.SQUAREBLACK=\"squareblack\",l.SQUAREWHITE=\"squarewhite\",l.SQUARESILVER=\"squaresilver\",l.SQUAREGOLD=\"squaregold\",l.WHITE=\"white\",(c=t.NPCState||(t.NPCState={})).STANDING=\"standing\",c.TALKING=\"talking\",c.FOLLOWPATH=\"followPath\";var y,x={buttons:{buttonE:{sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:662},buttonF:{sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:612},white:{sourceWidth:174,sourceHeight:46,sourceLeft:698,sourceTop:662},buttonRed:{sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:662},buttonDark:{sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:612},roundBlack:{sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:458},squareBlack:{sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:457},roundWhite:{sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:494},squareWhite:{sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:493},roundSilver:{sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:531},squareSilver:{sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:531},roundGold:{sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:567},squareGold:{sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:567}},buttonLabels:{E:{sourceWidth:26,sourceHeight:26,sourceLeft:697,sourceTop:611},F:{sourceWidth:26,sourceHeight:26,sourceLeft:733,sourceTop:611},EBlack:{sourceWidth:26,sourceHeight:26,sourceLeft:766,sourceTop:611},FBlack:{sourceWidth:26,sourceHeight:26,sourceLeft:802,sourceTop:611}},backgrounds:{promptBackground:{sourceWidth:416,sourceHeight:352,sourceLeft:501,sourceTop:12},promptLargeBackground:{sourceWidth:480,sourceHeight:384,sourceLeft:7,sourceTop:12},promptSlantedBackground:{sourceWidth:486,sourceHeight:326,sourceLeft:7,sourceTop:413},NPCDialog:{sourceWidth:766,sourceHeight:248,sourceLeft:22,sourceTop:756}},icons:{closeW:{sourceWidth:32,sourceHeight:32,sourceLeft:942,sourceTop:306},closeD:{sourceWidth:32,sourceHeight:32,sourceLeft:986,sourceTop:306},closeWLarge:{sourceWidth:64,sourceHeight:64,sourceLeft:512,sourceTop:381},closeDLarge:{sourceWidth:64,sourceHeight:64,sourceLeft:583,sourceTop:381},closeWNoBack:{sourceWidth:24,sourceHeight:24,sourceLeft:946,sourceTop:252},closeDNoBack:{sourceWidth:24,sourceHeight:24,sourceLeft:946,sourceTop:214},closeWNoBackLarge:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:214},closeDNoBackLarge:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:260},FDark:{sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:4},FWhite:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:4},EDark:{sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:40},EWhite:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:40},Timer:{sourceWidth:24,sourceHeight:32.2,sourceLeft:718,sourceTop:388},TimerLarge:{sourceWidth:48,sourceHeight:68,sourceLeft:662,sourceTop:386},ClickWhite:{sourceWidth:32,sourceHeight:48,sourceLeft:799,sourceTop:389},ClickDark:{sourceWidth:32,sourceHeight:48,sourceLeft:757,sourceTop:389}},checkboxes:{wOff:{sourceWidth:24,sourceHeight:24,sourceLeft:987,sourceTop:76},wOn:{sourceWidth:24,sourceHeight:24,sourceLeft:987,sourceTop:104},dOff:{sourceWidth:24,sourceHeight:24,sourceLeft:958,sourceTop:76},dOn:{sourceWidth:24,sourceHeight:24,sourceLeft:958,sourceTop:104},wLargeOff:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:132},wLargeOn:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:168},dLargeOff:{sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:132},dLargeOn:{sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:168}},switches:{roundOff:{sourceWidth:64,sourceHeight:32,sourceLeft:783,sourceTop:454},roundRed:{sourceWidth:64,sourceHeight:32,sourceLeft:853,sourceTop:454},roundGreen:{sourceWidth:64,sourceHeight:32,sourceLeft:923,sourceTop:454},squareOff:{sourceWidth:64,sourceHeight:32,sourceLeft:783,sourceTop:501},squareRed:{sourceWidth:64,sourceHeight:32,sourceLeft:852,sourceTop:501},squareGreen:{sourceWidth:64,sourceHeight:32,sourceLeft:921,sourceTop:501}},bubbles:{short:{sourceWidth:232,sourceHeight:168,sourceLeft:610,sourceTop:834},normal:{sourceWidth:572,sourceHeight:168,sourceLeft:16,sourceTop:834},long:{sourceWidth:994,sourceHeight:306,sourceLeft:12,sourceTop:508},huge:{sourceWidth:994,sourceHeight:478,sourceLeft:12,sourceTop:14}}},v=function(){function t(t,i){var o=this;S.createAndAddToEngine(),this.elapsedTime=0,this.targetTime=t,this.onTimeReachedCallback=i,this.onTargetTimeReached=function(t){o.onTimeReachedCallback(),t.removeComponent(e)}}var e;return e=t,t.prototype.setCallback=function(t){this.onTimeReachedCallback=t},t=e=o([Component(\"npcTimerDelay\")],t)}(),w=engine.getComponentGroup(v),S=function(){function t(){t._instance=this}return t.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new t,engine.addSystem(this._instance)),this._instance},t.prototype.update=function(t){var e,i;try{for(var o=n(w.entities),s=o.next();!s.done;s=o.next()){var r=s.value,a=r.getComponent(v);a.elapsedTime+=t,a.elapsedTime>=a.targetTime&&a.onTargetTimeReached(r)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(e)throw e.error}}},t._instance=null,t}();!function(t){t[t.Confirm=0]=\"Confirm\",t[t.Cancel=1]=\"Cancel\",t[t.Next=2]=\"Next\",t[t.Button3=3]=\"Button3\",t[t.Button4=4]=\"Button4\"}(y||(y={}));var A=.75,E=-262.5,k=262.5,P=37.5,D=192,W=192,O=7.5,B=112.5,I=112.5,_=-48.75,L=-48.75,N=19.5,H=19.5,R=function(){function e(e,i,o,n){var s=this;this.NPCScript=[],this.isDialogOpen=!1,this.isQuestionPanel=!1,this.isFixedScreen=!1,this.activeTextId=0,this.UIOpenTime=0,this.defaultSound=null,this.canvas=u,this.ClickAction=null,this.EButtonAction=null,this.FButtonAction=null,this.defaultPortrait=e||null,this.uiTheme=n||(i?f:d),this.container=new UIContainerRect(u),this.container.adaptWidth=!0,this.container.width=\"100%\",this.container.vAlign=\"bottom\",this.container.positionY=105,this.container.visible=!1,this.panel=new UIImage(this.container,this.uiTheme),T(this.panel,x.backgrounds.NPCDialog),this.panel.width=574.5,this.panel.height=186,this.panel.onClick=new OnClick((function(){s.confirmText(y.Next)})),this.defaultPortraitTexture=new Texture(e?e.path:this.uiTheme.src),this.portrait=new UIImage(this.container,this.defaultPortraitTexture),this.portrait.sourceWidth=e&&e.section?e.section.sourceWidth:256,this.portrait.sourceHeight=e&&e.section?e.section.sourceHeight:256,this.portrait.width=e&&e.width?e.width*A:D,this.portrait.height=e&&e.height?e.height*A:D,this.portrait.positionX=e&&e.offsetX?e.offsetX*A+E:E,this.portrait.positionY=e&&e.offsetY?e.offsetY*A+0:0,this.portrait.onClick=new OnClick((function(){s.confirmText(y.Next)})),this.image=new UIImage(this.container,new Texture(this.uiTheme.src)),this.image.sourceWidth=256,this.image.sourceHeight=256,this.image.sourceTop=0,this.image.sourceLeft=0,this.image.width=W,this.image.height=W,this.image.positionX=k,this.image.positionY=P,this.image.onClick=new OnClick((function(){s.confirmText(y.Next)})),this.text=new UIText(this.container),this.text.adaptWidth=!1,this.text.textWrapping=!0,this.text.width=345,this.text.positionX=30,this.text.hAlign=\"center\",this.text.vAlign=\"center\",this.text.font=p,this.text.fontSize=18,this.text.hTextAlign=\"left\",this.text.vTextAlign=\"center\",this.text.positionY=O,this.text.fontWeight=\"normal\",this.text.color=i?Color4.White():Color4.Black(),this.text.isPointerBlocker=!1,this.soundEnt=new Entity,this.soundEnt.addComponent(new Transform),engine.addEntity(this.soundEnt),this.soundEnt.setParent(Attachable.AVATAR),o&&(this.soundEnt.addComponent(new AudioSource(new AudioClip(o))),this.soundEnt.getComponent(AudioSource).volume=.5,this.defaultSound=o),this.button1=new Y(this.container,this.uiTheme,\"yes\",B,_,(function(){s.confirmText(y.Confirm)}),!1,t.ButtonStyles.E),this.button1.hide(),this.button2=new Y(this.container,this.uiTheme,\"no\",-60,L,(function(){s.confirmText(y.Cancel)}),!1,t.ButtonStyles.F),this.button2.hide(),this.button3=new Y(this.container,this.uiTheme,\"maybe\",-60,-60,(function(){s.confirmText(y.Button3)}),!1,t.ButtonStyles.DARK),this.button3.hide(),this.button4=new Y(this.container,this.uiTheme,\"maybe\",I,-60,(function(){s.confirmText(y.Button4)}),!1,t.ButtonStyles.DARK),this.button4.hide(),this.skipButton=new Y(this.container,this.uiTheme,\"Skip\",-225,-75,(function(){s.skipDialogs()}),!1,f?t.ButtonStyles.WHITE:t.ButtonStyles.F),this.skipButton.image.width=60,this.skipButton.image.height=22.5,this.skipButton.label.hTextAlign=\"left\",this.skipButton.label.fontSize=9,this.skipButton.label.positionX=30,this.skipButton.label.font=p,this.skipButton.icon.height=15,this.skipButton.icon.width=15,this.skipButton.icon.positionX=-15,this.skipButton.hide(),this.leftClickIcon=new UIImage(this.container,this.uiTheme),this.leftClickIcon.width=24,this.leftClickIcon.height=36,this.leftClickIcon.positionX=255,this.leftClickIcon.positionY=-60,this.leftClickIcon.visible=!1,T(this.leftClickIcon,i?x.icons.ClickDark:x.icons.ClickWhite),U.createAndAddToEngine()}return e.prototype.openDialogWindow=function(t,e){var i=this;this.UIOpenTime=+Date.now(),this.NPCScript=t,this.activeTextId=e?\"number\"==typeof e?e:F(t,e):0;var o=t[this.activeTextId]?t[this.activeTextId]:{text:\"\"};if(o.audio?(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(o.audio))),this.soundEnt.getComponent(AudioSource).volume=.5,this.soundEnt.getComponent(AudioSource).playOnce()):this.defaultSound&&(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(this.defaultSound))),this.soundEnt.getComponent(AudioSource).playOnce()),o.portrait?(this.portrait.source=new Texture(o.portrait.path),this.portrait.positionX=o.portrait.offsetX?o.portrait.offsetX*A+E:E,this.portrait.positionY=o.portrait.offsetY?o.portrait.offsetY*A+0:0,this.portrait.width=o.portrait.width?o.portrait.width*A:D,this.portrait.height=o.portrait.height?o.portrait.height*A:D,o.portrait.section&&T(this.portrait,o.portrait.section),this.portrait.visible=!0):this.defaultPortrait?(this.portrait.source=this.defaultPortraitTexture,this.portrait.positionX=this.defaultPortrait&&this.defaultPortrait.offsetX?this.defaultPortrait.offsetX*A+E:E,this.portrait.positionY=this.defaultPortrait&&this.defaultPortrait.offsetY?this.defaultPortrait.offsetY*A+0:0,this.portrait.width=this.defaultPortrait&&this.defaultPortrait.width?this.defaultPortrait.width*A:D,this.portrait.height=this.defaultPortrait&&this.defaultPortrait.height?this.defaultPortrait.height*A:D,this.defaultPortrait.section&&T(this.portrait,this.defaultPortrait.section),this.portrait.visible=!0):(log(\"No portrait\"),this.portrait.visible=!1),o.image){var n=o.image;log(\"setting image to \",n.path),this.image.source=new Texture(n.path),this.image.positionX=n.offsetX?n.offsetX*A+k:k,this.image.positionY=n.offsetY?n.offsetY*A+P:P,this.image.width=n.width?n.width*A:W,this.portrait.height=n.height?n.height*A:W,n.section&&T(this.image,n.section),this.image.visible=!0}else this.image.visible=!1;this.text.fontSize=o.fontSize?o.fontSize*A:18,this.text.positionY=o.offsetY?o.offsetY*A+O:O,this.text.positionX=o.offsetX?o.offsetX*A:0,this.text.visible=!0,this.container.visible=!0,U._instance.newText(this,o.text,this.activeTextId,o.typeSpeed?o.typeSpeed:void 0),this.ClickAction||(this.ClickAction=Input.instance.subscribe(\"BUTTON_DOWN\",ActionButton.POINTER,!1,(function(t){!i.isDialogOpen||+Date.now()-i.UIOpenTime<100||(U._instance.done?i.isQuestionPanel||i.isFixedScreen||i.confirmText(y.Next):U._instance.rush())})),this.EButtonAction=Input.instance.subscribe(\"BUTTON_DOWN\",ActionButton.PRIMARY,!1,(function(t){i.isDialogOpen&&i.isQuestionPanel&&U._instance.done&&+Date.now()-i.UIOpenTime>100&&i.confirmText(y.Confirm)})),this.FButtonAction=Input.instance.subscribe(\"BUTTON_DOWN\",ActionButton.SECONDARY,!1,(function(t){i.isDialogOpen&&i.isQuestionPanel&&U._instance.done&&+Date.now()-i.UIOpenTime>100?i.confirmText(y.Cancel):i.isDialogOpen&&o.skipable&&+Date.now()-i.UIOpenTime>100&&i.skipDialogs()}))),this.layoutDialogWindow(this.activeTextId),this.isDialogOpen=!0},e.prototype.confirmText=function(t){var e=this.NPCScript[this.activeTextId];if(t==y.Next&&!e.isQuestion){if(e.triggeredByNext&&e.triggeredByNext(),e.isEndOfDialog)return void this.closeDialogWindow();this.activeTextId++}t==y.Confirm&&e.buttons&&e.buttons.length>=1&&(\"number\"==typeof e.buttons[0].goToDialog?this.activeTextId=e.buttons[0].goToDialog:this.activeTextId=F(this.NPCScript,e.buttons[0].goToDialog),e.buttons[0].triggeredActions&&e.buttons[0].triggeredActions()),t==y.Cancel&&e.buttons&&e.buttons.length>=2&&(\"number\"==typeof e.buttons[1].goToDialog?this.activeTextId=e.buttons[1].goToDialog:this.activeTextId=F(this.NPCScript,e.buttons[1].goToDialog),e.buttons[1].triggeredActions&&e.buttons[1].triggeredActions()),t==y.Button3&&e.buttons&&e.buttons.length>=3&&(\"number\"==typeof e.buttons[2].goToDialog?this.activeTextId=e.buttons[2].goToDialog:this.activeTextId=F(this.NPCScript,e.buttons[2].goToDialog),e.buttons[2].triggeredActions&&e.buttons[2].triggeredActions()),t==y.Button4&&e.buttons&&e.buttons.length>=4&&(\"number\"==typeof e.buttons[3].goToDialog?this.activeTextId=e.buttons[3].goToDialog:this.activeTextId=F(this.NPCScript,e.buttons[3].goToDialog),e.buttons[3].triggeredActions&&e.buttons[3].triggeredActions()),e=this.NPCScript[this.activeTextId],U._instance.newText(this,e.text,this.activeTextId,e.typeSpeed?e.typeSpeed:void 0)},e.prototype.layoutDialogWindow=function(t){var e=this,i=this.NPCScript[t]?this.NPCScript[t]:{text:\"\"},o=i.offsetY?i.offsetY*A+O:O;if(i.buttons&&i.buttons.length>=3?o+=37.5:i.buttons&&i.buttons.length>=1&&(o+=18),this.text.fontSize=i.fontSize?i.fontSize*A:18,this.text.positionY=o,i.audio?(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(i.audio))),this.soundEnt.getComponent(AudioSource).volume=.5,this.soundEnt.getComponent(AudioSource).playOnce()):this.defaultSound&&(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(this.defaultSound))),this.soundEnt.getComponent(AudioSource).playOnce()),i.portrait?(this.portrait.source=new Texture(i.portrait.path),this.portrait.positionX=i.portrait.offsetX?i.portrait.offsetX*A+E:E,this.portrait.positionY=i.portrait.offsetY?i.portrait.offsetY*A+0:0,this.portrait.width=i.portrait.width?i.portrait.width*A:D,this.portrait.height=i.portrait.height?i.portrait.height*A:D,i.portrait.section&&T(this.portrait,i.portrait.section),this.portrait.visible=!0):this.defaultPortrait?(this.portrait.source=new Texture(this.defaultPortrait.path),this.portrait.positionX=this.defaultPortrait&&this.defaultPortrait.offsetX?this.defaultPortrait.offsetX*A+E:E,this.portrait.positionY=this.defaultPortrait&&this.defaultPortrait.offsetY?this.defaultPortrait.offsetY*A+0:0,this.portrait.width=this.defaultPortrait&&this.defaultPortrait.width?this.defaultPortrait.width*A:D,this.portrait.height=this.defaultPortrait&&this.defaultPortrait.height?this.defaultPortrait.height*A:D,this.defaultPortrait.section&&T(this.portrait,this.defaultPortrait.section),this.portrait.visible=!0):(log(\"No portrait\"),this.portrait.visible=!1),this.image.visible=!1,i.image){var n=i.image;log(\"setting image to \",n.path),this.image.source=new Texture(n.path),this.image.positionX=n.offsetX?n.offsetX*A+k:k,this.image.positionY=n.offsetY?n.offsetY*A+P:P,this.image.width=i.image.width?i.image.width*A:W,this.image.height=i.image.height?i.image.height*A:W,n.section&&T(this.image,n.section),this.image.visible=!0}else this.image.visible=!1;this.isQuestionPanel=!!i.isQuestion&&i.isQuestion,this.isFixedScreen=!!i.isFixedScreen&&i.isFixedScreen,this.button1.hide(),this.button2.hide(),this.button3.hide(),this.button4.hide(),this.leftClickIcon.visible=!1,i.isQuestion?(this.skipButton.hide(),i.buttons&&i.buttons.length>=1&&this.button1.update(i.buttons[0].label,i.buttons[0].offsetX?i.buttons[0].offsetX*A+B:B,i.buttons.length>=3?i.buttons[0].offsetY?i.buttons[0].offsetY*A-15:-15:i.buttons[0].offsetY?i.buttons[0].offsetY*A+_:_),i.buttons&&i.buttons.length>=2&&this.button2.update(i.buttons[1].label,i.buttons[1].offsetX*A?i.buttons[1].offsetX*A-60:-60,i.buttons.length>=3?i.buttons[1].offsetY*A?i.buttons[1].offsetY*A-15:-15:i.buttons[1].offsetY*A?i.buttons[1].offsetY*A+L:L),i.buttons&&i.buttons.length>=3&&this.button3.update(i.buttons[2].label,i.buttons[2].offsetX*A?i.buttons[2].offsetX*A-60:-60,i.buttons[2].offsetY*A?i.buttons[2].offsetY*A-60:-60),i.buttons&&i.buttons.length>=4&&this.button4.update(i.buttons[3].label,i.buttons[3].offsetX*A?i.buttons[3].offsetX*A+I:I,i.buttons[3].offsetY*A?i.buttons[3].offsetY*A-60:-60),X.addComponentOrReplace(new v(.7,(function(){i.buttons&&i.buttons.length>=1&&e.button1.show(),i.buttons&&i.buttons.length>=2&&e.button2.show(),i.buttons&&i.buttons.length>=3&&e.button3.show(),i.buttons&&i.buttons.length>=4&&e.button4.show()})))):this.isFixedScreen||(this.leftClickIcon.visible=!0,i.skipable?this.skipButton.show():this.skipButton.hide())},e.prototype.closeDialogWindow=function(){this.isDialogOpen&&(this.isDialogOpen=!1,this.portrait.visible=!1,this.text.value=\"\",this.text.visible=!1,this.button1.hide(),this.button2.hide(),this.button3.hide(),this.button4.hide(),this.skipButton.hide(),this.leftClickIcon.visible=!1,this.container.visible=!1)},e.prototype.skipDialogs=function(){if(this.isDialogOpen&&!(+Date.now()-this.UIOpenTime<100)){for(;this.NPCScript[this.activeTextId]&&this.NPCScript[this.activeTextId].skipable&&!this.NPCScript[this.activeTextId].isQuestion;){if(this.NPCScript[this.activeTextId].triggeredByNext&&this.NPCScript[this.activeTextId].triggeredByNext(),this.NPCScript[this.activeTextId].skipable&&this.NPCScript[this.activeTextId].isEndOfDialog)return void this.closeDialogWindow();this.activeTextId+=1}this.confirmText(y.Next)}},e}(),U=function(){function t(){this.timer=0,this.speed=45,this.visibleChars=0,this.fullText=\"\",this.UIText=null,this.done=!0,t._instance=this}return t.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new t,engine.addSystem(this._instance)),this._instance},t.prototype.update=function(t){if(!this.done&&(this.timer+=t,this.timer>=2/this.speed)){var e=Math.floor(this.timer/(1/this.speed));this.timer=0,this.visibleChars+=e,this.closeTag(e),this.visibleChars>=this.fullText.length&&(this.done=!0,this.visibleChars=this.fullText.length),this.UIText&&(this.UIText.value=this.fullText.substr(0,this.visibleChars))}},t.prototype.newText=function(t,e,i,o){this.timer=0,this.done=!1,this.UIText=t.text,this.fullText=e,this.visibleChars=0,o&&o<=0?this.rush():this.speed=o||45,t.layoutDialogWindow(i)},t.prototype.rush=function(){this.done=!0,this.timer=0,this.visibleChars=this.fullText.length,this.UIText&&(this.UIText.value=this.fullText)},t.prototype.closeTag=function(t){if(0!=this.visibleChars&&0!=t){for(var e=!1,i=!1,o=this.visibleChars-t;o<this.visibleChars;o++)e?\">\"==this.fullText.substr(o,1)&&(i=!0):\"<\"==this.fullText.substr(o,1)&&(e=!0);if(e&&!i)for(;this.visibleChars<this.fullText.length&&\">\"!=this.fullText.substr(this.visibleChars-1,1);)this.visibleChars+=1}},t._instance=null,t}(),Y=function(e){function o(i,o,n,s,r,a,h,u){var l=e.call(this)||this;if(l.icon=null,l.image=new UIImage(i,o),l.image.positionX=s,l.image.positionY=r,l.image.width=130.5,l.image.height=34.5,l.label=new UIText(l.image),l.style=u||null,l.onClick=a,l.style)switch(l.style){case t.ButtonStyles.E:T(l.image,x.buttons.buttonE),l.label.positionX=18.75,l.icon=new UIImage(l.image,1==h?f:d),l.icon.width=N,l.icon.height=H,l.icon.hAlign=\"center\",l.icon.vAlign=\"center\",l.icon.isPointerBlocker=!1,T(l.icon,x.buttonLabels.E),l.icon.positionX=C(n.length);break;case t.ButtonStyles.F:T(l.image,x.buttons.buttonF),l.label.positionX=18.75,l.icon=new UIImage(l.image,1==h?f:d),l.icon.width=N,l.icon.height=H,l.icon.hAlign=\"center\",l.icon.vAlign=\"center\",l.icon.isPointerBlocker=!1,T(l.icon,x.buttonLabels.F),l.icon.positionX=C(n.length);break;case t.ButtonStyles.WHITE:T(l.image,x.buttons.white),l.label.positionX=18.75,l.icon=new UIImage(l.image,1==h?f:d),l.icon.width=N,l.icon.height=H,l.icon.hAlign=\"center\",l.icon.vAlign=\"center\",l.icon.isPointerBlocker=!1,T(l.icon,x.buttonLabels.FBlack),l.icon.positionX=C(n.length);break;case t.ButtonStyles.RED:T(l.image,x.buttons.buttonRed);break;case t.ButtonStyles.DARK:T(l.image,x.buttons.buttonDark);break;case t.ButtonStyles.ROUNDBLACK:T(l.image,x.buttons.roundBlack);break;case t.ButtonStyles.ROUNDWHITE:T(l.image,x.buttons.roundWhite);break;case t.ButtonStyles.ROUNDSILVER:T(l.image,x.buttons.roundSilver);break;case t.ButtonStyles.ROUNDGOLD:T(l.image,x.buttons.roundGold);break;case t.ButtonStyles.SQUAREBLACK:T(l.image,x.buttons.squareBlack);break;case t.ButtonStyles.SQUAREWHITE:T(l.image,x.buttons.squareWhite);break;case t.ButtonStyles.SQUARESILVER:T(l.image,x.buttons.squareSilver);break;case t.ButtonStyles.SQUAREGOLD:T(l.image,x.buttons.squareGold)}else T(l.image,x.buttons.roundSilver);return l.label.value=n,l.label.hTextAlign=\"center\",l.label.vTextAlign=\"center\",l.label.fontSize=15,l.label.font=g,l.label.color=u==t.ButtonStyles.ROUNDWHITE||u==t.ButtonStyles.SQUAREWHITE||u==t.ButtonStyles.WHITE?Color4.Black():Color4.White(),l.label.isPointerBlocker=!1,l.image.onClick=new OnClick((function(){l.onClick()})),u==t.ButtonStyles.E?Input.instance.subscribe(\"BUTTON_DOWN\",ActionButton.PRIMARY,!1,(function(t){l.image.visible&&l.onClick()})):u==t.ButtonStyles.F&&Input.instance.subscribe(\"BUTTON_DOWN\",ActionButton.SECONDARY,!1,(function(t){l.image.visible&&l.onClick()})),l}return i(o,e),o.prototype.hide=function(){this.image.visible=!1},o.prototype.show=function(){this.image.visible=!0},o.prototype.grayOut=function(){this.label.color=Color4.Gray(),this.image.isPointerBlocker=!1},o.prototype.enable=function(){this.label.color=Color4.White(),this.image.isPointerBlocker=!0},o.prototype.update=function(e,i,o){this.label.value=e,this.image.positionX=i,this.image.positionY=o,!this.icon||this.style!=t.ButtonStyles.E&&this.style!=t.ButtonStyles.F||(this.icon.positionX=C(e.length))},o}(Entity),X=new Entity;function F(t,e){for(var i=0;i<t.length;i++)if(t[i].name&&t[i].name==e)return i;return 0}engine.addEntity(X);var z=function(){function t(){this._triggers={},t._instance=this,this._cameraTriggerWrapper=new V(new j(new Vector3(.5,1.8,.5),new Vector3(0,.91,0))),this._componentGroup=engine.getComponentGroup(Q)}return Object.defineProperty(t,\"instance\",{get:function(){return this.createAndAddToEngine()},enumerable:!1,configurable:!0}),t.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new t,engine.addSystem(this._instance)),this._instance},t.prototype.setCameraTriggerShape=function(t){this._cameraTriggerWrapper.setShape(t)},t.prototype.update=function(){var e=this,i=this._componentGroup.entities;for(var o in i.forEach((function(t){e.shouldWrapTriggerEntity(t)&&e.wrapTriggerEntity(t)})),this._triggers)if(this._triggers.hasOwnProperty(o)){var n=this._triggers[o];n.isDebugging()&&n.updateDebugEntity(),n.isInEngine()?null!=n.trigger&&n.trigger.enabled?(n.wasEnabled||n.isDebugging()&&n.addDebugEntity(),n.wasEnabled=!0,(n.trigger.onCameraEnter||n.trigger.onCameraExit)&&this.checkCollisionAgainstCamera(n),(n.trigger.onTriggerEnter||n.trigger.onTriggerExit)&&this.checkCollisionAgainstOtherTriggers(n)):n.wasEnabled&&(n.wasEnabled=!1,n.isDebugging()&&n.removeDebugEntity(),t.removeTriggerFromSystem(n)):(n.isDebugging()&&n.removeDebugEntity(),t.removeTriggerFromSystem(n),delete this._triggers[o])}},t.prototype.shouldWrapTriggerEntity=function(t){return null==this._triggers[t.uuid]||null==this._triggers[t.uuid]},t.prototype.wrapTriggerEntity=function(t){this._triggers[t.uuid]=new G(t)},t.removeTriggerFromSystem=function(e){for(var i,o=e.getActiveCollisions(),n=0;n<o.length;n++){!(o[n]===(null===(i=t._instance)||void 0===i?void 0:i._cameraTriggerWrapper)||null==o[n].trigger)&&o[n].trigger.onTriggerExit&&e.entity&&o[n].trigger.onTriggerExit(e.entity),o[n].disengageActiveCollision(e),e.disengageActiveCollision(o[n])}},t.disengageCollision=function(t,e){t.disengageActiveCollision(e),e.disengageActiveCollision(t),t.trigger.onTriggerExit&&e.entity&&t.trigger.onTriggerExit(e.entity),e.trigger.onTriggerExit&&t.entity&&e.trigger.onTriggerExit(t.entity)},t.engageCollision=function(t,e){t.engageCollision(e),e.engageCollision(t),t.trigger.onTriggerEnter&&e.entity&&t.trigger.onTriggerEnter(e.entity),e.trigger.onTriggerEnter&&t.entity&&e.trigger.onTriggerEnter(t.entity)},t.prototype.checkCollisionAgainstCamera=function(e){var i=e.hasActiveCollision(this._cameraTriggerWrapper),o=t.areColliding(e,this._cameraTriggerWrapper);i&&!o?(e.disengageActiveCollision(this._cameraTriggerWrapper),e.trigger.onCameraExit&&e.trigger.onCameraExit()):!i&&o&&(e.engageCollision(this._cameraTriggerWrapper),e.trigger.onCameraEnter&&e.trigger.onCameraEnter())},t.prototype.checkCollisionAgainstOtherTriggers=function(e){for(var i in this._triggers)if(this._triggers.hasOwnProperty(i)&&i!=e.uuid&&this._triggers[i].trigger.enabled&&t.canTriggersCollide(e,this._triggers[i])){var o=e.hasActiveCollision(this._triggers[i]),n=t.areColliding(e,this._triggers[i]);o&&!n?t.disengageCollision(e,this._triggers[i]):!o&&n&&t.engageCollision(e,this._triggers[i])}},t.canTriggersCollide=function(t,e){return 0==t.trigger.triggeredByLayer||0!=(e.trigger.layer&t.trigger.triggeredByLayer)},t.areColliding=function(e,i){return e.getShape()instanceof j&&i.getShape()instanceof j?t.areCollidingAABB(e.getGlobalPosition(),e.getShape(),i.getGlobalPosition(),i.getShape()):e.getShape()instanceof q&&i.getShape()instanceof q?t.areCollidingSphere(e.getGlobalPosition(),e.getShape(),i.getGlobalPosition(),i.getShape()):e.getShape()instanceof j&&i.getShape()instanceof q?t.areCollidingAABBSphere(e.getGlobalPosition(),e.getShape(),i.getGlobalPosition(),i.getShape()):e.getShape()instanceof q&&i.getShape()instanceof j&&t.areCollidingAABBSphere(i.getGlobalPosition(),i.getShape(),e.getGlobalPosition(),e.getShape())},t.areCollidingAABB=function(e,i,o,n){var s=t.getBoxShapeValues(e,i),r=t.getBoxShapeValues(o,n);return s.min.x<=r.max.x&&s.max.x>=r.min.x&&s.min.y<=r.max.y&&s.max.y>=r.min.y&&s.min.z<=r.max.z&&s.max.z>=r.min.z},t.areCollidingSphere=function(t,e,i,o){return Vector3.DistanceSquared(t.add(e.position),i.add(o.position))<e.radius*e.radius+o.radius*o.radius},t.areCollidingAABBSphere=function(e,i,o,n){var s=t.getBoxShapeValues(e,i),r=o.add(n.position),a=n.radius,h=0;return r.x<s.min.x&&(h+=(s.min.x-r.x)*(s.min.x-r.x)),r.x>s.max.x&&(h+=(r.x-s.max.x)*(r.x-s.max.x)),r.y<s.min.y&&(h+=(s.min.y-r.y)*(s.min.y-r.y)),r.y>s.max.y&&(h+=(r.y-s.max.y)*(r.y-s.max.y)),r.z<s.min.z&&(h+=(s.min.z-r.z)*(s.min.z-r.z)),r.z>s.max.z&&(h+=(r.z-s.max.z)*(r.z-s.max.z)),h<a*a},t.getBoxShapeValues=function(t,e){var i=t.add(e.position);return{center:i,min:i.subtract(e.size.scale(.5)),max:i.add(e.size.scale(.5))}},t._instance=null,t}(),G=function(){function t(t){this.wasEnabled=!0,this._uuid=\"\",this._collidingWith={},this._isDebug=!1,this._debugEntity=null,this._entity=t,t&&(this._trigger=t.getComponent(Q),this._uuid=t.uuid,this._isDebug=this._trigger.debugEnabled,this._isDebug&&this.addDebugEntity())}return Object.defineProperty(t.prototype,\"entity\",{get:function(){return this._entity},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"trigger\",{get:function(){return this._trigger},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,\"uuid\",{get:function(){return this._uuid},enumerable:!1,configurable:!0}),t.prototype.getGlobalPosition=function(){return this._entity?t.getEntityWorldPosition(this._entity):Vector3.Zero()},t.prototype.getShape=function(){return this._trigger.shape},t.prototype.isInEngine=function(){return null!=this._entity&&this._entity.isAddedToEngine()},t.prototype.getActiveCollisions=function(){var t=[];for(var e in this._collidingWith)this._collidingWith.hasOwnProperty(e)&&t.push(this._collidingWith[e]);return t},t.prototype.hasActiveCollision=function(t){return null!=this._collidingWith[t.uuid]&&null!=this._collidingWith[t.uuid]},t.prototype.disengageActiveCollision=function(t){delete this._collidingWith[t.uuid]},t.prototype.engageCollision=function(t){this._collidingWith[t.uuid]=t},t.prototype.isDebugging=function(){return this._isDebug},t.prototype.addDebugEntity=function(){if(t._debugMaterial||(t._debugMaterial=new Material,t._debugMaterial.alphaTest=.5),null==this._debugEntity){this._debugEntity=new Entity;var e=new Transform;if(this._debugEntity.addComponent(e),this._debugEntity.addComponent(t._debugMaterial),this.getShape()instanceof j)(i=new BoxShape).withCollisions=!1,this._debugEntity.addComponent(i),e.scale=this.getShape().size;if(this.getShape()instanceof q){var i;(i=new SphereShape).withCollisions=!1,this._debugEntity.addComponent(i);var o=this.getShape().radius;e.scale=new Vector3(o,o,o)}}engine.addEntity(this._debugEntity)},t.prototype.removeDebugEntity=function(){null!=this._debugEntity&&engine.removeEntity(this._debugEntity)},t.prototype.updateDebugEntity=function(){this._debugEntity&&(this._debugEntity.getComponent(Transform).position=this.getGlobalPosition().add(this.getShape().position))},t.getEntityWorldPosition=function(t){var e=t.hasComponent(Transform)?t.getComponent(Transform).position.clone():Vector3.Zero(),i=t.getParent();if(null!=i){var o=i.hasComponent(Transform)?i.getComponent(Transform).rotation:Quaternion.Identity;return this.getEntityWorldPosition(i).add(e.rotate(o))}return e},t._debugMaterial=null,t}(),V=function(t){function e(e){var i=t.call(this)||this;return i._shape=e,i._uuid=\"cameraTrigger\",i}return i(e,t),e.prototype.getGlobalPosition=function(){return Camera.instance.position},e.prototype.getShape=function(){return this._shape},e.prototype.setShape=function(t){this._shape=t},e.prototype.isInEngine=function(){return!1},e.prototype.hasActiveCollision=function(t){return!1},e.prototype.disengageActiveCollision=function(t){},e.prototype.engageCollision=function(t){},e.prototype.isDebugging=function(){return!1},e}(G),Q=function(){function t(t,e){this.enabled=!0,this.layer=0,this.triggeredByLayer=0,z.createAndAddToEngine(),this.shape=t,this.layer=e&&e.layer?e.layer:0,this.triggeredByLayer=e&&e.triggeredByLayer?e.triggeredByLayer:0,this.onTriggerEnter=e&&e.onTriggerEnter?e.onTriggerEnter:void 0,this.onTriggerExit=e&&e.onTriggerExit?e.onTriggerExit:void 0,this.onCameraEnter=e&&e.onCameraEnter?e.onCameraEnter:void 0,this.onCameraExit=e&&e.onCameraExit?e.onCameraExit:void 0,this._debugEnabled=!(!e||!e.enableDebug)&&e.enableDebug}return Object.defineProperty(t.prototype,\"debugEnabled\",{get:function(){return this._debugEnabled},enumerable:!1,configurable:!0}),t=o([Component(\"npcTriggerComponent\")],t)}(),j=function(t,e){this.size=t,this.position=e},q=function(t,e){this.radius=t,this.position=e},M=function(){function t(t){this.origin=0,this.target=1,this.fraction=0,this.totalDuration=0,this.speed=[],this.loop=!1,this.path=t,Z.createAndAddToEngine()}return t.prototype.setIndex=function(t){this.fraction=0,this.origin=t,this.target=t+1<this.path.length?t+1:0},t=o([Component(\"npclerpData\")],t)}(),K=[],Z=function(){function e(){e._instance=this}return e.prototype.update=function(e){var i,o;try{for(var s=n(K),r=s.next();!r.done;r=s.next()){var a=r.value;if(a.state==t.NPCState.FOLLOWPATH){var h=a.getComponent(Transform),u=a.getComponent(M);if(u.fraction<1)u.fraction+=e*u.speed[u.origin],h.position=Vector3.Lerp(u.path[u.origin],u.path[u.target],u.fraction);else{if(u.origin=u.target,u.target+=1,u.target>=u.path.length){if(!u.loop)return a.stopWalking(),u.onFinishCallback&&u.onFinishCallback(),void(u.fraction=1);u.target=0}else u.onReachedPointCallback&&u.onReachedPointCallback();u.fraction=0,h.lookAt(u.path[u.target])}}}}catch(t){i={error:t}}finally{try{r&&!r.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}},e.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new e,engine.addSystem(this._instance)),this._instance},e._instance=null,e}(),J=100,$=function(){function t(t,e,i){this.NPCScript=[],this.isBubleOpen=!1,this.activeTextId=0,this.defaultSound=null,this.baseYOffset=2.5,this.baseYOffset=e||2.5,this.rootEntity=new Entity,this.rootEntity.addComponent(new Billboard(!1,!0,!1)),this.rootEntity.addComponent(new Transform),this.rootEntity.setParent(t),this.container=new Entity,this.container.addComponent(new Transform({position:new Vector3(-.1,this.baseYOffset,0)})),this.container.setParent(this.rootEntity),this.material=new BasicMaterial,this.material.texture=m,this.panel=new Entity,this.panel.addComponent(new Transform({scale:new Vector3(2,1,1)})),this.panel.setParent(this.container),this.panel.addComponent(new PlaneShape),this.panel.addComponent(this.material),this.panel.getComponent(PlaneShape).visible=!1,b(this.panel.getComponent(PlaneShape),x.bubbles.normal,1024,1024),this.text=new Entity,this.text.addComponent(new Transform({position:new Vector3(0,0,.05),rotation:Quaternion.Euler(0,180,0)})),this.text.addComponent(new TextShape(\"\")),this.text.setParent(this.container),this.text.getComponent(TextShape).textWrapping=!0,this.text.getComponent(TextShape).font=p,this.text.getComponent(TextShape).hTextAlign=\"center\",this.text.getComponent(TextShape).vTextAlign=\"center\",this.text.getComponent(TextShape).fontSize=1,this.text.getComponent(TextShape).fontWeight=\"normal\",this.text.getComponent(TextShape).color=Color3.Black(),this.text.getComponent(TextShape).visible=!1,this.soundEnt=new Entity,i&&(this.soundEnt.addComponent(new Transform),engine.addEntity(this.soundEnt),this.soundEnt.setParent(this.container),this.soundEnt.addComponent(new AudioSource(new AudioClip(i))),this.soundEnt.getComponent(AudioSource).volume=.5,this.defaultSound=i),tt.createAndAddToEngine()}return t.prototype.openDialogWindow=function(t,e){this.NPCScript=t,this.activeTextId=e?\"number\"==typeof e?e:function(t,e){for(var i=0;i<t.length;i++)if(t[i].name&&t[i].name==e)return i;return 0}(t,e):0;var i=t[this.activeTextId]?t[this.activeTextId]:{text:\"\"};i.audio?(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(i.audio))),this.soundEnt.getComponent(AudioSource).volume=.5,this.soundEnt.getComponent(AudioSource).playOnce()):this.defaultSound&&(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(this.defaultSound))),this.soundEnt.getComponent(AudioSource).playOnce()),this.text.getComponent(TextShape).fontSize=i.fontSize?i.fontSize:1,this.text.getComponent(Transform).position.y=i.offsetY?i.offsetY+0:0,this.text.getComponent(Transform).position.x=i.offsetX?i.offsetX:0,this.text.getComponent(TextShape).visible=!0,this.panel.getComponent(PlaneShape).visible=!0,this.text.getComponent(TextShape).value=\"\",i.text.length<J&&i.text.slice(0,J),tt._instance.newText(this,i.text,this.activeTextId,i.timeOn?i.timeOn:void 0,i.typeSpeed?i.typeSpeed:void 0),this.adjustBubble(i.text.length),this.layoutDialogWindow(this.activeTextId),this.isBubleOpen=!0},t.prototype.adjustBubble=function(t){t<8?(b(this.panel.getComponent(PlaneShape),x.bubbles.short,1024,1024),this.panel.getComponent(Transform).scale.x=.58,this.panel.getComponent(Transform).scale.y=.42,this.container.getComponent(Transform).position.x=-.1,this.container.getComponent(Transform).position.y=this.baseYOffset+-.2,this.text.getComponent(TextShape).width=.7):t<25?(b(this.panel.getComponent(PlaneShape),x.bubbles.normal,1024,1024),this.panel.getComponent(Transform).scale.x=1.43,this.panel.getComponent(Transform).scale.y=.42,this.container.getComponent(Transform).position.x=-.5,this.container.getComponent(Transform).position.y=this.baseYOffset+-.2,this.text.getComponent(TextShape).width=1.5):t<50?(b(this.panel.getComponent(PlaneShape),x.bubbles.long,1024,1024),this.panel.getComponent(Transform).scale.x=2.485,this.panel.getComponent(Transform).scale.y=.765,this.container.getComponent(Transform).position.y=this.baseYOffset+0,this.container.getComponent(Transform).position.x=-.8,this.text.getComponent(TextShape).width=2):(b(this.panel.getComponent(PlaneShape),x.bubbles.huge,1024,1024),this.panel.getComponent(Transform).scale.x=2.485,this.panel.getComponent(Transform).scale.y=1.195,this.container.getComponent(Transform).position.y=this.baseYOffset+.2,this.container.getComponent(Transform).position.x=-.8,this.text.getComponent(TextShape).width=2)},t.prototype.next=function(){var t=this.NPCScript[this.activeTextId];t||(t=this.NPCScript[this.activeTextId-1]),t.triggeredByNext&&t.triggeredByNext(),t.isEndOfDialog?this.closeDialogWindow():(this.activeTextId++,(t=this.NPCScript[this.activeTextId]).text.length<J&&t.text.slice(0,J),this.text.getComponent(TextShape).value=\"\",this.adjustBubble(t.text.length),tt._instance.newText(this,t.text,this.activeTextId,t.timeOn?t.timeOn:void 0,t.typeSpeed?t.typeSpeed:void 0),this.layoutDialogWindow(this.activeTextId))},t.prototype.layoutDialogWindow=function(t){var e=this.NPCScript[t]?this.NPCScript[t]:{text:\"\"},i=e.offsetY?e.offsetY+0:0;e.buttons&&e.buttons.length>=3?i+=50:e.buttons&&e.buttons.length>=1&&(i+=24),this.text.getComponent(TextShape).fontSize=e.fontSize?e.fontSize:1,this.text.getComponent(Transform).position.y=i,e.audio?(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(e.audio))),this.soundEnt.getComponent(AudioSource).volume=.5,this.soundEnt.getComponent(AudioSource).playOnce()):this.defaultSound&&(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(this.defaultSound))),this.soundEnt.getComponent(AudioSource).playOnce())},t.prototype.closeDialogWindow=function(){this.isBubleOpen&&(this.isBubleOpen=!1,this.text.getComponent(TextShape).value=\"\",this.text.getComponent(TextShape).visible=!1,this.panel.getComponent(PlaneShape).visible=!1)},t.prototype.closeDialogEndAll=function(){this.isBubleOpen&&(this.isBubleOpen=!1,this.text.getComponent(TextShape).value=\"\",this.text.getComponent(TextShape).visible=!1,this.panel.getComponent(PlaneShape).visible=!1,tt._instance.Dialog==this&&(tt._instance.done=!0))},t.prototype.skipDialogs=function(){if(this.isBubleOpen)for(;this.NPCScript[this.activeTextId];){if(this.NPCScript[this.activeTextId].triggeredByNext&&this.NPCScript[this.activeTextId].triggeredByNext(),this.NPCScript[this.activeTextId].isEndOfDialog)return void this.closeDialogWindow();this.activeTextId+=1}},t}(),tt=function(){function t(){this.timer=0,this.speed=45,this.visibleChars=0,this.fullText=\"\",this.Text=null,this.textId=0,this.done=!0,this.showing=!1,this.timeOn=3,t._instance=this}return t.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new t,engine.addSystem(this._instance)),this._instance},t.prototype.update=function(t){if(!this.done)if(this.timer+=t,this.showing)this.timer>this.timeOn&&(this.showing=!1,this.done=!0,this.timer=0,this.window.next());else if(this.timer>=2/this.speed){var e=Math.floor(this.timer/(1/this.speed));this.timer=0,this.visibleChars+=e,this.closeTag(e),this.visibleChars>=this.fullText.length&&(this.showing=!0,this.timer=0,this.visibleChars=this.fullText.length),this.Text&&(this.Text.value=this.fullText.substr(0,this.visibleChars))}},t.prototype.newText=function(t,e,i,o,n){if(t!=this.Dialog||i!=this.textId){var s=this.Dialog;this.Dialog=t,this.Text=this.Dialog.text.getComponent(TextShape),this.textId=i,s&&t!=s&&s.skipDialogs(),this.timer=0,this.done=!1,this.showing=!1,this.fullText=e,this.visibleChars=0,this.window=t,n&&n<=0?this.rush():this.speed=n||45,this.timeOn=o||3}},t.prototype.rush=function(){this.showing=!0,this.timer=0,this.visibleChars=this.fullText.length,this.Text&&(this.Text.value=this.fullText)},t.prototype.closeTag=function(t){if(0!=this.visibleChars&&0!=t){for(var e=!1,i=!1,o=this.visibleChars-t;o<this.visibleChars;o++)e?\">\"==this.fullText.substr(o,1)&&(i=!0):\"<\"==this.fullText.substr(o,1)&&(e=!0);if(e&&!i)for(;this.visibleChars<this.fullText.length&&\">\"!=this.fullText.substr(this.visibleChars-1,1);)this.visibleChars+=1}},t._instance=null,t}();var et=function(e){function o(i,o,n,r){var a=e.call(this)||this;a.introduced=!1,a.onWalkAway=null,a.inCooldown=!1,a.coolDownDuration=5,a.faceUser=!1,a.walkingAnim=null,a.walkingSpeed=2,a.bubbleHeight=2,a.addComponent(new GLTFShape(o)),a.addComponent(new Transform(i)),engine.addEntity(a),a.state=t.NPCState.STANDING,r&&r.noUI||(r&&r.portrait?a.dialog=new R(\"string\"==typeof r.portrait?{path:r.portrait}:r.portrait,!(!r||!r.darkUI)&&r.darkUI,r.dialogSound?r.dialogSound:void 0):a.dialog=new R(void 0,!(!r||!r.darkUI)&&r.darkUI,r&&r.dialogSound?r.dialogSound:void 0)),r&&r.textBubble&&(r&&r.bubbleHeight&&(a.bubbleHeight=r.bubbleHeight),a.bubble=new $(a,a.bubbleHeight,r.dialogSound?r.dialogSound:void 0)),a.addComponent(new Animator),a.idleAnim=new AnimationState(r&&r.idleAnim?r.idleAnim:\"Idle\",{looping:!0}),a.getComponent(Animator).addClip(a.idleAnim),a.lastPlayedAnim=a.idleAnim,a.idleAnim.play(),r&&r.walkingAnim&&(a.walkingAnim=new AnimationState(r.walkingAnim,{looping:!0}),a.getComponent(Animator).addClip(a.walkingAnim)),a.onActivate=n,r&&r.onWalkAway&&(a.onWalkAway=r.onWalkAway),a.endAnimTimer=new Entity,engine.addEntity(a.endAnimTimer),a.closeDialogTimer=new Entity,engine.addEntity(a.closeDialogTimer),a.pauseWalkingTimer=new Entity,engine.addEntity(a.pauseWalkingTimer);var h=r&&r.onlyClickTrigger?ActionButton.POINTER:ActionButton.PRIMARY;a.addComponent(new OnPointerDown((function(t){a.inCooldown||a.dialog&&a.dialog.isDialogOpen||a.activate()}),{button:h,hoverText:r&&r.hoverText?r.hoverText:\"Talk\",showFeedback:!r||!r.onlyExternalTrigger})),r&&r.onlyExternalTrigger&&a.removeComponent(OnPointerDown);var u={};return(!r||r&&!r.continueOnWalkAway)&&(u.onCameraExit=function(){a.handleWalkAway()}),r&&(!r||r.onlyExternalTrigger||r.onlyClickTrigger||r.onlyETrigger)||(u.onCameraEnter=function(){a.inCooldown?log(a.name,\" in cooldown\"):a.dialog&&a.dialog.isDialogOpen||r&&r.onlyExternalTrigger||r&&r.onlyClickTrigger||a.activate()}),(u.onCameraEnter||u.onCameraExit)&&a.addComponent(new Q(new q(r&&r.reactDistance?r.reactDistance:6,Vector3.Zero()),u)),r&&r.faceUser&&(a.addComponent(new s(!0,r.turningSpeed?r.turningSpeed:void 0)),a.faceUser=!0),r&&r.walkingSpeed&&(a.walkingSpeed=r.walkingSpeed),r&&r.coolDownDuration&&(a.coolDownDuration=r.coolDownDuration),r&&r.path&&(a.addComponent(new M(r.path?r.path:[])),a.getComponent(M).loop=!0,K.push(a),a.followPath()),a}return i(o,e),o.prototype.activate=function(){var t=this;this.faceUser&&(this.getComponent(s).active=!0),this.inCooldown=!0,this.addComponentOrReplace(new v(this.coolDownDuration,(function(){t.inCooldown=!1}))),this.onActivate()},o.prototype.endInteraction=function(){this.faceUser&&(this.getComponent(s).active=!1),this.dialog&&this.dialog.isDialogOpen&&this.dialog.closeDialogWindow(),this.bubble&&this.bubble.isBubleOpen&&this.bubble.closeDialogWindow(),this.state=t.NPCState.STANDING},o.prototype.handleWalkAway=function(){this.state!=t.NPCState.FOLLOWPATH&&(this.endInteraction(),this.onWalkAway&&this.onWalkAway())},o.prototype.talk=function(e,i,o){var n=this;this.introduced=!0,this.state=t.NPCState.TALKING,this.closeDialogTimer.hasComponent(v)&&this.closeDialogTimer.removeComponent(v),this.bubble&&this.bubble.isBubleOpen&&this.bubble.closeDialogWindow(),this.dialog.openDialogWindow(e,i||0),o&&this.closeDialogTimer.addComponentOrReplace(new v(o,(function(){n.dialog.closeDialogWindow()})))},o.prototype.talkBubble=function(t,e){this.bubble||(this.bubble=new $(this,this.bubbleHeight)),this.bubble.openDialogWindow(t,e||0)},o.prototype.playAnimation=function(t,e,i){var o=this;this.lastPlayedAnim.stop(),this.endAnimTimer.hasComponent(v)&&this.endAnimTimer.removeComponent(v);var n=this.getComponent(Animator).getClip(t);e&&(n.looping=!1,i&&this.endAnimTimer.addComponentOrReplace(new v(i,(function(){n.stop(),o.idleAnim&&(o.idleAnim.play(),o.lastPlayedAnim=o.idleAnim)})))),n.stop(),n.play(),this.lastPlayedAnim=n},o.prototype.changeIdleAnim=function(t,e){this.idleAnim.stop(),this.idleAnim=new AnimationState(t,{looping:!0}),this.getComponent(Animator).addClip(this.idleAnim),e&&(this.lastPlayedAnim.stop(),this.idleAnim.play(),this.lastPlayedAnim=this.idleAnim)},o.prototype.followPath=function(e){if(!this.hasComponent(M)){if(!e)return;this.addComponent(new M(e.path?e.path:[])),K.push(this)}this.faceUser&&(this.getComponent(s).active=!1);var i=this.getComponent(M);if(e){if(e.path)if(e.curve){var o=Curve3.CreateCatmullRomSpline(e.path,4*e.path.length,!!e.loop).getPoints();e.loop&&o.pop(),i.path=o}else i.path=e.path;null!=e.loop&&(i.loop=e.loop),null!=e.startingPoint&&i.setIndex(e.startingPoint),e.onFinishCallback&&(i.onFinishCallback=e.onFinishCallback),e.onReachedPointCallback&&(i.onReachedPointCallback=e.onReachedPointCallback)}var n=this.getComponent(Transform).position;(0==i.fraction&&i.path[i.origin].subtract(n).lengthSquared()>.1||i.fraction>0&&n.subtract(i.path[i.origin]).normalize()==i.path[i.target].subtract(i.path[i.origin]).normalize())&&(i.path.splice(i.origin,0,this.getComponent(Transform).position),i.fraction=0),this.getComponent(Transform).lookAt(i.path[i.target]);for(var r=0,a=[],h=0;h<i.path.length-1;h++){var u;r+=u=Vector3.Distance(i.path[h],i.path[h+1]),a.push(u)}i.loop&&(r+=u=Vector3.Distance(i.path[i.path.length-1],i.path[0]),a.push(u));e&&e.totalDuration?i.totalDuration=e.totalDuration:e&&e.speed?i.totalDuration=r/e.speed:i.totalDuration||(i.totalDuration=r/this.walkingSpeed),i.speed=[];for(h=0;h<a.length;h++)i.speed.push(1/(a[h]/r*i.totalDuration));this.walkingAnim&&(this.endAnimTimer.hasComponent(v)&&this.endAnimTimer.removeComponent(v),this.idleAnim.stop(),this.lastPlayedAnim.stop(),this.walkingAnim.play(),this.lastPlayedAnim=this.walkingAnim),this.state=t.NPCState.FOLLOWPATH},o.prototype.stopWalking=function(e){var i=this;this.state=t.NPCState.STANDING,this.walkingAnim&&(this.walkingAnim.stop(),this.idleAnim.play(),this.lastPlayedAnim=this.idleAnim),e&&this.pauseWalkingTimer.addComponentOrReplace(new v(e,(function(){i.dialog&&i.dialog.isDialogOpen||(i.lastPlayedAnim.stop(),i.walkingAnim&&(i.walkingAnim.play(),i.lastPlayedAnim=i.walkingAnim),i.endAnimTimer.hasComponent(v)&&i.endAnimTimer.removeComponent(v),i.state=t.NPCState.FOLLOWPATH)})))},o}(Entity);t.CustomDialogButton=Y,t.DialogTypeInSystem=U,t.DialogWindow=R,t.NPC=et,t.NPCDelay=v,t.NPCLerpData=M,t.NPCTriggerComponent=Q,t.SFFont=g,t.SFHeavyFont=p,t.TrackUserFlag=s,t.TriggerBoxShape=j,t.TriggerSphereShape=q,t.canvas=u,t.darkTheme=f,t.lightTheme=d,Object.defineProperty(t,\"__esModule\",{value:!0})}));\n//# sourceMappingURL=index.js.map\n",
    "sha256": "ed77052d84ce8518817fcfe91752c5b43c6f0033fb5f465bff7d8dc62fef0a87"
  },
  {
    "path": "src/game.ts",
    "content": "var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\ndefine(\"game\", [\"require\", \"exports\", \"@dcl/npc-scene-utils\"], function (require, exports, npc_scene_utils_1) {\r\n    \"use strict\";\r\n    Object.defineProperty(exports, \"__esModule\", { value: true });\r\n    exports.ILoveCats = exports.myNPC = exports.myNPC_A = void 0;\r\n    //import { script } from 'script'\r\n    // https://bafybeiehmsgzo7khxwa5cslo7bqihpzjbpgr4r426pb2gmnibqt2ncqvkm.ipfs.dweb.link/script_golfcraft.json\r\n    var canvas = new UICanvas();\r\n    var textInput = new UIInputText(canvas);\r\n    textInput.width = \"80%\";\r\n    textInput.height = \"25px\";\r\n    textInput.vAlign = \"bottom\";\r\n    textInput.hAlign = \"center\";\r\n    textInput.fontSize = 10;\r\n    textInput.placeholder = \"Write message here\";\r\n    //textInput.placeholderColor = Color4.Gray()\r\n    textInput.positionY = \"200px\";\r\n    textInput.isPointerBlocker = true;\r\n    textInput.visible = false;\r\n    textInput.onTextSubmit = new OnTextSubmit(function (x) {\r\n        executeTask(function () { return __awaiter(void 0, void 0, void 0, function () {\r\n            var response, json, _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        textInput.visible = false;\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        _b.trys.push([1, 4, , 5]);\r\n                        return [4 /*yield*/, fetch(x.text.trim())];\r\n                    case 2:\r\n                        response = _b.sent();\r\n                        return [4 /*yield*/, response.json()];\r\n                    case 3:\r\n                        json = _b.sent();\r\n                        log(json);\r\n                        loadScript(json);\r\n                        return [3 /*break*/, 5];\r\n                    case 4:\r\n                        _a = _b.sent();\r\n                        log(\"failed to reach URL\");\r\n                        return [3 /*break*/, 5];\r\n                    case 5: return [2 /*return*/];\r\n                }\r\n            });\r\n        }); });\r\n    });\r\n    var cube = new Entity();\r\n    cube.addComponent(new BoxShape());\r\n    cube.addComponent(new Transform({\r\n        position: new Vector3(10, 2, -10),\r\n    }));\r\n    cube.addComponent(new OnPointerDown(function (e) {\r\n        textInput.visible = true;\r\n    }));\r\n    engine.addEntity(cube);\r\n    exports.myNPC_A = new npc_scene_utils_1.NPC({ position: new Vector3(10, 1.5, 8) }, 'models/bela.glb', function () {\r\n    }, { faceUser: true, idleAnim: \"Idle\" });\r\n    var nt = new Transform({\r\n        position: new Vector3(0, 0.7, 0),\r\n        rotation: Quaternion.Euler(0, 180, 0),\r\n        scale: new Vector3(0.35, 0.35, 0.35)\r\n    });\r\n    var myNPC_A_Name = new Entity();\r\n    myNPC_A_Name.addComponent(new TextShape(\"Mickey\"));\r\n    myNPC_A_Name.addComponent(nt);\r\n    myNPC_A_Name.setParent(exports.myNPC_A);\r\n    exports.myNPC = new npc_scene_utils_1.NPC({ position: new Vector3(10, 1.5, 10) }, 'models/alice.glb', function () {\r\n        exports.myNPC.talk(exports.ILoveCats, 0);\r\n    }, { faceUser: true, idleAnim: \"Hello\" });\r\n    var myNPC_Name = new Entity();\r\n    myNPC_Name.addComponent(new TextShape(\"Arnold\"));\r\n    myNPC_Name.addComponent(nt);\r\n    myNPC_Name.setParent(exports.myNPC);\r\n    exports.ILoveCats = [];\r\n    var characters = {\r\n        \"Matthew\": {\r\n            \"name\": \"Arnold\",\r\n            \"npc\": exports.myNPC,\r\n            \"other\": \"Joanna\"\r\n        },\r\n        \"Joanna\": {\r\n            \"name\": \"Mickey\",\r\n            \"npc\": exports.myNPC_A,\r\n            \"other\": \"Matthew\"\r\n        },\r\n        \"Brian\": {\r\n            \"name\": \"Scamjack\",\r\n            \"npc\": exports.myNPC,\r\n            \"other\": \"Joanna\"\r\n        }\r\n    };\r\n    // Idle, Talk, Hello, Goodbye\r\n    function loadScript(script) {\r\n        exports.ILoveCats = [];\r\n        var _loop_1 = function (n) {\r\n            var character_id = script.episodes[0].story[n].voice.split(\",\")[1];\r\n            var character_name = characters[character_id].name;\r\n            var character_other_npc = characters[characters[character_id].other].npc;\r\n            if (script.episodes[0].story[n].type == \"story\") {\r\n                var data = getDataFrom(script, script.episodes[0].story[n].id, 0);\r\n                exports.ILoveCats.push({\r\n                    text: character_name + \": \" + data.text,\r\n                    name: script.episodes[0].story[n].id,\r\n                    triggeredByNext: function () {\r\n                        exports.myNPC.playAnimation(\"Idle\");\r\n                        exports.myNPC_A.playAnimation(\"Idle\");\r\n                        var data = getDataFrom(script, script.episodes[0].story[n + 1].id, 0);\r\n                        if (data.action == \"raise_golfclub\") {\r\n                            data.npc.playAnimation(\"Hello\");\r\n                        }\r\n                        else {\r\n                            data.npc.playAnimation(\"Talk\");\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n            else if (script.episodes[0].story[n].type == \"simple\") {\r\n                var id_yes = script.episodes[0].story[n].id + \"yes\";\r\n                var id_no_1 = script.episodes[0].story[n].id + \"no\";\r\n                // Question\r\n                exports.ILoveCats.push({\r\n                    text: character_name + \": \" + script.episodes[0].story[n].content[0],\r\n                    name: script.episodes[0].story[n].id,\r\n                    isQuestion: true,\r\n                    buttons: [\r\n                        { label: \"Yes\", goToDialog: id_yes },\r\n                        { label: \"No\", goToDialog: id_no_1 }\r\n                    ]\r\n                });\r\n                // Answer yes\r\n                exports.ILoveCats.push({\r\n                    text: character_name + \": \" + script.episodes[0].story[n].content[1],\r\n                    name: id_yes,\r\n                    triggeredByNext: function () {\r\n                        exports.myNPC.talk(exports.ILoveCats, id_no_1);\r\n                        exports.myNPC.playAnimation(\"Idle\");\r\n                        exports.myNPC_A.playAnimation(\"Idle\");\r\n                        character_other_npc.playAnimation(\"Talk\");\r\n                    }\r\n                });\r\n                // Answer no\r\n                exports.ILoveCats.push({\r\n                    text: character_name + \": \" + script.episodes[0].story[n].content[2],\r\n                    name: id_no_1,\r\n                    triggeredByNext: function () {\r\n                        exports.myNPC.talk(exports.ILoveCats, id_no_1);\r\n                        exports.myNPC.playAnimation(\"Idle\");\r\n                        exports.myNPC_A.playAnimation(\"Idle\");\r\n                        character_other_npc.playAnimation(\"Talk\");\r\n                    }\r\n                });\r\n            }\r\n        };\r\n        for (var n = 0; n < script.episodes[0].story.length; n++) {\r\n            _loop_1(n);\r\n        }\r\n        exports.ILoveCats[exports.ILoveCats.length - 1].isEndOfDialog = true;\r\n    }\r\n    function gotoPlace() {\r\n        exports.myNPC.followPath({\r\n            path: [new Vector3(2, 1.5, 2), new Vector3(2, 1.5, 4), new Vector3(6, 1.5, 2)],\r\n            totalDuration: 4,\r\n            loop: false,\r\n            curve: true,\r\n            startingPoint: 0,\r\n            onFinishCallback: function () {\r\n                log('Finished!');\r\n            }\r\n        });\r\n        exports.myNPC_A.followPath({\r\n            path: [new Vector3(2, 1.5, 2), new Vector3(3, 1.5, 4), new Vector3(7, 1.5, 2)],\r\n            totalDuration: 4,\r\n            loop: false,\r\n            curve: true,\r\n            startingPoint: 0,\r\n            onFinishCallback: function () {\r\n                log('Finished!');\r\n            }\r\n        });\r\n    }\r\n    function getDataFrom(script, id, cid) {\r\n        if (cid === void 0) { cid = 0; }\r\n        var data = {\r\n            \"npc\": exports.myNPC,\r\n            \"action\": \"\",\r\n            \"text\": \"\"\r\n        };\r\n        for (var n = 0; n < script.episodes[0].story.length; n++) {\r\n            if (script.episodes[0].story[n].id == id) {\r\n                var text = \"\" + script.episodes[0].story[n].content[cid];\r\n                var original_text = \"\" + text;\r\n                text = text.replace(/\\\\raise_golfclub/g, \"\");\r\n                text = text.replace(/\\\\goto_training_leaderboard/g, \"\");\r\n                text = text.replace(/\\\\goto_training_board/g, \"\");\r\n                text = text.replace(/\\\\goto_level_board/g, \"\");\r\n                if (original_text.indexOf('\\\\raise_golfclub') !== -1) {\r\n                    data.action = \"raise_golfclub\";\r\n                }\r\n                else if (original_text.indexOf('\\\\goto_training_leaderboard') !== -1) {\r\n                    data.action = \"goto_training_leaderboard\";\r\n                }\r\n                else if (original_text.indexOf('\\\\goto_training_board') !== -1) {\r\n                    data.action = \"goto_training_board\";\r\n                }\r\n                else if (original_text.indexOf('\\\\goto_level_board') !== -1) {\r\n                    data.action = \"goto_level_board\";\r\n                }\r\n                var character_id = script.episodes[0].story[n].voice.split(\",\")[1];\r\n                data.npc = characters[character_id].npc;\r\n                data.text = text;\r\n                break;\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n});\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2FtZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9nYW1lLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFDQSxpQ0FBaUM7SUFDakMsMkdBQTJHO0lBRTNHLElBQU0sTUFBTSxHQUFHLElBQUksUUFBUSxFQUFFLENBQUE7SUFFN0IsSUFBTSxTQUFTLEdBQUcsSUFBSSxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUE7SUFDekMsU0FBUyxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUE7SUFDdkIsU0FBUyxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUE7SUFDekIsU0FBUyxDQUFDLE1BQU0sR0FBRyxRQUFRLENBQUE7SUFDM0IsU0FBUyxDQUFDLE1BQU0sR0FBRyxRQUFRLENBQUE7SUFDM0IsU0FBUyxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUE7SUFDdkIsU0FBUyxDQUFDLFdBQVcsR0FBRyxvQkFBb0IsQ0FBQTtJQUM1Qyw0Q0FBNEM7SUFDNUMsU0FBUyxDQUFDLFNBQVMsR0FBRyxPQUFPLENBQUE7SUFDN0IsU0FBUyxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQTtJQUNqQyxTQUFTLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQTtJQUN6QixTQUFTLENBQUMsWUFBWSxHQUFHLElBQUksWUFBWSxDQUFDLFVBQUMsQ0FBQztRQUN4QyxXQUFXLENBQUM7Ozs7O3dCQUNSLFNBQVMsQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFBOzs7O3dCQUVOLHFCQUFNLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLEVBQUE7O3dCQUFyQyxRQUFRLEdBQUcsU0FBMEI7d0JBQzlCLHFCQUFNLFFBQVEsQ0FBQyxJQUFJLEVBQUUsRUFBQTs7d0JBQTVCLElBQUksR0FBRyxTQUFxQjt3QkFDaEMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFBO3dCQUNULFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQTs7Ozt3QkFFaEIsR0FBRyxDQUFDLHFCQUFxQixDQUFDLENBQUE7Ozs7O2FBRWpDLENBQUMsQ0FBQTtJQUNOLENBQUMsQ0FBQyxDQUFBO0lBRUYsSUFBTSxJQUFJLEdBQUcsSUFBSSxNQUFNLEVBQUUsQ0FBQTtJQUN6QixJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksUUFBUSxFQUFFLENBQUMsQ0FBQTtJQUNqQyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksU0FBUyxDQUFDO1FBQzVCLFFBQVEsRUFBRSxJQUFJLE9BQU8sQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDO0tBQ3BDLENBQUMsQ0FBQyxDQUFBO0lBQ0gsSUFBSSxDQUFDLFlBQVksQ0FDYixJQUFJLGFBQWEsQ0FBQyxVQUFDLENBQUM7UUFDaEIsU0FBUyxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUE7SUFDNUIsQ0FBQyxDQUFDLENBQ0wsQ0FBQTtJQUNELE1BQU0sQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUE7SUFFWCxRQUFBLE9BQU8sR0FBRyxJQUFJLHFCQUFHLENBQUMsRUFBRSxRQUFRLEVBQUUsSUFBSSxPQUFPLENBQUMsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLGlCQUFpQixFQUFFO0lBQ3ZGLENBQUMsRUFBRSxFQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBQyxDQUFDLENBQUE7SUFFdEMsSUFBTSxFQUFFLEdBQUcsSUFBSSxTQUFTLENBQUM7UUFDckIsUUFBUSxFQUFFLElBQUksT0FBTyxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2hDLFFBQVEsRUFBRSxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ3JDLEtBQUssRUFBRSxJQUFJLE9BQU8sQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztLQUN2QyxDQUFDLENBQUE7SUFFRixJQUFNLFlBQVksR0FBRyxJQUFJLE1BQU0sRUFBRSxDQUFBO0lBQ2pDLFlBQVksQ0FBQyxZQUFZLENBQUMsSUFBSSxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQTtJQUNsRCxZQUFZLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQyxDQUFBO0lBQzdCLFlBQVksQ0FBQyxTQUFTLENBQUMsZUFBTyxDQUFDLENBQUE7SUFFcEIsUUFBQSxLQUFLLEdBQUcsSUFBSSxxQkFBRyxDQUFDLEVBQUUsUUFBUSxFQUFFLElBQUksT0FBTyxDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxrQkFBa0IsRUFBRTtRQUNuRixhQUFLLENBQUMsSUFBSSxDQUFDLGlCQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUE7SUFDNUIsQ0FBQyxFQUFFLEVBQUMsUUFBUSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFDLENBQUMsQ0FBQTtJQUV2QyxJQUFNLFVBQVUsR0FBRyxJQUFJLE1BQU0sRUFBRSxDQUFBO0lBQy9CLFVBQVUsQ0FBQyxZQUFZLENBQUMsSUFBSSxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQTtJQUNoRCxVQUFVLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQyxDQUFBO0lBQzNCLFVBQVUsQ0FBQyxTQUFTLENBQUMsYUFBSyxDQUFDLENBQUE7SUFFaEIsUUFBQSxTQUFTLEdBQWEsRUFBRSxDQUFBO0lBSW5DLElBQU0sVUFBVSxHQUFRO1FBQ3BCLFNBQVMsRUFBRTtZQUNQLE1BQU0sRUFBRSxRQUFRO1lBQ2hCLEtBQUssRUFBRSxhQUFLO1lBQ1osT0FBTyxFQUFFLFFBQVE7U0FDcEI7UUFDRCxRQUFRLEVBQUU7WUFDTixNQUFNLEVBQUUsUUFBUTtZQUNoQixLQUFLLEVBQUUsZUFBTztZQUNkLE9BQU8sRUFBRSxTQUFTO1NBQ3JCO1FBQ0QsT0FBTyxFQUFFO1lBQ0wsTUFBTSxFQUFFLFVBQVU7WUFDbEIsS0FBSyxFQUFFLGFBQUs7WUFDWixPQUFPLEVBQUUsUUFBUTtTQUNwQjtLQUNKLENBQUE7SUFHRCw2QkFBNkI7SUFDN0IsU0FBUyxVQUFVLENBQUMsTUFBVztRQUMzQixpQkFBUyxHQUFHLEVBQUUsQ0FBQTtnQ0FDTCxDQUFDO1lBQ04sSUFBTSxZQUFZLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQTtZQUNwRSxJQUFNLGNBQWMsR0FBRyxVQUFVLENBQUMsWUFBWSxDQUFDLENBQUMsSUFBSSxDQUFBO1lBQ3BELElBQU0sbUJBQW1CLEdBQUcsVUFBVSxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUE7WUFFMUUsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLElBQUksT0FBTyxFQUFFO2dCQUM3QyxJQUFNLElBQUksR0FBRyxXQUFXLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQTtnQkFDbkUsaUJBQVMsQ0FBQyxJQUFJLENBQUM7b0JBQ1gsSUFBSSxFQUFFLGNBQWMsR0FBRyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUk7b0JBQ3ZDLElBQUksRUFBRSxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFO29CQUNwQyxlQUFlLEVBQUU7d0JBQ2IsYUFBSyxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTt3QkFDM0IsZUFBTyxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTt3QkFFN0IsSUFBTSxJQUFJLEdBQUcsV0FBVyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFBO3dCQUNyRSxJQUFJLElBQUksQ0FBQyxNQUFNLElBQUksZ0JBQWdCLEVBQUU7NEJBQ2pDLElBQUksQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFBO3lCQUNsQzs2QkFBTTs0QkFDSCxJQUFJLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTt5QkFDakM7b0JBQ0wsQ0FBQztpQkFDSixDQUFDLENBQUE7YUFDTDtpQkFBTSxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSxRQUFRLEVBQUU7Z0JBQ3JELElBQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsR0FBQyxLQUFLLENBQUE7Z0JBQ25ELElBQU0sT0FBSyxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsR0FBQyxJQUFJLENBQUE7Z0JBQ2pELFdBQVc7Z0JBQ1gsaUJBQVMsQ0FBQyxJQUFJLENBQUM7b0JBQ1gsSUFBSSxFQUFFLGNBQWMsR0FBRyxJQUFJLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztvQkFDcEUsSUFBSSxFQUFFLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUU7b0JBQ3BDLFVBQVUsRUFBRSxJQUFJO29CQUNoQixPQUFPLEVBQUU7d0JBQ0wsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUU7d0JBQ3BDLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsT0FBSyxFQUFFO3FCQUNyQztpQkFDSixDQUFDLENBQUE7Z0JBQ0YsYUFBYTtnQkFDYixpQkFBUyxDQUFDLElBQUksQ0FBQztvQkFDWCxJQUFJLEVBQUUsY0FBYyxHQUFHLElBQUksR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO29CQUNwRSxJQUFJLEVBQUUsTUFBTTtvQkFDWixlQUFlLEVBQUU7d0JBQ2IsYUFBSyxDQUFDLElBQUksQ0FBQyxpQkFBUyxFQUFFLE9BQUssQ0FBQyxDQUFBO3dCQUM1QixhQUFLLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFBO3dCQUMzQixlQUFPLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFBO3dCQUM3QixtQkFBbUIsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUE7b0JBQzdDLENBQUM7aUJBQ0osQ0FBQyxDQUFBO2dCQUNGLFlBQVk7Z0JBQ1osaUJBQVMsQ0FBQyxJQUFJLENBQUM7b0JBQ1gsSUFBSSxFQUFFLGNBQWMsR0FBRyxJQUFJLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztvQkFDcEUsSUFBSSxFQUFFLE9BQUs7b0JBQ1gsZUFBZSxFQUFFO3dCQUNiLGFBQUssQ0FBQyxJQUFJLENBQUMsaUJBQVMsRUFBRSxPQUFLLENBQUMsQ0FBQTt3QkFDNUIsYUFBSyxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTt3QkFDM0IsZUFBTyxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQTt3QkFDN0IsbUJBQW1CLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxDQUFBO29CQUM3QyxDQUFDO2lCQUNKLENBQUMsQ0FBQTthQUNMOztRQXpETCxLQUFLLElBQUksQ0FBQyxHQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRTtvQkFBN0MsQ0FBQztTQTBEVDtRQUNELGlCQUFTLENBQUMsaUJBQVMsQ0FBQyxNQUFNLEdBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQTtJQUN0RCxDQUFDO0lBR0QsU0FBUyxTQUFTO1FBQ2QsYUFBSyxDQUFDLFVBQVUsQ0FBQztZQUNiLElBQUksRUFBRSxDQUFDLElBQUksT0FBTyxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDLEVBQUUsSUFBSSxPQUFPLENBQUMsQ0FBQyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUMsRUFBRSxJQUFJLE9BQU8sQ0FBQyxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQzlFLGFBQWEsRUFBRSxDQUFDO1lBQ2hCLElBQUksRUFBRSxLQUFLO1lBQ1gsS0FBSyxFQUFFLElBQUk7WUFDWCxhQUFhLEVBQUUsQ0FBQztZQUNoQixnQkFBZ0IsRUFBRTtnQkFDZCxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUE7WUFDcEIsQ0FBQztTQUNKLENBQUMsQ0FBQTtRQUNGLGVBQU8sQ0FBQyxVQUFVLENBQUM7WUFDZixJQUFJLEVBQUUsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxFQUFFLElBQUksT0FBTyxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDLEVBQUUsSUFBSSxPQUFPLENBQUMsQ0FBQyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUM5RSxhQUFhLEVBQUUsQ0FBQztZQUNoQixJQUFJLEVBQUUsS0FBSztZQUNYLEtBQUssRUFBRSxJQUFJO1lBQ1gsYUFBYSxFQUFFLENBQUM7WUFDaEIsZ0JBQWdCLEVBQUU7Z0JBQ2QsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFBO1lBQ3BCLENBQUM7U0FDSixDQUFDLENBQUE7SUFDTixDQUFDO0lBRUQsU0FBUyxXQUFXLENBQUMsTUFBVyxFQUFFLEVBQVUsRUFBRSxHQUFlO1FBQWYsb0JBQUEsRUFBQSxPQUFlO1FBQ3pELElBQUksSUFBSSxHQUFJO1lBQ1IsS0FBSyxFQUFFLGFBQUs7WUFDWixRQUFRLEVBQUUsRUFBRTtZQUNaLE1BQU0sRUFBRSxFQUFFO1NBQ2IsQ0FBQTtRQUNELEtBQUssSUFBSSxDQUFDLEdBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDcEQsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxFQUFFO2dCQUV0QyxJQUFJLElBQUksR0FBRyxFQUFFLEdBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFBO2dCQUN0RCxJQUFNLGFBQWEsR0FBRyxFQUFFLEdBQUMsSUFBSSxDQUFBO2dCQUM3QixJQUFJLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsRUFBRSxFQUFFLENBQUMsQ0FBQTtnQkFDNUMsSUFBSSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsOEJBQThCLEVBQUUsRUFBRSxDQUFDLENBQUE7Z0JBQ3ZELElBQUksR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLHdCQUF3QixFQUFFLEVBQUUsQ0FBQyxDQUFBO2dCQUNqRCxJQUFJLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxxQkFBcUIsRUFBRSxFQUFFLENBQUMsQ0FBQTtnQkFFOUMsSUFBSSxhQUFhLENBQUMsT0FBTyxDQUFDLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUU7b0JBQ2xELElBQUksQ0FBQyxNQUFNLEdBQUcsZ0JBQWdCLENBQUE7aUJBQ2pDO3FCQUFNLElBQUksYUFBYSxDQUFDLE9BQU8sQ0FBQyw2QkFBNkIsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFO29CQUNwRSxJQUFJLENBQUMsTUFBTSxHQUFHLDJCQUEyQixDQUFBO2lCQUM1QztxQkFBTSxJQUFJLGFBQWEsQ0FBQyxPQUFPLENBQUMsdUJBQXVCLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtvQkFDOUQsSUFBSSxDQUFDLE1BQU0sR0FBRyxxQkFBcUIsQ0FBQTtpQkFDdEM7cUJBQU0sSUFBSSxhQUFhLENBQUMsT0FBTyxDQUFDLG9CQUFvQixDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUU7b0JBQzNELElBQUksQ0FBQyxNQUFNLEdBQUcsa0JBQWtCLENBQUE7aUJBQ25DO2dCQUVELElBQU0sWUFBWSxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7Z0JBQ3BFLElBQUksQ0FBQyxHQUFHLEdBQUksVUFBVSxDQUFDLFlBQVksQ0FBQyxDQUFDLEdBQUcsQ0FBQTtnQkFDeEMsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUE7Z0JBRWhCLE1BQUs7YUFDUjtTQUNKO1FBQ0QsT0FBTyxJQUFJLENBQUE7SUFDZixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTlBDLCBEaWFsb2cgfSBmcm9tICdAZGNsL25wYy1zY2VuZS11dGlscydcbi8vaW1wb3J0IHsgc2NyaXB0IH0gZnJvbSAnc2NyaXB0J1xuLy8gaHR0cHM6Ly9iYWZ5YmVpZWhtc2d6bzdraHh3YTVjc2xvN2JxaWhwempicGdyNHI0MjZwYjJnbW5pYnF0Mm5jcXZrbS5pcGZzLmR3ZWIubGluay9zY3JpcHRfZ29sZmNyYWZ0Lmpzb25cblxuY29uc3QgY2FudmFzID0gbmV3IFVJQ2FudmFzKClcblxuY29uc3QgdGV4dElucHV0ID0gbmV3IFVJSW5wdXRUZXh0KGNhbnZhcylcbnRleHRJbnB1dC53aWR0aCA9IFwiODAlXCJcbnRleHRJbnB1dC5oZWlnaHQgPSBcIjI1cHhcIlxudGV4dElucHV0LnZBbGlnbiA9IFwiYm90dG9tXCJcbnRleHRJbnB1dC5oQWxpZ24gPSBcImNlbnRlclwiXG50ZXh0SW5wdXQuZm9udFNpemUgPSAxMFxudGV4dElucHV0LnBsYWNlaG9sZGVyID0gXCJXcml0ZSBtZXNzYWdlIGhlcmVcIlxuLy90ZXh0SW5wdXQucGxhY2Vob2xkZXJDb2xvciA9IENvbG9yNC5HcmF5KClcbnRleHRJbnB1dC5wb3NpdGlvblkgPSBcIjIwMHB4XCJcbnRleHRJbnB1dC5pc1BvaW50ZXJCbG9ja2VyID0gdHJ1ZVxudGV4dElucHV0LnZpc2libGUgPSBmYWxzZVxudGV4dElucHV0Lm9uVGV4dFN1Ym1pdCA9IG5ldyBPblRleHRTdWJtaXQoKHgpID0+IHtcbiAgICBleGVjdXRlVGFzayhhc3luYyAoKSA9PiB7XG4gICAgICAgIHRleHRJbnB1dC52aXNpYmxlID0gZmFsc2VcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHgudGV4dC50cmltKCkpXG4gICAgICAgICAgICBsZXQganNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgICAgICAgbG9nKGpzb24pXG4gICAgICAgICAgICBsb2FkU2NyaXB0KGpzb24pXG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgbG9nKFwiZmFpbGVkIHRvIHJlYWNoIFVSTFwiKVxuICAgICAgICB9XG4gICAgfSlcbn0pXG5cbmNvbnN0IGN1YmUgPSBuZXcgRW50aXR5KClcbmN1YmUuYWRkQ29tcG9uZW50KG5ldyBCb3hTaGFwZSgpKVxuY3ViZS5hZGRDb21wb25lbnQobmV3IFRyYW5zZm9ybSh7XG4gICAgcG9zaXRpb246IG5ldyBWZWN0b3IzKDEwLCAyLCAtMTApLFxufSkpXG5jdWJlLmFkZENvbXBvbmVudChcbiAgICBuZXcgT25Qb2ludGVyRG93bigoZSkgPT4ge1xuICAgICAgICB0ZXh0SW5wdXQudmlzaWJsZSA9IHRydWVcbiAgICB9KVxuKVxuZW5naW5lLmFkZEVudGl0eShjdWJlKVxuXG5leHBvcnQgbGV0IG15TlBDX0EgPSBuZXcgTlBDKHsgcG9zaXRpb246IG5ldyBWZWN0b3IzKDEwLCAxLjUsIDgpIH0sICdtb2RlbHMvYmVsYS5nbGInLCAoKSA9PiB7XG59LCB7ZmFjZVVzZXI6IHRydWUsIGlkbGVBbmltOiBgSWRsZWB9KVxuXG5jb25zdCBudCA9IG5ldyBUcmFuc2Zvcm0oe1xuICAgIHBvc2l0aW9uOiBuZXcgVmVjdG9yMygwLCAwLjcsIDApLFxuICAgIHJvdGF0aW9uOiBRdWF0ZXJuaW9uLkV1bGVyKDAsIDE4MCwgMCksXG4gICAgc2NhbGU6IG5ldyBWZWN0b3IzKDAuMzUsIDAuMzUsIDAuMzUpXG59KVxuXG5jb25zdCBteU5QQ19BX05hbWUgPSBuZXcgRW50aXR5KClcbm15TlBDX0FfTmFtZS5hZGRDb21wb25lbnQobmV3IFRleHRTaGFwZShcIk1pY2tleVwiKSlcbm15TlBDX0FfTmFtZS5hZGRDb21wb25lbnQobnQpXG5teU5QQ19BX05hbWUuc2V0UGFyZW50KG15TlBDX0EpXG5cbmV4cG9ydCBsZXQgbXlOUEMgPSBuZXcgTlBDKHsgcG9zaXRpb246IG5ldyBWZWN0b3IzKDEwLCAxLjUsIDEwKSB9LCAnbW9kZWxzL2FsaWNlLmdsYicsICgpID0+IHtcbiAgICBteU5QQy50YWxrKElMb3ZlQ2F0cywgMClcbn0sIHtmYWNlVXNlcjogdHJ1ZSwgaWRsZUFuaW06IGBIZWxsb2B9KVxuXG5jb25zdCBteU5QQ19OYW1lID0gbmV3IEVudGl0eSgpXG5teU5QQ19OYW1lLmFkZENvbXBvbmVudChuZXcgVGV4dFNoYXBlKFwiQXJub2xkXCIpKVxubXlOUENfTmFtZS5hZGRDb21wb25lbnQobnQpXG5teU5QQ19OYW1lLnNldFBhcmVudChteU5QQylcblxuZXhwb3J0IGxldCBJTG92ZUNhdHM6IERpYWxvZ1tdID0gW11cblxuXG5cbmNvbnN0IGNoYXJhY3RlcnM6IGFueSA9IHtcbiAgICBcIk1hdHRoZXdcIjoge1xuICAgICAgICBcIm5hbWVcIjogXCJBcm5vbGRcIixcbiAgICAgICAgXCJucGNcIjogbXlOUEMsXG4gICAgICAgIFwib3RoZXJcIjogXCJKb2FubmFcIlxuICAgIH0sXG4gICAgXCJKb2FubmFcIjoge1xuICAgICAgICBcIm5hbWVcIjogXCJNaWNrZXlcIixcbiAgICAgICAgXCJucGNcIjogbXlOUENfQSxcbiAgICAgICAgXCJvdGhlclwiOiBcIk1hdHRoZXdcIlxuICAgIH0sXG4gICAgXCJCcmlhblwiOiB7XG4gICAgICAgIFwibmFtZVwiOiBcIlNjYW1qYWNrXCIsXG4gICAgICAgIFwibnBjXCI6IG15TlBDLFxuICAgICAgICBcIm90aGVyXCI6IFwiSm9hbm5hXCJcbiAgICB9XG59XG5cblxuLy8gSWRsZSwgVGFsaywgSGVsbG8sIEdvb2RieWVcbmZ1bmN0aW9uIGxvYWRTY3JpcHQoc2NyaXB0OiBhbnkpIHtcbiAgICBJTG92ZUNhdHMgPSBbXVxuICAgIGZvciAobGV0IG49MDsgbiA8IHNjcmlwdC5lcGlzb2Rlc1swXS5zdG9yeS5sZW5ndGg7IG4rKykge1xuICAgICAgICBjb25zdCBjaGFyYWN0ZXJfaWQgPSBzY3JpcHQuZXBpc29kZXNbMF0uc3Rvcnlbbl0udm9pY2Uuc3BsaXQoXCIsXCIpWzFdXG4gICAgICAgIGNvbnN0IGNoYXJhY3Rlcl9uYW1lID0gY2hhcmFjdGVyc1tjaGFyYWN0ZXJfaWRdLm5hbWVcbiAgICAgICAgY29uc3QgY2hhcmFjdGVyX290aGVyX25wYyA9IGNoYXJhY3RlcnNbY2hhcmFjdGVyc1tjaGFyYWN0ZXJfaWRdLm90aGVyXS5ucGNcblxuICAgICAgICBpZiAoc2NyaXB0LmVwaXNvZGVzWzBdLnN0b3J5W25dLnR5cGUgPT0gXCJzdG9yeVwiKSB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gZ2V0RGF0YUZyb20oc2NyaXB0LCBzY3JpcHQuZXBpc29kZXNbMF0uc3Rvcnlbbl0uaWQsIDApXG4gICAgICAgICAgICBJTG92ZUNhdHMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGV4dDogY2hhcmFjdGVyX25hbWUgKyBcIjogXCIgKyBkYXRhLnRleHQsXG4gICAgICAgICAgICAgICAgbmFtZTogc2NyaXB0LmVwaXNvZGVzWzBdLnN0b3J5W25dLmlkLFxuICAgICAgICAgICAgICAgIHRyaWdnZXJlZEJ5TmV4dDogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBteU5QQy5wbGF5QW5pbWF0aW9uKGBJZGxlYClcbiAgICAgICAgICAgICAgICAgICAgbXlOUENfQS5wbGF5QW5pbWF0aW9uKGBJZGxlYClcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gZ2V0RGF0YUZyb20oc2NyaXB0LCBzY3JpcHQuZXBpc29kZXNbMF0uc3RvcnlbbisxXS5pZCwgMClcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuYWN0aW9uID09IFwicmFpc2VfZ29sZmNsdWJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5ucGMucGxheUFuaW1hdGlvbihgSGVsbG9gKVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5ucGMucGxheUFuaW1hdGlvbihgVGFsa2ApXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2UgaWYgKHNjcmlwdC5lcGlzb2Rlc1swXS5zdG9yeVtuXS50eXBlID09IFwic2ltcGxlXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IGlkX3llcyA9IHNjcmlwdC5lcGlzb2Rlc1swXS5zdG9yeVtuXS5pZCtcInllc1wiXG4gICAgICAgICAgICBjb25zdCBpZF9ubyA9IHNjcmlwdC5lcGlzb2Rlc1swXS5zdG9yeVtuXS5pZCtcIm5vXCJcbiAgICAgICAgICAgIC8vIFF1ZXN0aW9uXG4gICAgICAgICAgICBJTG92ZUNhdHMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGV4dDogY2hhcmFjdGVyX25hbWUgKyBcIjogXCIgKyBzY3JpcHQuZXBpc29kZXNbMF0uc3Rvcnlbbl0uY29udGVudFswXSxcbiAgICAgICAgICAgICAgICBuYW1lOiBzY3JpcHQuZXBpc29kZXNbMF0uc3Rvcnlbbl0uaWQsXG4gICAgICAgICAgICAgICAgaXNRdWVzdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBidXR0b25zOiBbXG4gICAgICAgICAgICAgICAgICAgIHsgbGFiZWw6IGBZZXNgLCBnb1RvRGlhbG9nOiBpZF95ZXMgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBsYWJlbDogYE5vYCwgZ29Ub0RpYWxvZzogaWRfbm8gfVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAvLyBBbnN3ZXIgeWVzXG4gICAgICAgICAgICBJTG92ZUNhdHMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGV4dDogY2hhcmFjdGVyX25hbWUgKyBcIjogXCIgKyBzY3JpcHQuZXBpc29kZXNbMF0uc3Rvcnlbbl0uY29udGVudFsxXSxcbiAgICAgICAgICAgICAgICBuYW1lOiBpZF95ZXMsXG4gICAgICAgICAgICAgICAgdHJpZ2dlcmVkQnlOZXh0OiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIG15TlBDLnRhbGsoSUxvdmVDYXRzLCBpZF9ubylcbiAgICAgICAgICAgICAgICAgICAgbXlOUEMucGxheUFuaW1hdGlvbihgSWRsZWApXG4gICAgICAgICAgICAgICAgICAgIG15TlBDX0EucGxheUFuaW1hdGlvbihgSWRsZWApXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3Rlcl9vdGhlcl9ucGMucGxheUFuaW1hdGlvbihgVGFsa2ApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vIEFuc3dlciBub1xuICAgICAgICAgICAgSUxvdmVDYXRzLnB1c2goe1xuICAgICAgICAgICAgICAgIHRleHQ6IGNoYXJhY3Rlcl9uYW1lICsgXCI6IFwiICsgc2NyaXB0LmVwaXNvZGVzWzBdLnN0b3J5W25dLmNvbnRlbnRbMl0sXG4gICAgICAgICAgICAgICAgbmFtZTogaWRfbm8sXG4gICAgICAgICAgICAgICAgdHJpZ2dlcmVkQnlOZXh0OiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIG15TlBDLnRhbGsoSUxvdmVDYXRzLCBpZF9ubylcbiAgICAgICAgICAgICAgICAgICAgbXlOUEMucGxheUFuaW1hdGlvbihgSWRsZWApXG4gICAgICAgICAgICAgICAgICAgIG15TlBDX0EucGxheUFuaW1hdGlvbihgSWRsZWApXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3Rlcl9vdGhlcl9ucGMucGxheUFuaW1hdGlvbihgVGFsa2ApXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cbiAgICBJTG92ZUNhdHNbSUxvdmVDYXRzLmxlbmd0aC0xXS5pc0VuZE9mRGlhbG9nID0gdHJ1ZVxufVxuXG5cbmZ1bmN0aW9uIGdvdG9QbGFjZSgpIHtcbiAgICBteU5QQy5mb2xsb3dQYXRoKHtcbiAgICAgICAgcGF0aDogW25ldyBWZWN0b3IzKDIsIDEuNSwgMiksIG5ldyBWZWN0b3IzKDIsIDEuNSwgNCksIG5ldyBWZWN0b3IzKDYsIDEuNSwgMildLFxuICAgICAgICB0b3RhbER1cmF0aW9uOiA0LFxuICAgICAgICBsb29wOiBmYWxzZSxcbiAgICAgICAgY3VydmU6IHRydWUsXG4gICAgICAgIHN0YXJ0aW5nUG9pbnQ6IDAsXG4gICAgICAgIG9uRmluaXNoQ2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgIGxvZygnRmluaXNoZWQhJylcbiAgICAgICAgfVxuICAgIH0pXG4gICAgbXlOUENfQS5mb2xsb3dQYXRoKHtcbiAgICAgICAgcGF0aDogW25ldyBWZWN0b3IzKDIsIDEuNSwgMiksIG5ldyBWZWN0b3IzKDMsIDEuNSwgNCksIG5ldyBWZWN0b3IzKDcsIDEuNSwgMildLFxuICAgICAgICB0b3RhbER1cmF0aW9uOiA0LFxuICAgICAgICBsb29wOiBmYWxzZSxcbiAgICAgICAgY3VydmU6IHRydWUsXG4gICAgICAgIHN0YXJ0aW5nUG9pbnQ6IDAsXG4gICAgICAgIG9uRmluaXNoQ2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgIGxvZygnRmluaXNoZWQhJylcbiAgICAgICAgfVxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGdldERhdGFGcm9tKHNjcmlwdDogYW55LCBpZDogc3RyaW5nLCBjaWQ6IG51bWJlciA9IDApIHtcbiAgICBsZXQgZGF0YSA9ICB7XG4gICAgICAgIFwibnBjXCI6IG15TlBDLFxuICAgICAgICBcImFjdGlvblwiOiBcIlwiLFxuICAgICAgICBcInRleHRcIjogXCJcIlxuICAgIH1cbiAgICBmb3IgKGxldCBuPTA7IG4gPCBzY3JpcHQuZXBpc29kZXNbMF0uc3RvcnkubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgaWYgKHNjcmlwdC5lcGlzb2Rlc1swXS5zdG9yeVtuXS5pZCA9PSBpZCkge1xuXG4gICAgICAgICAgICBsZXQgdGV4dCA9IFwiXCIrc2NyaXB0LmVwaXNvZGVzWzBdLnN0b3J5W25dLmNvbnRlbnRbY2lkXVxuICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxfdGV4dCA9IFwiXCIrdGV4dFxuICAgICAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZSgvXFxcXHJhaXNlX2dvbGZjbHViL2csIFwiXCIpXG4gICAgICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cXFxcZ290b190cmFpbmluZ19sZWFkZXJib2FyZC9nLCBcIlwiKVxuICAgICAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZSgvXFxcXGdvdG9fdHJhaW5pbmdfYm9hcmQvZywgXCJcIilcbiAgICAgICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoL1xcXFxnb3RvX2xldmVsX2JvYXJkL2csIFwiXCIpXG5cbiAgICAgICAgICAgIGlmIChvcmlnaW5hbF90ZXh0LmluZGV4T2YoJ1xcXFxyYWlzZV9nb2xmY2x1YicpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIGRhdGEuYWN0aW9uID0gXCJyYWlzZV9nb2xmY2x1YlwiXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG9yaWdpbmFsX3RleHQuaW5kZXhPZignXFxcXGdvdG9fdHJhaW5pbmdfbGVhZGVyYm9hcmQnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBkYXRhLmFjdGlvbiA9IFwiZ290b190cmFpbmluZ19sZWFkZXJib2FyZFwiXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG9yaWdpbmFsX3RleHQuaW5kZXhPZignXFxcXGdvdG9fdHJhaW5pbmdfYm9hcmQnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBkYXRhLmFjdGlvbiA9IFwiZ290b190cmFpbmluZ19ib2FyZFwiXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG9yaWdpbmFsX3RleHQuaW5kZXhPZignXFxcXGdvdG9fbGV2ZWxfYm9hcmQnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBkYXRhLmFjdGlvbiA9IFwiZ290b19sZXZlbF9ib2FyZFwiXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGNoYXJhY3Rlcl9pZCA9IHNjcmlwdC5lcGlzb2Rlc1swXS5zdG9yeVtuXS52b2ljZS5zcGxpdChcIixcIilbMV1cbiAgICAgICAgICAgIGRhdGEubnBjID0gIGNoYXJhY3RlcnNbY2hhcmFjdGVyX2lkXS5ucGNcbiAgICAgICAgICAgIGRhdGEudGV4dCA9IHRleHRcblxuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZGF0YVxufVxuIl19",
    "sha256": "675ecfb7a6b3509e944809ea6ac85b0da52c05b6d1753c4e630727fa2b9aaf89"
  }
]